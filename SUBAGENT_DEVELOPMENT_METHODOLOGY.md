# Subagent å¹¶å‘å¼€å‘æ–¹æ³•è®º

> åŸºäº Sequential Thinking MCP + æ–‡æ¡£åŒ–å·¥ä½œæµçš„ AI åä½œå¼€å‘æ–¹æ³•
> **é€šç”¨ Web é¡¹ç›®å¼€å‘æ–¹æ³•è®ºæ¨¡æ¿**
> **é€‚ç”¨**: å¤§å‹å¤æ‚ Web é¡¹ç›®çš„ AI è¾…åŠ©å¼€å‘
> **æ›´æ–°**: æ”¹é€ ä¸ºé€šç”¨ Web é¡¹ç›®æ¨¡æ¿ï¼Œæ¶µç›–å‰ç«¯/åç«¯/æ•°æ®åº“/DevOps ç­‰å…¨æ ˆå¼€å‘

---

## ğŸ“Œ é‡è¦è¯´æ˜

**æœ¬æ–‡æ¡£æ˜¯é€šç”¨ Web é¡¹ç›®å¼€å‘æ–¹æ³•è®ºæ¨¡æ¿**

æœ¬æ–‡æ¡£ä¸­çš„æ‰€æœ‰ç¤ºä¾‹ï¼ˆç”¨æˆ·è®¤è¯ã€æ•°æ®åº“è®¾è®¡ç­‰ï¼‰ä»…ä¾›æ¼”ç¤ºæ–¹æ³•è®ºçš„ä½¿ç”¨æ–¹å¼ã€‚

âš ï¸ **é‡è¦æç¤º**ï¼š
- æ–‡æ¡£ä¸­å¯èƒ½ä»æœ‰éƒ¨åˆ†æ¥è‡ªåŸå§‹é¡¹ç›®çš„ä»£ç ç¤ºä¾‹å’Œåœºæ™¯æè¿°
- è¿™äº›ç¤ºä¾‹**ä»…ç”¨äºè¯´æ˜æ–¹æ³•è®º**ï¼Œè€Œéå…·ä½“å®ç°å»ºè®®
- åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œè¯·æ ¹æ®ä½ çš„ä¸šåŠ¡é¢†åŸŸå’ŒæŠ€æœ¯æ ˆè¿›è¡Œç›¸åº”æ›¿æ¢

åœ¨åº”ç”¨åˆ°ä½ çš„é¡¹ç›®æ—¶ï¼š
1. **å¿…é¡»**æ ¹æ®é¡¹ç›®å®é™…éœ€æ±‚å®šä¹‰ Subagent è§’è‰²
2. **å¿…é¡»**æ›¿æ¢ç¤ºä¾‹ä»£ç ä¸ºä½ çš„æŠ€æœ¯æ ˆå’Œä¸šåŠ¡åœºæ™¯
3. **å»ºè®®**å‚è€ƒ `~/.claude/agents/` ä¸­çš„æ ‡å‡† agent å®šä¹‰
4. **å»ºè®®**ä»å°åŠŸèƒ½å¼€å§‹ï¼Œé€æ­¥æ‰©å±•åˆ°å¤æ‚ç³»ç»Ÿ

è¯¦ç»†ä½¿ç”¨æ­¥éª¤è¯·å‚è€ƒï¼š[ğŸ¯ ä½¿ç”¨æœ¬æ¨¡æ¿çš„æ­¥éª¤](#-ä½¿ç”¨æœ¬æ¨¡æ¿çš„æ­¥éª¤)

## ğŸ“‹ ç›®å½•

- [ğŸ“Œ é‡è¦è¯´æ˜](#-é‡è¦è¯´æ˜)
- [æ–¹æ³•è®ºæ¦‚è¿°](#æ–¹æ³•è®ºæ¦‚è¿°)
- [æ ¸å¿ƒåŸç†](#æ ¸å¿ƒåŸç†)
- [æ¶æ„è®¾è®¡](#æ¶æ„è®¾è®¡)
- [TDD å·¥ä½œæµç¨‹](#tdd-å·¥ä½œæµç¨‹)
- [Token æ§åˆ¶ç­–ç•¥](#token-æ§åˆ¶ç­–ç•¥)
- [æ–‡æ¡£åŒ–å·¥ä½œæµ](#æ–‡æ¡£åŒ–å·¥ä½œæµ)
- [å®Œæ•´å·¥ä½œæµç¨‹](#å®Œæ•´å·¥ä½œæµç¨‹)
  - [Phase 0: MCP ç¯å¢ƒå‡†å¤‡](#phase-0-mcp-ç¯å¢ƒå‡†å¤‡)
  - [Phase 1: å‡†å¤‡é˜¶æ®µ](#phase-1-å‡†å¤‡é˜¶æ®µ)
  - [Phase 2: æ‰§è¡Œé˜¶æ®µ](#phase-2-æ‰§è¡Œé˜¶æ®µ)
  - [Phase 3: æ•´åˆé˜¶æ®µ](#phase-3-æ•´åˆé˜¶æ®µ)
  - [Phase 4: è¿­ä»£](#phase-4-è¿­ä»£)
- [ä¼˜ç‚¹æ€»ç»“](#ä¼˜ç‚¹æ€»ç»“)
- [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)
  - [ğŸš¨ æ ¸å¿ƒå·¥ä½œæµå¼ºåˆ¶è§„èŒƒ](#0-æ ¸å¿ƒå·¥ä½œæµå¼ºåˆ¶è§„èŒƒ-)
  - [æœ¬åœ°å¼€å‘ç¯å¢ƒé…ç½®è§„èŒƒ](#6-æœ¬åœ°å¼€å‘ç¯å¢ƒé…ç½®è§„èŒƒ-)
  - [MCP ä½¿ç”¨è§„èŒƒ](#7-mcp-ä½¿ç”¨è§„èŒƒ-)
  - [ä»»åŠ¡è®¾è®¡åŸåˆ™](#1-ä»»åŠ¡è®¾è®¡åŸåˆ™)
  - [ä»£ç è´¨é‡å’Œæ³¨é‡Šè§„èŒƒ](#10-ä»£ç è´¨é‡å’Œæ³¨é‡Šè§„èŒƒ-)
  - [è°ƒè¯•æ—¥å¿—è§„èŒƒ](#11-è°ƒè¯•æ—¥å¿—è§„èŒƒ-)
  - [æµ‹è¯•éªŒè¯è§„èŒƒ](#12-æµ‹è¯•éªŒè¯è§„èŒƒ-)
  - [æ–‡æ¡£ç¼–å†™åŸåˆ™](#2-æ–‡æ¡£ç¼–å†™åŸåˆ™)
  - [Subagent è§’è‰²è®¾è®¡](#3-subagent-è§’è‰²è®¾è®¡)
  - [Controller å†³ç­–åŸåˆ™](#4-controller-å†³ç­–åŸåˆ™)
  - [Token é¢„ç®—ç›‘æ§](#5-token-é¢„ç®—ç›‘æ§)
- [å®é™…åº”ç”¨ç¤ºä¾‹](#å®é™…åº”ç”¨ç¤ºä¾‹)
- [ğŸ¯ ä½¿ç”¨æœ¬æ¨¡æ¿çš„æ­¥éª¤](#-ä½¿ç”¨æœ¬æ¨¡æ¿çš„æ­¥éª¤)
- [ğŸ’¼ å¸¸è§ Web é¡¹ç›®åº”ç”¨åœºæ™¯](#-å¸¸è§-web-é¡¹ç›®åº”ç”¨åœºæ™¯)
  - [åœºæ™¯1ï¼šç”µå•†å¹³å°](#åœºæ™¯1ç”µå•†å¹³å°-e-commerce)
  - [åœºæ™¯2ï¼šSaaS ç®¡ç†å¹³å°](#åœºæ™¯2saas-ç®¡ç†å¹³å°)
  - [åœºæ™¯3ï¼šç¤¾äº¤/å†…å®¹å¹³å°](#åœºæ™¯3ç¤¾äº¤å†…å®¹å¹³å°)
  - [åœºæ™¯4ï¼šä¼ä¸šç®¡ç†ç³»ç»Ÿ](#åœºæ™¯4ä¼ä¸šç®¡ç†ç³»ç»Ÿ-erpcrm)
  - [åœºæ™¯5ï¼šå®æ—¶åä½œå·¥å…·](#åœºæ™¯5å®æ—¶åä½œå·¥å…·)

---

## æ–¹æ³•è®ºæ¦‚è¿°

### ä»€ä¹ˆæ˜¯ Subagent å¹¶å‘å¼€å‘ï¼Ÿ

Subagent å¹¶å‘å¼€å‘æ˜¯ä¸€ç§åŸºäº **AI Agent è§’è‰²åˆ†å·¥** å’Œ **æ–‡æ¡£åŒ–çŸ¥è¯†ç®¡ç†** çš„è½¯ä»¶å¼€å‘æ–¹æ³•è®ºã€‚å®ƒé€šè¿‡ä»¥ä¸‹æ–¹å¼æå‡å¼€å‘æ•ˆç‡ï¼š

1. **Sequential Thinking Controller**ï¼ˆæ€»åè°ƒå™¨ï¼‰è´Ÿè´£å…¨å±€è§„åˆ’å’Œå†³ç­–
2. **å¤šä¸ªä¸“ä¸š Subagent**ï¼ˆé€šè¿‡ä¸åŒ prompt å®šä¹‰ï¼‰å¹¶å‘å¤„ç†ç‹¬ç«‹ä»»åŠ¡
3. **æ–‡æ¡£åŒ–å·¥ä½œæµ** å®ç°çŸ¥è¯†æŒä¹…åŒ–å’Œä¸Šä¸‹æ–‡éš”ç¦»
4. **Token é¢„ç®—æ§åˆ¶** ç¡®ä¿æ¯ä¸ª Agent é«˜æ•ˆè¿è¡Œ

### é€‚ç”¨åœºæ™¯

âœ… **é€‚åˆ**ï¼š
- å¤§å‹é¡¹ç›®ï¼ˆå¤šæ¨¡å—ã€å¤šå±‚æ¬¡ï¼‰
- å¤æ‚ç³»ç»Ÿæ¶æ„ï¼ˆå¾®æœåŠ¡ã€å¤šç»„ä»¶é›†æˆï¼‰
- é•¿æœŸè¿­ä»£å¼€å‘ï¼ˆéœ€è¦çŸ¥è¯†ç§¯ç´¯ï¼‰
- å›¢é˜Ÿåä½œé¡¹ç›®ï¼ˆéœ€è¦æ–‡æ¡£åŒ–æ²Ÿé€šï¼‰

âŒ **ä¸é€‚åˆ**ï¼š
- ç®€å•çš„å•æ–‡ä»¶ä¿®æ”¹
- ä¸€æ¬¡æ€§å°è„šæœ¬å¼€å‘
- æ— éœ€å¤ç”¨çš„ä¸€æ¬¡æ€§ä»»åŠ¡

---

## æ ¸å¿ƒåŸç†

### 1. è§’è‰²åˆ†ç¦»åŸåˆ™ï¼ˆSeparation of Concernsï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Sequential Thinking Controller (æˆ‘)                 â”‚
â”‚  - å…¨å±€åˆ†æå’Œå†³ç­–                                        â”‚
â”‚  - ä»»åŠ¡åˆ†è§£å’Œåˆ†é…                                        â”‚
â”‚  - ç»“æœæ•´åˆå’Œè´¨é‡æ§åˆ¶                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚              â”‚              â”‚
    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
    â”‚ Subagent1 â”‚  â”‚ Subagent2 â”‚  â”‚ Subagent3 â”‚
    â”‚ å‰ç«¯å¼€å‘  â”‚  â”‚ åç«¯æ¶æ„  â”‚  â”‚ æ•°æ®åº“è®¾è®¡â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚              â”‚              â”‚
    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
    â”‚ Subagent4 â”‚  â”‚ Subagent5 â”‚  â”‚ Subagent6 â”‚
    â”‚ API å®‰å…¨  â”‚  â”‚ DevOps   â”‚  â”‚ æµ‹è¯•éƒ¨ç½²  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å…³é”®ç‚¹**ï¼š
- âš ï¸ **Controllerï¼ˆä¸»çª—å£ï¼‰æ°¸è¿œä¸å†™ä»£ç **ï¼šåªåšä»»åŠ¡è§„åˆ’ã€åˆ†é…å’Œè¿›åº¦è·Ÿè¸ª
- âš ï¸ **æ‰€æœ‰ä»£ç ç”± Subagent ç¼–å†™**ï¼šé€šè¿‡ç‹¬ç«‹çš„ Task tool è°ƒç”¨
- âœ… **Subagent ä¸“æ³¨äºç‰¹å®šé¢†åŸŸ**ï¼šèŒè´£å•ä¸€ï¼Œè¾¹ç•Œæ¸…æ™°
- âœ… **ç‹¬ç«‹ä¸Šä¸‹æ–‡çª—å£**ï¼šæ¯ä¸ª Subagent æœ‰ç‹¬ç«‹çš„ token é¢„ç®—
- âœ… **é¿å… token ç´¯ç§¯**ï¼šä¸»çª—å£åªè¯»å–è¾“å‡ºæ–‡æ¡£ï¼Œä¸å‚ä¸ä»£ç ç¼–å†™

**å·¥ä½œæµå¼ºåˆ¶è§„åˆ™**ï¼š
```
âŒ é”™è¯¯åšæ³•ï¼ˆä¸»çª—å£ç›´æ¥å†™ä»£ç ï¼‰ï¼š
Controller â†’ ç›´æ¥ä¿®æ”¹ä»£ç æ–‡ä»¶ â†’ Token å¿«é€Ÿç´¯ç§¯ â†’ ä¸Šä¸‹æ–‡æº¢å‡º

âœ… æ­£ç¡®åšæ³•ï¼ˆä½¿ç”¨ Subagentï¼‰ï¼š
Controller â†’ Sequential Thinking MCP æ‹†è§£ä»»åŠ¡
         â†’ åˆ›å»ºä»»åŠ¡æ–‡æ¡£
         â†’ å¯åŠ¨ Subagent (Task tool)
         â†’ Subagent å†™ä»£ç å¹¶è¾“å‡ºæ–‡æ¡£
         â†’ Controller è¯»å–è¾“å‡ºæ›´æ–°è¿›åº¦
         â†’ ä¸»çª—å£ Token ä¿æŒä½ä½
```

### 2. æ–‡æ¡£åŒ–çŸ¥è¯†ç®¡ç†ï¼ˆStructured Note-Takingï¼‰

**çµæ„Ÿæ¥æº**ï¼šAnthropic çš„ Context Engineering æœ€ä½³å®è·µ

> "Agent å®šæœŸå°†ç»“æœå†™å…¥æŒä¹…åŒ–å­˜å‚¨ï¼Œåç»­ä»»åŠ¡åªéœ€è¯»å–æ–‡æ¡£ï¼Œè€Œä¸æ˜¯é‡æ–°æ‰§è¡Œæ‰€æœ‰å†å²æ“ä½œ"

**å®ç°æ–¹å¼**ï¼š
```
ä»»åŠ¡ A â†’ è¾“å‡ºæ–‡æ¡£ A
              â†“
ä»»åŠ¡ Bï¼ˆè¯»å–æ–‡æ¡£ Aï¼‰â†’ è¾“å‡ºæ–‡æ¡£ B
                            â†“
ä»»åŠ¡ Cï¼ˆè¯»å–æ–‡æ¡£ Bï¼‰â†’ è¾“å‡ºæ–‡æ¡£ C
```

**ä¼˜åŠ¿**ï¼š
- é¿å…ä¸Šä¸‹æ–‡ç´¯ç§¯ï¼ˆæ¯ä¸ªä»»åŠ¡éƒ½æ˜¯è½»é‡çº§çš„ï¼‰
- çŸ¥è¯†å¯å¤ç”¨ï¼ˆæ–‡æ¡£å¯è¢«åç»­ä»»åŠ¡æˆ–äººç±»æŸ¥é˜…ï¼‰
- å¯è¿½æº¯ï¼ˆå®Œæ•´çš„ä»»åŠ¡é“¾è®°å½•ï¼‰

### 3. Token é¢„ç®—æ§åˆ¶ï¼ˆContext Window Managementï¼‰

**æ ¸å¿ƒç†å¿µ**ï¼šä¸è¦å¡«æ»¡ä¸Šä¸‹æ–‡çª—å£ï¼ˆAndrej Karpathyï¼š"å¡«å……æ°å½“ä¿¡æ¯çš„è‰ºæœ¯"ï¼‰

**ç§‘å­¦ä¾æ®**ï¼š
- Claude Sonnet 4 çš„æœ‰æ•ˆä¸Šä¸‹æ–‡é•¿åº¦çº¦ **60k-120k tokens**
- è¶…è¿‡æœ‰æ•ˆé•¿åº¦ä¼šå¯¼è‡´æ€§èƒ½ä¸‹é™ï¼ˆlost-in-the-middle effectï¼‰
- è®¾å®š **50% é¢„ç®—é™åˆ¶**ï¼ˆ100k tokensï¼‰ç¡®ä¿æœ€ä½³æ€§èƒ½

**æ§åˆ¶ç­–ç•¥**ï¼š
| ç»„ä»¶ | Token é¢„ç®— | å æ¯” |
|------|-----------|------|
| Controllerï¼ˆæˆ‘ï¼‰ | 40k-60k | 4-6% |
| å•ä¸ª Subagent | 20k-30k | 2-3% |
| N ä¸ªå¹¶å‘ Subagent | 20kÃ—N - 30kÃ—N | æ ¹æ®ä»»åŠ¡æ•°åŠ¨æ€è°ƒæ•´ |
| å¯ç”¨æ€»é¢„ç®— | 1,000k tokens | 100% |

**å¹¶å‘èƒ½åŠ›**ï¼š
- æœ€å°å¹¶å‘ï¼š4 ä¸ªä»»åŠ¡ï¼ˆ100k tokensï¼‰
- å¸¸è§„å¹¶å‘ï¼š10-15 ä¸ªä»»åŠ¡ï¼ˆ250k-450k tokensï¼‰
- å¤§è§„æ¨¡å¹¶å‘ï¼š30+ ä¸ªä»»åŠ¡ï¼ˆ600k-900k tokensï¼‰
- ç†è®ºä¸Šé™ï¼š40 ä¸ªä»»åŠ¡ï¼ˆ1M tokens é¢„ç®—å†…ï¼‰

### 4. ä»»åŠ¡ç²’åº¦æ§åˆ¶ï¼ˆTask Granularityï¼‰

**åŸåˆ™**ï¼šä¸€ä¸ªä»»åŠ¡åªä¿®æ”¹ 1-2 ä¸ªæ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶ 200-300 è¡Œ

**Token ä¼°ç®—å…¬å¼**ï¼š
```
å•ä¸ªä»»åŠ¡ Token ä½¿ç”¨ = ä»»åŠ¡æ–‡æ¡£ (5k)
                    + è¯»å–ä»£ç  (6k)
                    + ç”Ÿæˆä»£ç  (10k)
                    + æµ‹è¯•è¯´æ˜ (3k)
                    â‰ˆ 25k tokens
```

**å¤§ä»»åŠ¡åˆ†è§£ç¤ºä¾‹**ï¼š
```
âŒ å¤§ä»»åŠ¡ï¼š"å®ç°å®Œæ•´çš„ç”¨æˆ·ç®¡ç†ç³»ç»Ÿ"ï¼ˆé¢„è®¡ 80k tokensï¼‰

âœ… æ‹†åˆ†ä¸º 4 ä¸ªå°ä»»åŠ¡ï¼š
  - ä»»åŠ¡ 1a: å®ç°ç”¨æˆ·è®¤è¯ APIï¼ˆ25kï¼‰
  - ä»»åŠ¡ 1b: å®ç°æƒé™ç®¡ç†ï¼ˆ20kï¼‰
  - ä»»åŠ¡ 1c: æ·»åŠ å¯†ç é‡ç½®åŠŸèƒ½ï¼ˆ15kï¼‰
  - ä»»åŠ¡ 1d: ç¼–å†™æµ‹è¯•ç”¨ä¾‹ï¼ˆ20kï¼‰
```

---

## æ¶æ„è®¾è®¡

### ç›®å½•ç»“æ„

```
your-web-project/
â”œâ”€â”€ SUBAGENT_DEVELOPMENT_METHODOLOGY.md   # æœ¬æ–‡æ¡£ï¼ˆåŒ…å«æ‰€æœ‰ Subagent è§’è‰²å®šä¹‰ï¼‰
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ tasks/                            # ä»»åŠ¡è¾“å…¥ï¼ˆç»™ Subagent çš„æŒ‡ä»¤ï¼‰
â”‚   â”‚   â”œâ”€â”€ phase1/
â”‚   â”‚   â”‚   â”œâ”€â”€ task-1a-user-auth-api.md
â”‚   â”‚   â”‚   â”œâ”€â”€ task-1b-database-schema-design.md
â”‚   â”‚   â”‚   â”œâ”€â”€ task-1c-frontend-login-ui.md
â”‚   â”‚   â”‚   â””â”€â”€ task-1d-api-security-audit.md
â”‚   â”‚   â”œâ”€â”€ phase2/
â”‚   â”‚   â”‚   â”œâ”€â”€ task-2a-product-catalog-api.md
â”‚   â”‚   â”‚   â”œâ”€â”€ task-2b-shopping-cart-component.md
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â””â”€â”€ phase3/
â”‚   â”‚       â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ outputs/                          # ä»»åŠ¡è¾“å‡ºï¼ˆSubagent å®Œæˆçš„æˆæœï¼‰
â”‚   â”‚   â”œâ”€â”€ phase1/
â”‚   â”‚   â”‚   â”œâ”€â”€ output-1a-auth-api-implementation.md
â”‚   â”‚   â”‚   â”œâ”€â”€ output-1b-database-schema.md
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”œâ”€â”€ phase2/
â”‚   â”‚   â””â”€â”€ phase3/
â”‚   â”‚
â”‚   â”œâ”€â”€ progress/                         # è¿›åº¦è·Ÿè¸ª
â”‚   â”‚   â”œâ”€â”€ phase1-progress.md
â”‚   â”‚   â”œâ”€â”€ phase2-progress.md
â”‚   â”‚   â””â”€â”€ phase3-progress.md
â”‚   â”‚
â”‚   â””â”€â”€ knowledge-base/                   # å¯å¤ç”¨çŸ¥è¯†åº“
â”‚       â”œâ”€â”€ api-design-patterns.md
â”‚       â”œâ”€â”€ database-migration-guide.md
â”‚       â”œâ”€â”€ frontend-component-library.md
â”‚       â””â”€â”€ deployment-checklist.md
â”‚
â”œâ”€â”€ src/                                  # æºä»£ç 
â”‚   â”œâ”€â”€ frontend/                         # å‰ç«¯ä»£ç  (React/Next.jsç­‰)
â”‚   â”œâ”€â”€ backend/                          # åç«¯ä»£ç  (Node.js/Pythonç­‰)
â”‚   â””â”€â”€ database/                         # æ•°æ®åº“è„šæœ¬å’Œè¿ç§»
â”‚
â””â”€â”€ infrastructure/                       # åŸºç¡€è®¾æ–½ä»£ç  (Terraform/K8sç­‰)
    â””â”€â”€ ...
```

### Subagent è§’è‰²å®šä¹‰

> **è¯´æ˜**ï¼šä»¥ä¸‹æ˜¯é€šç”¨ Web é¡¹ç›®çš„ Subagent è§’è‰²æ¨¡æ¿ã€‚å®é™…é¡¹ç›®åº”æ ¹æ®å…·ä½“éœ€æ±‚è°ƒæ•´è§’è‰²å®šä¹‰ã€‚
> å¯å‚è€ƒ `~/.claude/agents/` ç›®å½•ä¸­çš„ agent å®šä¹‰è¿›è¡Œæ‰©å±•ã€‚

#### 1. Frontend Developer ğŸ¨
- **ä¸“é•¿**ï¼šReact/Next.js/Vue.jsï¼Œå“åº”å¼UIï¼ŒçŠ¶æ€ç®¡ç†
- **èŒè´£**ï¼šå®ç°å‰ç«¯ç»„ä»¶ã€é¡µé¢å¸ƒå±€ã€ç”¨æˆ·äº¤äº’
- **å·¥ä½œèŒƒå›´**ï¼š`src/frontend/`, `src/components/`
- **å‚è€ƒ**ï¼š`~/.claude/agents/frontend-developer.md`

#### 2. Backend Architect ğŸ—ï¸
- **ä¸“é•¿**ï¼šRESTful/GraphQL API è®¾è®¡ï¼Œå¾®æœåŠ¡æ¶æ„ï¼Œäº‹ä»¶é©±åŠ¨ç³»ç»Ÿ
- **èŒè´£**ï¼šè®¾è®¡åç«¯æœåŠ¡ã€API æ¥å£ã€æœåŠ¡è¾¹ç•Œå®šä¹‰
- **å·¥ä½œèŒƒå›´**ï¼š`src/backend/`, `src/api/`, `src/services/`
- **å‚è€ƒ**ï¼š`~/.claude/agents/backend-architect.md`

#### 3. Database Architect ğŸ—„ï¸
- **ä¸“é•¿**ï¼šæ•°æ®å»ºæ¨¡ï¼ŒSQL/NoSQL æ•°æ®åº“é€‰å‹ï¼Œæ€§èƒ½ä¼˜åŒ–
- **èŒè´£**ï¼šè®¾è®¡æ•°æ®åº“ schemaã€ç´¢å¼•ç­–ç•¥ã€è¿ç§»æ–¹æ¡ˆ
- **å·¥ä½œèŒƒå›´**ï¼š`src/database/`, `migrations/`
- **å‚è€ƒ**ï¼š`~/.claude/agents/database-architect.md`

#### 4. API Security Auditor ğŸ”’
- **ä¸“é•¿**ï¼šAPI å®‰å…¨å®¡è®¡ï¼ŒOWASP Top 10ï¼Œè®¤è¯æˆæƒ
- **èŒè´£**ï¼šå®‰å…¨æ¼æ´æ‰«æã€èº«ä»½éªŒè¯è®¾è®¡ã€æ•°æ®ä¿æŠ¤
- **å·¥ä½œèŒƒå›´**ï¼šæ‰€æœ‰ API ç«¯ç‚¹ã€è®¤è¯æ¨¡å—
- **å‚è€ƒ**ï¼š`~/.claude/agents/api-security-audit.md`

#### 5. DevOps Engineer ğŸš€
- **ä¸“é•¿**ï¼šCI/CDã€å®¹å™¨åŒ–ã€Kubernetesã€ç›‘æ§å‘Šè­¦
- **èŒè´£**ï¼šéƒ¨ç½²è‡ªåŠ¨åŒ–ã€åŸºç¡€è®¾æ–½å³ä»£ç ã€æ•…éšœæ’æŸ¥
- **å·¥ä½œèŒƒå›´**ï¼š`infrastructure/`, `.github/workflows/`, `k8s/`
- **å‚è€ƒ**ï¼š`~/.claude/agents/devops-troubleshooter.md`

#### 6. Full-Stack Integration Specialist ğŸ”—
- **ä¸“é•¿**ï¼šå‰åç«¯é›†æˆã€API å¯¹æ¥ã€æ•°æ®æµè®¾è®¡
- **èŒè´£**ï¼šç¡®ä¿å‰åç«¯æ— ç¼åä½œã€æ•°æ®ä¸€è‡´æ€§
- **å·¥ä½œèŒƒå›´**ï¼šè·¨å‰åç«¯çš„é›†æˆå±‚

#### ğŸ’¡ **å¦‚ä½•æ‰©å±•å’Œè‡ªå®šä¹‰ Subagent è§’è‰²**

##### 1. ä½¿ç”¨ç°æœ‰è§’è‰²æ¨¡æ¿

`~/.claude/agents/` ç›®å½•æä¾›äº†ä¸°å¯Œçš„é¢„å®šä¹‰è§’è‰²æ¨¡æ¿ï¼š

- **Performance Engineer**: æ€§èƒ½ä¼˜åŒ–ã€ç¼“å­˜ç­–ç•¥ï¼ˆå‚è€ƒ `performance-engineer.md`ï¼‰
- **Cloud Architect**: äº‘æ¶æ„è®¾è®¡ã€å¤šäº‘éƒ¨ç½²ï¼ˆå‚è€ƒ `cloud-architect.md`ï¼‰
- **Data Engineer**: æ•°æ®ç®¡é“ã€ETL æµç¨‹ï¼ˆå‚è€ƒ `data-engineer.md`ï¼‰
- **Mobile Developer**: iOS/Android åŸç”Ÿå¼€å‘ï¼ˆå‚è€ƒ `ios-developer.md`ï¼‰
- **Blockchain Developer**: Web3 é›†æˆï¼ˆå‚è€ƒ `blockchain-developer.md`ï¼‰
- **AI Engineer**: LLM é›†æˆã€RAG ç³»ç»Ÿï¼ˆå‚è€ƒ `ai-engineer.md`ï¼‰

##### 2. è‡ªå®šä¹‰ Subagent è§’è‰²ï¼ˆå½“ç°æœ‰è§’è‰²ä¸æ»¡è¶³éœ€æ±‚æ—¶ï¼‰

**åœºæ™¯ç¤ºä¾‹**ï¼š
- ç”µå•†é¡¹ç›®éœ€è¦"æ”¯ä»˜é›†æˆä¸“å®¶"
- ç¤¾äº¤å¹³å°éœ€è¦"å®æ—¶æ¨é€æœåŠ¡ä¸“å®¶"
- IoT é¡¹ç›®éœ€è¦"è®¾å¤‡åè®®é€‚é…ä¸“å®¶"

**åˆ›å»ºæ­¥éª¤**ï¼š

**Step 1**: å®šä¹‰è§’è‰²å±æ€§

åœ¨ `docs/agents/` åˆ›å»ºæ–°æ–‡ä»¶ï¼Œä¾‹å¦‚ `payment-integration-specialist.md`ï¼š

```markdown
---
name: payment-integration-specialist
description: æ”¯ä»˜é›†æˆä¸“å®¶ï¼Œç²¾é€š Stripe/PayPal/å¾®ä¿¡æ”¯ä»˜ç­‰å¤šç§æ”¯ä»˜æ–¹å¼
model: opus  # æˆ– sonnetï¼Œæ ¹æ®å¤æ‚åº¦é€‰æ‹©
---

## è§’è‰²å®šä¹‰

### ä¸“é•¿é¢†åŸŸ
- Stripe API é›†æˆå’Œ Webhook å¤„ç†
- PayPal Express Checkout å’Œè®¢é˜…æ”¯ä»˜
- å¾®ä¿¡æ”¯ä»˜/æ”¯ä»˜å®æ”¯ä»˜é›†æˆ
- PCI-DSS åˆè§„æ€§è¦æ±‚
- æ”¯ä»˜å®‰å…¨å’Œåæ¬ºè¯ˆ

### æ ¸å¿ƒèŒè´£
- è®¾è®¡æ”¯ä»˜æµç¨‹å’ŒçŠ¶æ€æœº
- å®ç°æ”¯ä»˜å›è°ƒå’Œå¼‚æ­¥é€šçŸ¥å¤„ç†
- å¤„ç†é€€æ¬¾ã€äº‰è®®å’Œå¯¹è´¦é€»è¾‘
- ç¡®ä¿æ”¯ä»˜æ•°æ®å®‰å…¨å’Œåˆè§„æ€§

### å·¥ä½œèŒƒå›´
- `src/payments/` - æ”¯ä»˜æœåŠ¡å®ç°
- `src/webhooks/` - æ”¯ä»˜å›è°ƒå¤„ç†
- `src/billing/` - è´¦å•å’Œå¯¹è´¦ç³»ç»Ÿ

### ä¾èµ–çŸ¥è¯†
- ç†è§£ Idempotencyï¼ˆå¹‚ç­‰æ€§ï¼‰è®¾è®¡
- ç†Ÿæ‚‰åˆ†å¸ƒå¼äº‹åŠ¡å’Œæœ€ç»ˆä¸€è‡´æ€§
- æŒæ¡ Webhook å®‰å…¨éªŒè¯ï¼ˆç­¾åæ ¡éªŒï¼‰
- äº†è§£è´§å¸ç²¾åº¦å¤„ç†ï¼ˆé¿å…æµ®ç‚¹æ•°è¯¯å·®ï¼‰

### è¾“å‡ºè§„èŒƒ
- å¿…é¡»åŒ…å«å®Œæ•´çš„é”™è¯¯å¤„ç†ï¼ˆç½‘ç»œè¶…æ—¶ã€æ”¯ä»˜å¤±è´¥ã€é‡å¤æ”¯ä»˜ç­‰ï¼‰
- å¿…é¡»æ·»åŠ è¯¦ç»†çš„æ”¯ä»˜çŠ¶æ€æµè½¬æ—¥å¿—
- å¿…é¡»å®ç° Webhook é‡è¯•æœºåˆ¶
- å¿…é¡»è€ƒè™‘å¹¶å‘åœºæ™¯ä¸‹çš„å¹‚ç­‰æ€§ä¿æŠ¤

### æµ‹è¯•è¦æ±‚
- å•å…ƒæµ‹è¯•è¦†ç›–ç‡ > 90%
- é›†æˆæµ‹è¯•è¦†ç›–æ ¸å¿ƒæ”¯ä»˜æµç¨‹
- ä½¿ç”¨ Stripe Test Mode éªŒè¯åŠŸèƒ½
- æ¨¡æ‹Ÿå„ç§å¼‚å¸¸åœºæ™¯ï¼ˆè¶…æ—¶ã€æ‹’ç»ã€å–æ¶ˆç­‰ï¼‰
```

**Step 2**: åœ¨é¡¹ç›®ä¸­å¼•ç”¨

åœ¨ `SUBAGENT_DEVELOPMENT_METHODOLOGY.md` çš„è§’è‰²åˆ—è¡¨ä¸­æ·»åŠ ï¼š

```markdown
#### 7. Payment Integration Specialist ğŸ’³
- **ä¸“é•¿**ï¼šStripe/PayPal/å¾®ä¿¡æ”¯ä»˜é›†æˆ
- **èŒè´£**ï¼šæ”¯ä»˜æµç¨‹è®¾è®¡ã€Webhook å¤„ç†ã€é€€æ¬¾å’Œå¯¹è´¦
- **å·¥ä½œèŒƒå›´**ï¼š`src/payments/`, `src/webhooks/`
- **å‚è€ƒ**ï¼š`docs/agents/payment-integration-specialist.md`
```

**Step 3**: åˆ›å»ºä»»åŠ¡æ–‡æ¡£æ—¶ä½¿ç”¨

```markdown
# Task 3a: Stripe æ”¯ä»˜é›†æˆ

## Role
Payment Integration Specialist

## Objective
å®ç° Stripe æ”¯ä»˜å®Œæ•´æµç¨‹ï¼ŒåŒ…æ‹¬åˆ›å»ºè®¢å•ã€å¤„ç†æ”¯ä»˜ã€Webhook å›è°ƒ

## Context
- é¡¹ç›®ä½¿ç”¨ Stripe ä½œä¸ºä¸»è¦æ”¯ä»˜æ–¹å¼
- éœ€è¦æ”¯æŒä¸€æ¬¡æ€§æ”¯ä»˜å’Œè®¢é˜…æ”¯ä»˜
- å¿…é¡»é€šè¿‡ PCI-DSS åˆè§„æ€§æ£€æŸ¥

## Requirements
1. å®ç° /api/payments/create-checkout-session æ¥å£
2. å®ç° Webhook æ¥æ”¶å’ŒéªŒè¯ï¼ˆ/webhooks/stripeï¼‰
3. æ”¯ä»˜æˆåŠŸåæ›´æ–°è®¢å•çŠ¶æ€
4. æ·»åŠ æ”¯ä»˜å¤±è´¥é‡è¯•æœºåˆ¶
5. å®ç°å¹‚ç­‰æ€§ä¿æŠ¤ï¼ˆé˜²æ­¢é‡å¤æ‰£æ¬¾ï¼‰

## Output Location
docs/outputs/phase3/output-3a-stripe-payment.md
```

##### 3. è‡ªå®šä¹‰ Subagent çš„æœ€ä½³å®è·µ

**åŸåˆ™**ï¼š
1. âœ… **èŒè´£å•ä¸€**ï¼šæ¯ä¸ª Subagent åªè´Ÿè´£ä¸€ä¸ªæ˜ç¡®çš„é¢†åŸŸ
2. âœ… **è¾¹ç•Œæ¸…æ™°**ï¼šå®šä¹‰æ˜ç¡®çš„å·¥ä½œèŒƒå›´ï¼Œé¿å…èŒè´£é‡å 
3. âœ… **å¯æµ‹è¯•æ€§**ï¼šè¾“å‡ºå¿…é¡»åŒ…å«æµ‹è¯•ç”¨ä¾‹
4. âœ… **æ–‡æ¡£å®Œæ•´**ï¼šåŒ…å«å®Œæ•´çš„æ¥å£è®¾è®¡å’Œå®ç°è¯´æ˜
5. âœ… **å¯å¤ç”¨æ€§**ï¼šè®¾è®¡æ—¶è€ƒè™‘åç»­ä»»åŠ¡å¯èƒ½çš„å¤ç”¨åœºæ™¯

**ä½•æ—¶åˆ›å»ºæ–°è§’è‰² vs ä½¿ç”¨ç°æœ‰è§’è‰²**ï¼š

| åœºæ™¯ | å»ºè®® |
|------|------|
| æ ‡å‡†çš„å‰ç«¯/åç«¯/æ•°æ®åº“ä»»åŠ¡ | ä½¿ç”¨ç°æœ‰é€šç”¨è§’è‰² |
| ç‰¹å®šæŠ€æœ¯æ ˆï¼ˆå¦‚ Stripeã€Kafkaã€Redisï¼‰ | åˆ›å»ºä¸“é—¨è§’è‰² |
| é¢†åŸŸç‰¹å®šé€»è¾‘ï¼ˆæ”¯ä»˜ã€æ¨èç®—æ³•ï¼‰ | åˆ›å»ºé¢†åŸŸä¸“å®¶è§’è‰² |
| ä¸€æ¬¡æ€§ç®€å•ä»»åŠ¡ | ä½¿ç”¨é€šç”¨è§’è‰²å³å¯ |
| éœ€è¦æ·±åº¦é¢†åŸŸçŸ¥è¯†çš„å¤æ‚æ¨¡å— | å¿…é¡»åˆ›å»ºä¸“é—¨è§’è‰² |

##### 4. åŠ¨æ€è°ƒæ•´è§’è‰²

éšç€é¡¹ç›®æ¼”è¿›ï¼Œè§’è‰²å®šä¹‰åº”è¯¥ä¸æ–­ä¼˜åŒ–ï¼š

```markdown
## è§’è‰²æ¼”è¿›è®°å½•

### v1.0 (2025-01-15)
- åˆå§‹å®šä¹‰ï¼šåŸºç¡€æ”¯ä»˜é›†æˆ

### v1.1 (2025-02-01)
- æ–°å¢èŒè´£ï¼šè®¢é˜…ç®¡ç†å’Œå‘¨æœŸæ€§æ‰£æ¬¾
- æ–°å¢èŒè´£ï¼šå¤šè´§å¸æ”¯æŒ

### v1.2 (2025-03-10)
- æ‹†åˆ†è§’è‰²ï¼šå°†"å¯¹è´¦ç³»ç»Ÿ"ç‹¬ç«‹ä¸ºæ–°è§’è‰²
- åŸå› ï¼šå¯¹è´¦é€»è¾‘å˜å¾—å¤æ‚ï¼Œéœ€è¦ç‹¬ç«‹å¤„ç†
```

**æ€»ç»“**ï¼š
- ä¼˜å…ˆä½¿ç”¨ `~/.claude/agents/` ä¸­çš„æ ‡å‡†è§’è‰²
- æ ¹æ®é¡¹ç›®ç‰¹æ®Šéœ€æ±‚è‡ªå®šä¹‰ä¸“ä¸šè§’è‰²
- ä¿æŒè§’è‰²å®šä¹‰çš„æ¸…æ™°æ€§å’Œå¯ç»´æŠ¤æ€§
- éšé¡¹ç›®æ¼”è¿›æŒç»­ä¼˜åŒ–è§’è‰²å®šä¹‰

#### 7. TDD Red-Phase Specialist ğŸ”´

**ä¸“é•¿**ï¼šæµ‹è¯•é©±åŠ¨å¼€å‘ï¼Œæµ‹è¯•ç”¨ä¾‹è®¾è®¡

**æ ¸å¿ƒèŒè´£**ï¼š
- ç¼–å†™å¤±è´¥çš„æµ‹è¯•ç”¨ä¾‹æ¥æ˜ç¡®åŠŸèƒ½éœ€æ±‚
- ä»ä½¿ç”¨è€…è§’åº¦è®¾è®¡æ¸…æ™°çš„ API
- è¦†ç›–æ­£å¸¸ã€è¾¹ç•Œã€å¼‚å¸¸åœºæ™¯
- ä½¿ç”¨ AAA æ¨¡å¼ï¼ˆArrange-Act-Assertï¼‰

**å·¥ä½œæµç¨‹**ï¼š
1. ç†è§£éœ€æ±‚ â†’ æå–æ ¸å¿ƒåŠŸèƒ½ç‚¹
2. è®¾è®¡æµ‹è¯•ç”¨ä¾‹ â†’ ç¼–å†™æµ‹è¯•ä»£ç 
3. éªŒè¯æµ‹è¯•å¤±è´¥ â†’ ç¡®ä¿æµ‹è¯•æœ‰æ•ˆ
4. æ–‡æ¡£è¾“å‡º â†’ è®°å½•æµ‹è¯•ç”¨ä¾‹å’Œæ¥å£è®¾è®¡

**æœ€ä½³å®è·µ**ï¼š
- âœ… æµ‹è¯•åç§°æ¸…æ™°æè¿°è¡Œä¸º
- âœ… ä¸€ä¸ªæµ‹è¯•åªéªŒè¯ä¸€ä¸ªè¡Œä¸º
- âœ… æµ‹è¯•ç‹¬ç«‹æ€§ï¼ˆä¸ä¾èµ–å…¶ä»–æµ‹è¯•ï¼‰
- âœ… è¦†ç›–è¾¹ç•Œæ¡ä»¶å’Œå¼‚å¸¸æƒ…å†µ
- âŒ ä¸€æ¬¡å†™å¤ªå¤šæµ‹è¯•
- âŒ æµ‹è¯•ä¹‹é—´ç›¸äº’ä¾èµ–

**Token é¢„ç®—**ï¼š~23k tokens

#### 8. TDD Green-Phase Developer ğŸŸ¢

**ä¸“é•¿**ï¼šæœ€å°åŒ–å®ç°ï¼Œå¿«é€Ÿè®©æµ‹è¯•é€šè¿‡

**æ ¸å¿ƒèŒè´£**ï¼š
- ç”¨æœ€ç®€å•çš„ä»£ç è®©æµ‹è¯•ä»çº¢è‰²å˜ä¸ºç»¿è‰²
- å…è®¸ç¡¬ç¼–ç å’Œ"ç¬¨"æ–¹æ³•
- ä¸“æ³¨å½“å‰æµ‹è¯•ï¼Œé¿å…è¿‡åº¦è®¾è®¡
- å¿«é€Ÿè¿­ä»£ï¼Œé¢‘ç¹è¿è¡Œæµ‹è¯•

**å®ç°ç­–ç•¥**ï¼š
1. **ç¡¬ç¼–ç ä¼˜å…ˆï¼ˆFake Itï¼‰**ï¼šç›´æ¥è¿”å›æµ‹è¯•æœŸæœ›çš„å€¼
2. **æ˜æ˜¾å®ç°ï¼ˆObvious Implementationï¼‰**ï¼šå¦‚æœå®ç°å¾ˆç®€å•ï¼Œç›´æ¥å†™å‡ºæ¥
3. **ä¸‰è§’æ³•ï¼ˆTriangulationï¼‰**ï¼šé€šè¿‡å¤šä¸ªæµ‹è¯•ç”¨ä¾‹"ä¸‰è§’å®šä½"æ­£ç¡®å®ç°

**å·¥ä½œæµç¨‹**ï¼š
1. ç†è§£æµ‹è¯• â†’ æŸ¥çœ‹æµ‹è¯•æ–‡ä»¶å’Œ RED é˜¶æ®µæ–‡æ¡£
2. æœ€å°åŒ–å®ç° â†’ ç”¨æœ€ç®€å•æ–¹å¼è®©æµ‹è¯•é€šè¿‡
3. é€æ­¥å®Œå–„ â†’ å¤„ç†ä¸åŒè¾“å…¥å’Œè¾¹ç•Œæƒ…å†µ
4. éªŒè¯æ‰€æœ‰æµ‹è¯• â†’ ç¡®ä¿å…¨éƒ¨é€šè¿‡
5. æ–‡æ¡£è¾“å‡º â†’ è®°å½•å®ç°æ–¹å¼å’Œä¸´æ—¶æ–¹æ¡ˆ

**æœ€ä½³å®è·µ**ï¼š
- âœ… ä»æœ€ç®€å•çš„æµ‹è¯•å¼€å§‹
- âœ… é¢‘ç¹è¿è¡Œæµ‹è¯•ï¼ˆä½¿ç”¨ watch æ¨¡å¼ï¼‰
- âœ… å…ˆç¡¬ç¼–ç ï¼Œå†æ³›åŒ–
- âœ… å…è®¸é‡å¤ä»£ç ï¼ˆREFACTOR é˜¶æ®µä¼šæ¶ˆé™¤ï¼‰
- âŒ è¿‡åº¦è®¾è®¡å’Œé¢„å…ˆä¼˜åŒ–
- âŒ æ·»åŠ æµ‹è¯•æœªè¦æ±‚çš„åŠŸèƒ½
- âŒ è·³è¿‡å¤±è´¥çš„æµ‹è¯•

**Token é¢„ç®—**ï¼š~23k tokens

#### 9. TDD Refactor Specialist ğŸ”§

**ä¸“é•¿**ï¼šä»£ç é‡æ„ï¼Œè®¾è®¡ä¼˜åŒ–

**æ ¸å¿ƒèŒè´£**ï¼š
- åœ¨ä¿æŒæ‰€æœ‰æµ‹è¯•é€šè¿‡çš„å‰æä¸‹ä¼˜åŒ–ä»£ç è´¨é‡
- æ¶ˆé™¤é‡å¤ä»£ç ï¼ˆDRY åŸåˆ™ï¼‰
- æå‡å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§
- åº”ç”¨è®¾è®¡æ¨¡å¼å’Œæœ€ä½³å®è·µ
- ä¼˜åŒ–æ€§èƒ½

**é‡æ„æŠ€å·§**ï¼š
1. **æå–æ–¹æ³•ï¼ˆExtract Methodï¼‰**ï¼šå°†é•¿æ–¹æ³•æ‹†åˆ†ä¸ºå°æ–¹æ³•
2. **æ¶ˆé™¤é‡å¤ï¼ˆRemove Duplicationï¼‰**ï¼šæå–å…¬å…±é€»è¾‘
3. **å¼•å…¥ç­–ç•¥æ¨¡å¼**ï¼šæ›¿æ¢æ¡ä»¶åˆ†æ”¯
4. **æ›¿æ¢é­”æ³•æ•°å­—**ï¼šä½¿ç”¨å‘½åå¸¸é‡
5. **ç®€åŒ–æ¡ä»¶è¡¨è¾¾å¼**ï¼šæé«˜å¯è¯»æ€§

**å·¥ä½œæµç¨‹**ï¼š
1. è¯„ä¼°å½“å‰ä»£ç  â†’ è¯†åˆ«å¯æ”¹è¿›çš„åœ°æ–¹
2. åˆ¶å®šé‡æ„è®¡åˆ’ â†’ ä¼˜å…ˆçº§æ’åº
3. é€æ­¥é‡æ„ â†’ å°æ­¥å‰è¿›ï¼Œé¢‘ç¹æµ‹è¯•
4. éªŒè¯è´¨é‡ â†’ è¿è¡Œæµ‹è¯•ã€æ£€æŸ¥è¦†ç›–ç‡
5. æ–‡æ¡£è¾“å‡º â†’ è®°å½•æ”¹è¿›ç‚¹å’Œè´¨é‡æŒ‡æ ‡

**ä»£ç è´¨é‡æ£€æŸ¥**ï¼š
- æ¶ˆé™¤ä»£ç å¼‚å‘³ï¼ˆé•¿æ–¹æ³•ã€é‡å¤ä»£ç ã€é­”æ³•æ•°å­—ç­‰ï¼‰
- éµå¾ª SOLID åŸåˆ™
- æå‡æµ‹è¯•è¦†ç›–ç‡
- é™ä½ä»£ç å¤æ‚åº¦

**æœ€ä½³å®è·µ**ï¼š
- âœ… å°æ­¥é‡æ„ï¼Œæ¯æ¬¡åªæ”¹ä¸€ä¸ªåœ°æ–¹
- âœ… é¢‘ç¹è¿è¡Œæµ‹è¯•ç¡®ä¿å®‰å…¨
- âœ… æäº¤å‰åå¯¹æ¯”è´¨é‡æŒ‡æ ‡
- âœ… ä¿æŒæˆ–æå‡æµ‹è¯•è¦†ç›–ç‡
- âŒ ä¸è¦æ”¹å˜åŠŸèƒ½è¡Œä¸º
- âŒ ä¸è¦è·³è¿‡æµ‹è¯•
- âŒ ä¸è¦ä¸€æ¬¡æ”¹å¤ªå¤š
- âŒ ä¸è¦è¿‡åº¦é‡æ„

**Token é¢„ç®—**ï¼š~23k tokens

---

## TDD å·¥ä½œæµç¨‹

### ä»€ä¹ˆæ˜¯æµ‹è¯•é©±åŠ¨å¼€å‘ (TDD)ï¼Ÿ

TDD æ˜¯ä¸€ç§è½¯ä»¶å¼€å‘è¿‡ç¨‹ï¼Œæ ¸å¿ƒç†å¿µæ˜¯**"å…ˆå†™æµ‹è¯•ï¼Œå†å†™å®ç°"**ã€‚å¼€å‘è€…é¦–å…ˆç¼–å†™ä¸€ä¸ªç®€çŸ­çš„ã€æè¿°æ–°åŠŸèƒ½æˆ–æ”¹è¿›çš„è‡ªåŠ¨åŒ–æµ‹è¯•ç”¨ä¾‹ï¼Œè¿™ä¸ªæµ‹è¯•åœ¨æœ€åˆå¿…ç„¶æ˜¯å¤±è´¥çš„ã€‚ç„¶åï¼Œå¼€å‘è€…ç¼–å†™æœ€å°‘çš„ä»£ç æ¥è®©è¿™ä¸ªæµ‹è¯•é€šè¿‡ã€‚æœ€åï¼Œå¯¹æ–°ä»£ç è¿›è¡Œé‡æ„ï¼Œä»¥ç¬¦åˆç¼–ç è§„èŒƒã€‚

### TDD æ ¸å¿ƒæµç¨‹ï¼šçº¢-ç»¿-é‡æ„ (Red-Green-Refactor)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    TDD å¾ªç¯æµç¨‹                          â”‚
â”‚                                                         â”‚
â”‚   ğŸ”´ RED                                               â”‚
â”‚   å†™ä¸€ä¸ªå¤±è´¥çš„æµ‹è¯•                                        â”‚
â”‚   â†“                                                     â”‚
â”‚   - æ˜ç¡®åŠŸèƒ½éœ€æ±‚å’ŒæœŸæœ›è¡Œä¸º                                â”‚
â”‚   - æµ‹è¯•å¿…é¡»å¤±è´¥ï¼ˆè¯æ˜åŠŸèƒ½å°šæœªå®ç°ï¼‰                        â”‚
â”‚   - æ€è€ƒè¾“å…¥ã€è¾“å‡ºå’Œè¾¹ç•Œæ¡ä»¶                               â”‚
â”‚                                                         â”‚
â”‚   ğŸŸ¢ GREEN                                             â”‚
â”‚   å†™æœ€å°‘ä»£ç è®©æµ‹è¯•é€šè¿‡                                     â”‚
â”‚   â†“                                                     â”‚
â”‚   - å¿«é€Ÿå®ç°ï¼Œä¸æ±‚å®Œç¾                                    â”‚
â”‚   - åªå…³æ³¨è®©æµ‹è¯•å˜ç»¿                                      â”‚
â”‚   - é¿å…è¿‡åº¦è®¾è®¡                                         â”‚
â”‚                                                         â”‚
â”‚   ğŸ”§ REFACTOR                                          â”‚
â”‚   ä¼˜åŒ–ä»£ç è´¨é‡                                           â”‚
â”‚   â†“                                                     â”‚
â”‚   - æ¶ˆé™¤é‡å¤ä»£ç                                          â”‚
â”‚   - æé«˜å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§                                  â”‚
â”‚   - ä¼˜åŒ–è®¾è®¡å’Œæ€§èƒ½                                       â”‚
â”‚   - ç¡®ä¿æµ‹è¯•ä¾ç„¶é€šè¿‡                                     â”‚
â”‚                                                         â”‚
â”‚   â†» å›åˆ° REDï¼Œå¼€å§‹ä¸‹ä¸€ä¸ªåŠŸèƒ½                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### é˜¶æ®µ 1: çº¢è‰² (Red) - å†™ä¸€ä¸ªå¤±è´¥çš„æµ‹è¯•

**ç›®æ ‡**: æ˜ç¡®ä½ æƒ³è¦å®ç°çš„åŠŸèƒ½æ˜¯ä»€ä¹ˆ

**æ“ä½œ**:
- é’ˆå¯¹ä¸€ä¸ªæå°çš„åŠŸèƒ½ç‚¹ï¼Œç¼–å†™è‡ªåŠ¨åŒ–æµ‹è¯•
- å› ä¸ºè¿˜æ²¡æœ‰å®ç°ä»£ç ï¼Œæµ‹è¯•å¿…ç„¶å¤±è´¥ï¼ˆçº¢è‰²ï¼‰
- æµ‹è¯•å¤±è´¥å¯èƒ½æ˜¯ç¼–è¯‘é”™è¯¯æˆ–æ–­è¨€å¤±è´¥

**æ„ä¹‰**:
- å¼ºè¿«æ€è€ƒéœ€æ±‚å’ŒåŠŸèƒ½ç»†èŠ‚
- æ˜ç¡®è¾“å…¥ã€è¾“å‡ºå’ŒæœŸæœ›è¡Œä¸º
- å»ºç«‹æ¸…æ™°çš„æˆåŠŸæ ‡å‡†

**ç¤ºä¾‹**:
```typescript
// tests/user-auth.test.ts
describe('UserAuthService', () => {
  it('should authenticate user with valid credentials', async () => {
    const authService = new UserAuthService();
    const result = await authService.login('user@example.com', 'password123');

    expect(result).toBeDefined();
    expect(result.token).toBeTruthy();
    expect(result.user.email).toBe('user@example.com');
  });
});

// è¿è¡Œæµ‹è¯• â†’ âŒ å¤±è´¥ï¼ˆUserAuthService ç±»è¿˜ä¸å­˜åœ¨ï¼‰
```

#### é˜¶æ®µ 2: ç»¿è‰² (Green) - å†™æœ€å°‘ä»£ç è®©æµ‹è¯•é€šè¿‡

**ç›®æ ‡**: å¿«é€Ÿå®ç°åŠŸèƒ½ï¼Œæ»¡è¶³æµ‹è¯•è¦æ±‚

**æ“ä½œ**:
- ç¼–å†™åˆšå¥½èƒ½è®©æµ‹è¯•é€šè¿‡çš„ä»£ç 
- ä¸è¿½æ±‚å®Œç¾ï¼Œå…è®¸"ç¬¨"æ–¹æ³•
- å…³é”®åœ¨äº"æœ€å°‘" - åªåšå¿…è¦çš„äº‹

**æ„ä¹‰**:
- ä¸“æ³¨äºå½“å‰å”¯ä¸€ç›®æ ‡ï¼šæ»¡è¶³æµ‹è¯•
- é¿å…è¿‡åº¦å·¥ç¨‹å’Œåç¦»éœ€æ±‚
- å¿«é€Ÿè·å¾—åé¦ˆ

**ç¤ºä¾‹**:
```typescript
// src/user-auth-service.ts
export class UserAuthService {
  async login(email: string, password: string): Promise<AuthResult> {
    // æœ€ç®€å•çš„å®ç° - å…ˆè®©æµ‹è¯•é€šè¿‡
    return {
      token: 'mock-jwt-token-12345',  // ç¡¬ç¼–ç ä¸€ä¸ª token
      user: { email }
    };
  }
}

// è¿è¡Œæµ‹è¯• â†’ âœ… é€šè¿‡ï¼ˆè™½ç„¶æ˜¯ç¡¬ç¼–ç ï¼Œä½†æµ‹è¯•é€šè¿‡äº†ï¼‰
```

#### é˜¶æ®µ 3: é‡æ„ (Refactor) - ä¼˜åŒ–ä»£ç 

**ç›®æ ‡**: åœ¨ä¸æ”¹å˜å¤–éƒ¨è¡Œä¸ºçš„å‰æä¸‹æå‡ä»£ç è´¨é‡

**æ“ä½œ**:
- æœ‰æµ‹è¯•ä½œä¸º"å®‰å…¨ç½‘"ï¼Œå¯ä»¥æ”¾å¿ƒé‡æ„
- æ¶ˆé™¤é‡å¤ä»£ç 
- æé«˜å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§
- ä¼˜åŒ–ç®—æ³•å’Œè®¾è®¡
- æ¯æ¬¡ä¿®æ”¹åé‡æ–°è¿è¡Œæµ‹è¯•

**æ„ä¹‰**:
- ç¡®ä¿ä»£ç é•¿æœŸå¯ç»´æŠ¤
- æå‡ä»£ç è´¨é‡å’Œæ€§èƒ½
- æµ‹è¯•ä¿æŠ¤è®©ä½ æ•¢äºé‡æ„

**ç¤ºä¾‹**:
```typescript
// src/user-auth-service.ts
import { hash, compare } from 'bcrypt';
import { sign } from 'jsonwebtoken';
import { UserRepository } from './user-repository';

export class UserAuthService {
  private userRepo: UserRepository;
  private jwtSecret: string;

  constructor(userRepo: UserRepository, jwtSecret: string) {
    this.userRepo = userRepo;
    this.jwtSecret = jwtSecret;
  }

  async login(email: string, password: string): Promise<AuthResult> {
    const user = await this.findUserByEmail(email);
    await this.validatePassword(password, user.passwordHash);

    return {
      token: this.generateToken(user),
      user: { email: user.email, id: user.id }
    };
  }

  private async findUserByEmail(email: string) {
    const user = await this.userRepo.findByEmail(email);
    if (!user) {
      throw new Error('User not found');
    }
    return user;
  }

  private async validatePassword(password: string, hash: string) {
    const isValid = await compare(password, hash);
    if (!isValid) {
      throw new Error('Invalid password');
    }
  }

  private generateToken(user: User): string {
    return sign({ userId: user.id, email: user.email }, this.jwtSecret, {
      expiresIn: '24h'
    });
  }
}

// è¿è¡Œæµ‹è¯• â†’ âœ… ä¾ç„¶é€šè¿‡ï¼ˆé‡æ„æˆåŠŸï¼ï¼‰
```

### TDD ä¸ Subagent æ–¹æ³•è®ºçš„æ•´åˆ

åœ¨ Subagent å¹¶å‘å¼€å‘æ–¹æ³•è®ºä¸­ï¼ŒTDD å¯ä»¥é€šè¿‡ä¸“é—¨çš„ Subagent è§’è‰²æ¥å®ç°ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Controller (Sequential Thinking)              â”‚
â”‚         åˆ†æéœ€æ±‚ â†’ åˆ†è§£ä¸º TDD ä»»åŠ¡ â†’ åˆ†é…è§’è‰²             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚              â”‚              â”‚
    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
    â”‚  Red ğŸ”´   â”‚â†’ â”‚ Green ğŸŸ¢  â”‚â†’ â”‚RefactorğŸ”§ â”‚
    â”‚  å†™æµ‹è¯•    â”‚  â”‚  å†™å®ç°    â”‚  â”‚  ä¼˜åŒ–ä»£ç   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚              â”‚              â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                   â†» å¾ªç¯è¿­ä»£
```

#### TDD ä»»åŠ¡æ–‡æ¡£æ¨¡æ¿

```markdown
# Task [ID]: [åŠŸèƒ½åç§°] - TDD å¾ªç¯

## Phase: RED ğŸ”´
### Role
TDD Red-Phase Specialist

### Objective
ä¸º [åŠŸèƒ½åç§°] ç¼–å†™å¤±è´¥çš„æµ‹è¯•ç”¨ä¾‹

### Requirements
1. ç¼–å†™æµ‹è¯•ç”¨ä¾‹æè¿°é¢„æœŸè¡Œä¸º
2. ç¡®ä¿æµ‹è¯•å¤±è´¥ï¼ˆåŠŸèƒ½æœªå®ç°ï¼‰
3. è¦†ç›–æ­£å¸¸æƒ…å†µå’Œè¾¹ç•Œæƒ…å†µ
4. æµ‹è¯•åº”è¯¥æ¸…æ™°ã€å¯è¯»

### Output Location
docs/outputs/tdd/[feature]-red-phase.md

---

## Phase: GREEN ğŸŸ¢
### Role
TDD Green-Phase Developer

### Objective
ç¼–å†™æœ€å°‘ä»£ç è®©æµ‹è¯•é€šè¿‡

### Input
- æµ‹è¯•æ–‡ä»¶ï¼štests/[feature].test.ts
- RED é˜¶æ®µè¾“å‡ºï¼šdocs/outputs/tdd/[feature]-red-phase.md

### Requirements
1. å®ç°åŠŸèƒ½è®©æ‰€æœ‰æµ‹è¯•é€šè¿‡
2. ä»£ç å°½å¯èƒ½ç®€å•
3. ä¸è¿½æ±‚å®Œç¾è®¾è®¡
4. ç¡®ä¿æµ‹è¯•è¦†ç›–ç‡

### Output Location
docs/outputs/tdd/[feature]-green-phase.md

---

## Phase: REFACTOR ğŸ”§
### Role
TDD Refactor Specialist

### Objective
ä¼˜åŒ–ä»£ç è´¨é‡ï¼Œä¿æŒæµ‹è¯•é€šè¿‡

### Input
- GREEN é˜¶æ®µè¾“å‡ºï¼šdocs/outputs/tdd/[feature]-green-phase.md
- æµ‹è¯•æ–‡ä»¶ï¼štests/[feature].test.ts

### Requirements
1. æ¶ˆé™¤é‡å¤ä»£ç 
2. æé«˜å¯è¯»æ€§
3. ä¼˜åŒ–æ€§èƒ½å’Œè®¾è®¡
4. ç¡®ä¿æ‰€æœ‰æµ‹è¯•ä¾ç„¶é€šè¿‡

### Output Location
docs/outputs/tdd/[feature]-refactor-phase.md
```

### TDD å¹¶å‘æ‰§è¡Œç­–ç•¥

å¯¹äºå¤šä¸ªç‹¬ç«‹åŠŸèƒ½ï¼Œå¯ä»¥å¹¶å‘æ‰§è¡Œå¤šä¸ª TDD å¾ªç¯ï¼š

```
åŠŸèƒ½ A: RED â†’ GREEN â†’ REFACTOR  â”€â”
åŠŸèƒ½ B: RED â†’ GREEN â†’ REFACTOR  â”€â”¤
åŠŸèƒ½ C: RED â†’ GREEN â†’ REFACTOR  â”€â”¼â†’ Controller æ•´åˆ
åŠŸèƒ½ D: RED â†’ GREEN â†’ REFACTOR  â”€â”˜

æ¯ä¸ªåŠŸèƒ½ç‹¬ç«‹çš„ TDD å¾ªç¯ï¼Œäº’ä¸å¹²æ‰°
```

### TDD æœ€ä½³å®è·µ

#### âœ… DOï¼ˆæ¨èåšæ³•ï¼‰

**RED é˜¶æ®µ**:
- ä¸€æ¬¡åªæµ‹è¯•ä¸€ä¸ªå°åŠŸèƒ½ç‚¹
- æµ‹è¯•åç§°æ¸…æ™°æè¿°è¡Œä¸º
- ç¡®ä¿æµ‹è¯•çœŸçš„å¤±è´¥ï¼ˆä¸æ˜¯å‡é˜³æ€§ï¼‰
- æµ‹è¯•è¦ç®€å•ã€å¿«é€Ÿã€ç‹¬ç«‹

**GREEN é˜¶æ®µ**:
- å†™æœ€ç®€å•èƒ½é€šè¿‡çš„ä»£ç 
- å…è®¸ç¡¬ç¼–ç å’Œ"ç¬¨"æ–¹æ³•
- ä¸è¦è·³è·ƒå¼å®ç°å¤šä¸ªåŠŸèƒ½
- å¿«é€Ÿè·å¾—ç»¿è‰²æµ‹è¯•

**REFACTOR é˜¶æ®µ**:
- é¢‘ç¹è¿è¡Œæµ‹è¯•ç¡®ä¿å®‰å…¨
- å°æ­¥é‡æ„ï¼Œæ¯æ¬¡ä¸€ä¸ªæ”¹è¿›
- æ¶ˆé™¤é‡å¤ï¼ˆDRY åŸåˆ™ï¼‰
- æå–æ–¹æ³•ã€ç±»ã€æ¨¡å—

#### âŒ DON'Tï¼ˆé¿å…åšæ³•ï¼‰

**RED é˜¶æ®µ**:
- ä¸€æ¬¡å†™å¤ªå¤šæµ‹è¯•
- æµ‹è¯•ä¹‹é—´ç›¸äº’ä¾èµ–
- æµ‹è¯•åç§°æ¨¡ç³Šä¸æ¸…
- å¿˜è®°è¿è¡Œæµ‹è¯•ç¡®è®¤å¤±è´¥

**GREEN é˜¶æ®µ**:
- è¿‡åº¦è®¾è®¡å’Œé¢„å…ˆä¼˜åŒ–
- å®ç°è¶…å‡ºæµ‹è¯•è¦æ±‚çš„åŠŸèƒ½
- è·³è¿‡æµ‹è¯•ç›´æ¥å†™å®ç°
- ä¿®æ”¹æµ‹è¯•è®©å…¶é€šè¿‡

**REFACTOR é˜¶æ®µ**:
- ä¿®æ”¹åŠŸèƒ½è¡Œä¸º
- åœ¨æ²¡æœ‰æµ‹è¯•ä¿æŠ¤ä¸‹é‡æ„
- å¤§è§„æ¨¡é‡æ„ä¸åˆ†æ­¥
- é‡æ„æ—¶æ·»åŠ æ–°åŠŸèƒ½

### TDD çš„ä¼˜åŠ¿

1. **éœ€æ±‚æ˜ç¡®**: æµ‹è¯•å³æ–‡æ¡£ï¼Œæ¸…æ™°æè¿°åŠŸèƒ½
2. **è®¾è®¡é©±åŠ¨**: å…ˆè€ƒè™‘æ¥å£ï¼Œä¿ƒè¿›è‰¯å¥½è®¾è®¡
3. **å¿«é€Ÿåé¦ˆ**: ç«‹å³çŸ¥é“ä»£ç æ˜¯å¦æ­£ç¡®
4. **å›å½’ä¿æŠ¤**: æµ‹è¯•é˜²æ­¢ç ´åç°æœ‰åŠŸèƒ½
5. **é‡æ„ä¿¡å¿ƒ**: æœ‰æµ‹è¯•ä¿æŠ¤ï¼Œæ•¢äºæ”¹è¿›ä»£ç 
6. **å‡å°‘è°ƒè¯•**: é—®é¢˜æ—©å‘ç°ï¼Œè°ƒè¯•æ—¶é—´å°‘
7. **æ–‡æ¡£åŒ–**: æµ‹è¯•æ˜¯æœ€å¥½çš„ä½¿ç”¨ç¤ºä¾‹

---

## Token æ§åˆ¶ç­–ç•¥

### äº”å±‚é˜²æŠ¤æœºåˆ¶

#### 1ï¸âƒ£ ä»»åŠ¡ç²’åº¦æ§åˆ¶
```yaml
è§„åˆ™:
  - æ¯ä¸ªä»»åŠ¡åªä¿®æ”¹ 1-2 ä¸ªæ–‡ä»¶
  - æ¯ä¸ªæ–‡ä»¶é™åˆ¶åœ¨ 200-300 è¡Œ
  - æ˜ç¡®è¾“å…¥å’Œè¾“å‡ºèŒƒå›´

Token ä¼°ç®—:
  ä»»åŠ¡æ–‡æ¡£: ~5k
  è¯»å–ä»£ç : ~6k (1-2ä¸ªæ–‡ä»¶)
  ç”Ÿæˆä»£ç : ~10k
  æµ‹è¯•è¯´æ˜: ~3k
  æ€»è®¡: ~25k tokens
```

#### 2ï¸âƒ£ è¾“å…¥æ–‡æ¡£åŒ–
```markdown
# ä»»åŠ¡æ–‡æ¡£æ¨¡æ¿

## Role
[Subagent è§’è‰²åç§°]

## Objective
[ç®€çŸ­çš„ä»»åŠ¡ç›®æ ‡ï¼Œ1-2 å¥è¯]

## Input Files
- path/to/file1.ts (line 100-150)
- path/to/file2.ts (specific function)

## Requirements
1. å…·ä½“è¦æ±‚ 1
2. å…·ä½“è¦æ±‚ 2
3. å…·ä½“è¦æ±‚ 3

## Output Location
docs/outputs/[phase]/output-[id]-[name].md

## Token Budget
é¢„è®¡ï¼š25k tokens
```

**ä¼˜åŠ¿**ï¼š
- Subagent è¯»å–æ–‡æ¡£ï¼ˆ~3k tokensï¼‰ï¼Œè€Œä¸æ˜¯åœ¨ prompt ä¸­åŒ…å«å¤§é‡ä»£ç 
- Controller åˆ›å»ºæ–‡æ¡£æ—¶å¯ä»¥ç²¾ç¡®æ§åˆ¶èŒƒå›´

#### 3ï¸âƒ£ è¾“å‡ºæ–‡æ¡£åŒ–
```markdown
# è¾“å‡ºæ–‡æ¡£æ¨¡æ¿

## Modified Files
- path/to/file1.ts
- path/to/file2.ts

## Implementation
[æ ¸å¿ƒä»£ç æ”¹åŠ¨æˆ–å®Œæ•´å®ç°]

## Testing Results
- âœ… å•å…ƒæµ‹è¯•é€šè¿‡
- âœ… é›†æˆæµ‹è¯•é€šè¿‡
- â±ï¸ æ€§èƒ½æŒ‡æ ‡

## Usage
[ä»£ç ä½¿ç”¨ç¤ºä¾‹]

## Next Steps
- å»ºè®® 1
- å»ºè®® 2
```

**ä¼˜åŠ¿**ï¼š
- åç»­ä»»åŠ¡åªéœ€è¯»å–è¾“å‡ºæ–‡æ¡£ï¼ˆ~5k tokensï¼‰
- é¿å…é‡æ–°æ‰§è¡Œæ‰€æœ‰å†å²æ“ä½œ
- æˆä¸ºå¯å¤ç”¨çš„çŸ¥è¯†åº“

#### 4ï¸âƒ£ å¢é‡å¼å¼€å‘
```
ä»»åŠ¡ 1a â†’ è¾“å‡º 1a (25k)
              â†“
ä»»åŠ¡ 1b (è¯»å–è¾“å‡º 1aï¼Œ5k) â†’ è¾“å‡º 1b (25k)
                                  â†“
ä»»åŠ¡ 1c (è¯»å–è¾“å‡º 1bï¼Œ5k) â†’ è¾“å‡º 1c (25k)
```

**å…³é”®**ï¼šæ¯ä¸ªæ–°ä»»åŠ¡åªè¯»å–å‰ä¸€ä¸ªçš„è¾“å‡ºæ–‡æ¡£ï¼Œä¸é‡æ–°ç”Ÿæˆ

#### 5ï¸âƒ£ å¹¶å‘æ‰§è¡Œéš”ç¦»
```
ä»»åŠ¡ 1a (ç”¨æˆ·è®¤è¯)   â†’ è¾“å‡º 1a  â”€â”
ä»»åŠ¡ 1b (æ•°æ®åº“è®¾è®¡)  â†’ è¾“å‡º 1b  â”€â”¤
ä»»åŠ¡ 1c (å‰ç«¯UI)     â†’ è¾“å‡º 1c  â”€â”¼â†’ Controller æ•´åˆ â†’ å†³ç­–
ä»»åŠ¡ 1d (APIå®‰å…¨)    â†’ è¾“å‡º 1d  â”€â”˜

æ¯ä¸ªä»»åŠ¡ç‹¬ç«‹ä¸Šä¸‹æ–‡ï¼š25k Ã— 4 = 100k tokens
```

---

## æ–‡æ¡£åŒ–å·¥ä½œæµ

### ä»»åŠ¡æ–‡æ¡£ï¼ˆTask Documentï¼‰

**ä½œç”¨**ï¼šç»™ Subagent çš„è¯¦ç»†æŒ‡ä»¤

**æ ‡å‡†æ ¼å¼**ï¼š
```markdown
# Task [ID]: [ä»»åŠ¡åç§°]

## Role
[Subagent è§’è‰²åç§°]

## Objective
[1-2 å¥è¯çš„ä»»åŠ¡ç›®æ ‡]

## Context
[å¿…è¦çš„èƒŒæ™¯ä¿¡æ¯]

## Input Files
- src/path/to/file1.ts (line 100-150)
- src/path/to/file2.ts (function: functionName)

## Requirements
1. åŠŸèƒ½è¦æ±‚ 1
2. åŠŸèƒ½è¦æ±‚ 2
3. éåŠŸèƒ½è¦æ±‚ï¼ˆæ€§èƒ½ã€å®‰å…¨ç­‰ï¼‰
4. **âš ï¸ å¿…é¡»æ·»åŠ ç»ˆç«¯è°ƒè¯•æ—¥å¿—**ï¼ˆå‡½æ•°å…¥å£ã€å‡ºå£ã€å…³é”®åˆ†æ”¯ã€é”™è¯¯å¤„ç†ï¼‰
5. **âš ï¸ å‰ç«¯ä»£ç æ—¥å¿—å¿…é¡»è¾“å‡ºåˆ°ç»ˆç«¯**ï¼ˆä¸ä»…æ˜¯æµè§ˆå™¨æ§åˆ¶å°ï¼‰

## Constraints
- ä¿æŒä¸ç°æœ‰æ¥å£å…¼å®¹
- éµå¾ªé¡¹ç›®ä»£ç è§„èŒƒ
- æ·»åŠ å¿…è¦çš„é”™è¯¯å¤„ç†
- æ‰€æœ‰æ—¥å¿—ä½¿ç”¨ç»Ÿä¸€æ ¼å¼ï¼š`[çº§åˆ«] [æ¨¡å—å] æ¶ˆæ¯å†…å®¹`

## Output Location
docs/outputs/[phase]/output-[id]-[name].md

## Token Budget
é¢„è®¡ï¼š25k tokens

## Success Criteria
- [ ] åŠŸèƒ½å®ç°å®Œæ•´
- [ ] æ‰€æœ‰å…³é”®èŠ‚ç‚¹æ·»åŠ äº†æ—¥å¿—è¾“å‡º
- [ ] è¿è¡Œé¡¹ç›®åç»ˆç«¯æ—¥å¿—æ— é”™è¯¯
- [ ] æµ‹è¯•é€šè¿‡ï¼ˆåŒ…æ‹¬ç»ˆç«¯æ—¥å¿—éªŒè¯ï¼‰
- [ ] æ–‡æ¡£å®Œå–„
```

### è¾“å‡ºæ–‡æ¡£ï¼ˆOutput Documentï¼‰

**ä½œç”¨**ï¼šSubagent å®Œæˆä»»åŠ¡åçš„äº¤ä»˜æˆæœ

**æ ‡å‡†æ ¼å¼**ï¼š
```markdown
# Output [ID]: [ä»»åŠ¡åç§°] - å®ç°æŠ¥å‘Š

## Status
âœ… å·²å®Œæˆ / âš ï¸ éƒ¨åˆ†å®Œæˆ / âŒ å¤±è´¥

## Modified Files
- src/path/to/file1.ts
- src/path/to/file2.ts

## Implementation

### æ ¸å¿ƒæ”¹åŠ¨
[å…³é”®ä»£ç ç‰‡æ®µæˆ–å®Œæ•´å®ç°]

### è®¾è®¡å†³ç­–
- å†³ç­– 1ï¼š[åŸå› ]
- å†³ç­– 2ï¼š[åŸå› ]

## Testing

### å•å…ƒæµ‹è¯•
```typescript
[æµ‹è¯•ä»£ç ]
```

### æµ‹è¯•ç»“æœ
- âœ… æµ‹è¯• A é€šè¿‡
- âœ… æµ‹è¯• B é€šè¿‡
- â±ï¸ æ€§èƒ½ï¼šå¹³å‡ 150ms

### ç»ˆç«¯æ—¥å¿—éªŒè¯
**é¡¹ç›®è¿è¡Œæµ‹è¯•**ï¼š
```bash
# è¿è¡Œå‘½ä»¤
npm run dev

# ç»ˆç«¯è¾“å‡ºï¼ˆå…³é”®æ—¥å¿—ï¼‰
[INFO] [ModuleName] Function started with params: {...}
[INFO] [ModuleName] Step 1 completed
[INFO] [ModuleName] Step 2 completed
[INFO] [ModuleName] SUCCESS - Result: {...}
```

**éªŒè¯ç»“æœ**ï¼š
- âœ… é¡¹ç›®æˆåŠŸå¯åŠ¨ï¼Œæ— å¯åŠ¨é”™è¯¯
- âœ… ç»ˆç«¯æ—¥å¿—æ—  ERROR è¾“å‡º
- âœ… æ‰€æœ‰å…³é”®æ“ä½œéƒ½æœ‰æ—¥å¿—è®°å½•
- âœ… é”™è¯¯å¤„ç†è·¯å¾„æ—¥å¿—å®Œæ•´
- âœ… å‰ç«¯æ—¥å¿—åœ¨ç»ˆç«¯å¯è§ï¼ˆéä»…æµè§ˆå™¨æ§åˆ¶å°ï¼‰
- âœ… è¿ç»­ 3 æ¬¡è¿è¡Œæ— é—®é¢˜

**æ—¥å¿—è¦†ç›–æƒ…å†µ**ï¼š
- [âœ…] å‡½æ•°å…¥å£æ—¥å¿—
- [âœ…] å…³é”®åˆ†æ”¯æ—¥å¿—
- [âœ…] å¤–éƒ¨è°ƒç”¨æ—¥å¿—ï¼ˆAPI/RPC/DBï¼‰
- [âœ…] é”™è¯¯å¤„ç†æ—¥å¿—ï¼ˆå«å †æ ˆï¼‰
- [âœ…] å‡½æ•°å‡ºå£æ—¥å¿—

## Usage

### åŸºæœ¬ç”¨æ³•
```typescript
[ä»£ç ç¤ºä¾‹]
```

### é«˜çº§ç”¨æ³•
[æ›´å¤æ‚çš„ç¤ºä¾‹]

## Dependencies
- æ–°å¢ä¾èµ–ï¼š[package@version]
- ä¾èµ–çš„å…¶ä»–æ¨¡å—ï¼š[module names]

## Next Steps
- å»ºè®® 1ï¼š[å…·ä½“æè¿°]
- å»ºè®® 2ï¼š[å…·ä½“æè¿°]

## Issues & Limitations
- å·²çŸ¥é—®é¢˜ 1
- é™åˆ¶ 1

## Token Usage
å®é™…ä½¿ç”¨ï¼š23k tokens (é¢„ç®—ï¼š25k)
```

### è¿›åº¦æ–‡æ¡£ï¼ˆProgress Documentï¼‰

**ä½œç”¨**ï¼šè·Ÿè¸ªæ•´ä¸ª Phase çš„è¿›åº¦

**æ ‡å‡†æ ¼å¼**ï¼š
```markdown
# Phase 1: Shadow Mode - è¿›åº¦è·Ÿè¸ª

## æ€»ä½“çŠ¶æ€
ğŸ”„ è¿›è¡Œä¸­ | å®Œæˆåº¦ï¼š60%

## ä»»åŠ¡ç»„ Aï¼ˆå¹¶å‘æ‰§è¡Œï¼‰

### Task 1a: ç”¨æˆ·è®¤è¯ API
- çŠ¶æ€ï¼šâœ… å·²å®Œæˆ
- Subagentï¼šBackend Architect
- å®Œæˆæ—¶é—´ï¼š2025-10-01
- è¾“å‡ºï¼šdocs/outputs/phase1/output-1a-auth-api-implementation.md

### Task 1b: æ•°æ®åº“ Schema è®¾è®¡
- çŠ¶æ€ï¼šâœ… å·²å®Œæˆ
- Subagentï¼šDatabase Architect
- å®Œæˆæ—¶é—´ï¼š2025-10-01
- è¾“å‡ºï¼šdocs/outputs/phase1/output-1b-database-schema.md

### Task 1c: å‰ç«¯ç™»å½•ç»„ä»¶
- çŠ¶æ€ï¼šğŸ”„ è¿›è¡Œä¸­
- Subagentï¼šFrontend Developer
- é¢„è®¡å®Œæˆï¼š2025-10-02

### Task 1d: API å®‰å…¨å®¡è®¡
- çŠ¶æ€ï¼šğŸ“… å¾…å¼€å§‹
- Subagentï¼šAPI Security Auditor

## å†³ç­–è®°å½•
- [2025-10-01] å†³å®šä½¿ç”¨ JWT è®¤è¯æ–¹æ¡ˆï¼ˆ24å°æ—¶è¿‡æœŸï¼‰
- [2025-10-01] å¯†ç å¼ºåº¦è¦æ±‚ï¼šè‡³å°‘8ä½ï¼ŒåŒ…å«å¤§å°å†™å­—æ¯å’Œæ•°å­—

## é£é™©å’Œé—®é¢˜
- âš ï¸ Session ç®¡ç†æ–¹æ¡ˆå¾…å®šï¼ˆRedis vs Databaseï¼‰
- âš ï¸ éœ€è¦è€ƒè™‘ CSRF ä¿æŠ¤æªæ–½

## ä¸‹ä¸€æ­¥è¡ŒåŠ¨
1. å®Œæˆä»»åŠ¡ç»„ A çš„å‰©ä½™ä»»åŠ¡
2. å¼€å§‹ä»»åŠ¡ç»„ Bï¼ˆç”¨æˆ·æƒé™ã€å¯†ç é‡ç½®ï¼‰
3. é›†æˆå‰åç«¯å¹¶è¿›è¡Œç«¯åˆ°ç«¯æµ‹è¯•
```

---

## å®Œæ•´å·¥ä½œæµç¨‹

### Phase 0: MCP ç¯å¢ƒå‡†å¤‡

#### Step 1: å®‰è£…å’Œé…ç½® Sequential Thinking MCP

**å¿«é€Ÿå®‰è£…ï¼ˆæ¨èï¼‰**ï¼š

ä½¿ç”¨ Claude CLI ä¸€é”®å®‰è£…ï¼š

```bash
claude mcp add-json "sequential-thinking" '{"command":"npx","args":["-y","@modelcontextprotocol/server-sequential-thinking"]}'
```

**æ‰‹åŠ¨å®‰è£…ï¼ˆå¤‡ç”¨æ–¹æ¡ˆï¼‰**ï¼š

```typescript
// 1. æ£€æŸ¥ MCP æ˜¯å¦å·²å®‰è£…
async function checkAndInstallMCP() {
  try {
    // è¯»å– MCP é…ç½®æ–‡ä»¶
    const mcpConfig = await readFile('C:/Users/YOUR_USERNAME/AppData/Roaming/Code/User/globalStorage/saoudrizwan.claude-dev/settings/cline_mcp_settings.json');
    const config = JSON.parse(mcpConfig);

    // æ£€æŸ¥ sequential-thinking æ˜¯å¦å·²é…ç½®
    if (!config.mcpServers || !config.mcpServers['sequential-thinking']) {
      console.log('[INFO] Sequential Thinking MCP æœªå®‰è£…ï¼Œå¼€å§‹å®‰è£…...');

      // æ›´æ–°é…ç½®æ–‡ä»¶
      config.mcpServers = config.mcpServers || {};
      config.mcpServers['sequential-thinking'] = {
        "command": "npx",
        "args": ["-y", "@modelcontextprotocol/server-sequential-thinking"]
      };

      await writeFile('cline_mcp_settings.json', JSON.stringify(config, null, 2));
      console.log('[SUCCESS] Sequential Thinking MCP å·²å®‰è£…å¹¶é…ç½®');
    } else {
      console.log('[INFO] Sequential Thinking MCP å·²å­˜åœ¨');
    }
  } catch (error) {
    console.error('[ERROR] MCP å®‰è£…å¤±è´¥:', error);
  }
}
```

**MCP é…ç½®æ–‡ä»¶ç¤ºä¾‹**ï¼š
```json
{
  "mcpServers": {
    "sequential-thinking": {
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-sequential-thinking"]
    }
  }
}
```

**éªŒè¯å®‰è£…**ï¼š

å®‰è£…å®Œæˆåï¼Œé‡å¯ Claude Code å¹¶éªŒè¯ MCP æ˜¯å¦å¯ç”¨ï¼š

```bash
# åœ¨ Claude Code ä¸­æ‰§è¡Œ
# æŸ¥çœ‹ MCP å·¥å…·åˆ—è¡¨ï¼Œåº”è¯¥èƒ½çœ‹åˆ° create_thinking_process ç­‰å·¥å…·
```

#### Step 2: ä½¿ç”¨ MCP è¿›è¡Œä»»åŠ¡è§„åˆ’

**å·¥ä½œæµç¨‹**ï¼š
```
å¤æ‚éœ€æ±‚
  â†“
è°ƒç”¨ Sequential Thinking MCP
  â†“
MCP åˆ†æå’Œæ‹†åˆ†ä»»åŠ¡
  â†“
è¯†åˆ«ä»»åŠ¡ä¾èµ–å…³ç³»
  â†“
ç”Ÿæˆä»»åŠ¡æ‰§è¡Œè®¡åˆ’
  â†“
Controller æ ¹æ®è®¡åˆ’å¹¶å‘å¯åŠ¨ Subagent
```

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
```typescript
// Controller ä½¿ç”¨ MCP åˆ†æä»»åŠ¡
// è¾“å…¥ï¼šå¤æ‚çš„å¼€å‘éœ€æ±‚
const requirement = "å®ç°å®Œæ•´çš„ç”µå•†ç³»ç»Ÿï¼ŒåŒ…æ‹¬ç”¨æˆ·ç®¡ç†ã€å•†å“ç®¡ç†ã€è®¢å•å¤„ç†å’Œæ”¯ä»˜é›†æˆ";

// MCP åˆ†æå¹¶æ‹†åˆ†ä»»åŠ¡
æ€è€ƒ 1ï¼šè¯†åˆ«ä¸»è¦æ¨¡å—
  - ç”¨æˆ·è®¤è¯å’Œæˆæƒæ¨¡å—
  - å•†å“ç›®å½•å’Œæœç´¢æ¨¡å—
  - è´­ç‰©è½¦å’Œè®¢å•æ¨¡å—
  - æ”¯ä»˜å’Œç»“ç®—æ¨¡å—
  - åå°ç®¡ç†æ¨¡å—

æ€è€ƒ 2ï¼šåˆ†ææ¨¡å—é—´ä¾èµ–
  - ç”¨æˆ·è®¤è¯ â†’ ç‹¬ç«‹ï¼Œå¯å¹¶å‘ï¼ˆæ‰€æœ‰æ¨¡å—çš„å‰ç½®ä¾èµ–ï¼‰
  - å•†å“ç›®å½• â†’ ä¾èµ–ç”¨æˆ·è®¤è¯
  - è´­ç‰©è½¦ â†’ ä¾èµ–ç”¨æˆ·è®¤è¯å’Œå•†å“ç›®å½•
  - è®¢å•å¤„ç† â†’ ä¾èµ–è´­ç‰©è½¦
  - æ”¯ä»˜é›†æˆ â†’ ä¾èµ–è®¢å•å¤„ç†

æ€è€ƒ 3ï¼šåˆ’åˆ†ä»»åŠ¡æ‰¹æ¬¡
  æ‰¹æ¬¡ 1ï¼ˆå¹¶å‘ï¼‰ï¼šç”¨æˆ·è®¤è¯ + æ•°æ®åº“è®¾è®¡ + å‰ç«¯åŸºç¡€æ¡†æ¶
  æ‰¹æ¬¡ 2ï¼ˆå¹¶å‘ï¼‰ï¼šå•†å“ç›®å½• API + å•†å“å‰ç«¯é¡µé¢
  æ‰¹æ¬¡ 3ï¼ˆå¹¶å‘ï¼‰ï¼šè´­ç‰©è½¦åŠŸèƒ½ + è®¢å•ç³»ç»Ÿ
  æ‰¹æ¬¡ 4ï¼ˆä¸²è¡Œï¼‰ï¼šæ”¯ä»˜é›†æˆ + å®‰å…¨å®¡è®¡

æ€è€ƒ 4ï¼šç”Ÿæˆä»»åŠ¡æ–‡æ¡£
  - Task 1a: ç”¨æˆ·è®¤è¯ API å¼€å‘
  - Task 1b: æ•°æ®åº“ Schema è®¾è®¡
  - Task 1c: React å‰ç«¯æ¡†æ¶æ­å»º
  - Task 2a: å•†å“ç®¡ç† API
  - Task 2b: å•†å“å±•ç¤ºé¡µé¢
  - Task 3a: è´­ç‰©è½¦åŠŸèƒ½å®ç°
  - Task 3b: è®¢å•å¤„ç†æµç¨‹
  - Task 4a: Stripe æ”¯ä»˜é›†æˆ
  - Task 4b: API å®‰å…¨å®¡è®¡

// è¾“å‡ºï¼šç»“æ„åŒ–çš„ä»»åŠ¡è®¡åˆ’
```

#### Step 3: éªŒè¯ MCP åŠŸèƒ½

**éªŒè¯æ¸…å•**ï¼š
- [ ] MCP é…ç½®æ–‡ä»¶å·²æ­£ç¡®åˆ›å»º
- [ ] Sequential Thinking MCP å¯ä»¥æ­£å¸¸è°ƒç”¨
- [ ] MCP èƒ½å¤Ÿåˆ†æå¤æ‚ä»»åŠ¡
- [ ] MCP èƒ½å¤Ÿè¯†åˆ«ä»»åŠ¡ä¾èµ–å…³ç³»
- [ ] MCP èƒ½å¤Ÿç”Ÿæˆå¹¶å‘ä»»åŠ¡è®¡åˆ’

### Phase 1: å‡†å¤‡é˜¶æ®µ

#### Step 1: åˆ›å»º Subagent è§’è‰²å®šä¹‰
```bash
docs/agents/
â”œâ”€â”€ frontend-developer.md
â”œâ”€â”€ backend-architect.md
â”œâ”€â”€ database-architect.md
â”œâ”€â”€ api-security-auditor.md
â”œâ”€â”€ devops-engineer.md
â”œâ”€â”€ tdd-red-phase-specialist.md
â”œâ”€â”€ tdd-green-phase-developer.md
â””â”€â”€ tdd-refactor-specialist.md
```

#### Step 2: ä»»åŠ¡åˆ†è§£
Controllerï¼ˆæˆ‘ï¼‰ä½¿ç”¨ Sequential Thinking åˆ†æé¡¹ç›®ï¼Œåˆ†è§£ä¸ºå°ä»»åŠ¡ï¼š
```
Phase 1: ç”¨æˆ·ç®¡ç†æ¨¡å—
  â”œâ”€â”€ ä»»åŠ¡ç»„ Aï¼ˆå¹¶å‘ï¼‰
  â”‚   â”œâ”€â”€ Task 1a: ç”¨æˆ·è®¤è¯ API
  â”‚   â”œâ”€â”€ Task 1b: æ•°æ®åº“ Schema è®¾è®¡
  â”‚   â”œâ”€â”€ Task 1c: å‰ç«¯ç™»å½•ç»„ä»¶
  â”‚   â””â”€â”€ Task 1d: API å®‰å…¨å®¡è®¡
  â””â”€â”€ ä»»åŠ¡ç»„ Bï¼ˆä¾èµ– Aï¼‰
      â”œâ”€â”€ Task 2a: æƒé™ç®¡ç†ç³»ç»Ÿ
      â”œâ”€â”€ Task 2b: ç”¨æˆ·èµ„æ–™é¡µé¢
      â””â”€â”€ Task 2c: å¯†ç é‡ç½®åŠŸèƒ½
```

### Phase 2: æ‰§è¡Œé˜¶æ®µ

#### Step 1: åˆ›å»ºä»»åŠ¡æ–‡æ¡£
Controller ä½¿ç”¨ Write tool åˆ›å»ºï¼š
```
docs/tasks/phase1/task-1a-user-auth-api.md
docs/tasks/phase1/task-1b-database-schema-design.md
docs/tasks/phase1/task-1c-frontend-login-ui.md
docs/tasks/phase1/task-1d-api-security-audit.md
```

#### Step 2: å¹¶å‘å¯åŠ¨ Subagent

**âš ï¸ å…³é”®åŸåˆ™ï¼šå¿…é¡»å¹¶è¡Œå¤šå¼€ Subagent è¿›è¡Œå¹¶å‘å¼€å‘**

Controller åœ¨**å•ä¸ªæ¶ˆæ¯**ä¸­ä½¿ç”¨ Task tool å¯åŠ¨ 4 ä¸ª Subagentï¼š

**å¹¶è¡Œå¼€å‘è§„åˆ™**ï¼š
1. **å¼ºåˆ¶å¹¶å‘**ï¼šæ‰€æœ‰ç‹¬ç«‹ä»»åŠ¡å¿…é¡»åœ¨åŒä¸€ä¸ªæ¶ˆæ¯ä¸­å¯åŠ¨ï¼Œä¸å…è®¸ä¸²è¡Œæ‰§è¡Œ
2. **æ— æ•°é‡é™åˆ¶**ï¼šå¹¶å‘ Subagent æ•°é‡æ— ä¸Šé™ï¼Œæ ¹æ®å®é™…ä»»åŠ¡æ•°é‡å†³å®š
3. **ä¾èµ–æ£€æŸ¥**ï¼šåªæœ‰å­˜åœ¨ä¾èµ–å…³ç³»çš„ä»»åŠ¡æ‰èƒ½ä¸²è¡Œï¼Œå…¶ä»–å¿…é¡»å¹¶å‘
4. **æ•ˆç‡ä¼˜å…ˆ**ï¼šå¹¶å‘å¼€å‘æ•ˆç‡ä¸å¹¶å‘æ•°é‡æˆæ­£æ¯”ï¼ˆN ä¸ªä»»åŠ¡ = N å€æå‡ï¼‰

**å¹¶å‘å¯åŠ¨ç¤ºä¾‹**ï¼š
```typescript
// âœ… æ­£ç¡®åšæ³•ï¼šåœ¨å•ä¸ªæ¶ˆæ¯ä¸­å¯åŠ¨æ‰€æœ‰ç‹¬ç«‹ä»»åŠ¡ï¼ˆæ— æ•°é‡é™åˆ¶ï¼‰
Controller å‘é€å•ä¸ªæ¶ˆæ¯ï¼ŒåŒ…å« N ä¸ªå¹¶å‘ Task tool è°ƒç”¨ï¼š

// å°è§„æ¨¡å¹¶å‘ï¼ˆ4 ä¸ªä»»åŠ¡ï¼‰
Task 1-4: Mainnet Expert, Monitoring Engineer, Testing Architect...
  - æ¯ä¸ªä»»åŠ¡ç‹¬ç«‹æ‰§è¡Œ
  - åŒæ—¶å¯åŠ¨ï¼ŒåŒæ—¶å®Œæˆ

// ä¸­è§„æ¨¡å¹¶å‘ï¼ˆ8 ä¸ªä»»åŠ¡ï¼‰
Task 1-8: æ•°æ®é›†æˆ Ã— 3, é£é™©ç®¡ç† Ã— 2, ç›‘æ§ Ã— 2, éƒ¨ç½² Ã— 1
  - æ‰€æœ‰ç‹¬ç«‹ä»»åŠ¡ä¸€æ¬¡æ€§å¯åŠ¨
  - æ•ˆç‡æå‡ 8 å€

// å¤§è§„æ¨¡å¹¶å‘ï¼ˆ16+ ä¸ªä»»åŠ¡ï¼‰
Task 1-16+: å¤šæ¨¡å—ã€å¤šåŠŸèƒ½å¹¶è¡Œå¼€å‘
  - å‰ç«¯ç»„ä»¶ Ã— 4
  - åç«¯ API Ã— 4
  - æ•°æ®é›†æˆ Ã— 4
  - æµ‹è¯•ç”¨ä¾‹ Ã— 4
  - æ•ˆç‡æå‡ 16+ å€

// âŒ é”™è¯¯åšæ³•ï¼šä¸²è¡Œå¯åŠ¨ç‹¬ç«‹ä»»åŠ¡
// ä¸è¦è¿™æ ·åšï¼šå¯åŠ¨ Task 1 â†’ ç­‰å¾…å®Œæˆ â†’ å¯åŠ¨ Task 2 â†’ ç­‰å¾…å®Œæˆ...
```

**Token ä½¿ç”¨**ï¼šN Ã— 25k tokens
- 4 ä¸ªä»»åŠ¡ï¼š100k tokens
- 8 ä¸ªä»»åŠ¡ï¼š200k tokens
- 16 ä¸ªä»»åŠ¡ï¼š400k tokens
- åªè¦åœ¨ 1M tokens é¢„ç®—å†…ï¼Œå¯ä»¥å¹¶å‘ä»»æ„æ•°é‡çš„ä»»åŠ¡

**å¹¶å‘æ•ˆç‡å¯¹æ¯”**ï¼š
- ä¸²è¡Œæ‰§è¡Œï¼šN ä¸ªä»»åŠ¡ Ã— æ¯ä¸ª 30 åˆ†é’Ÿ = 30N åˆ†é’Ÿ
- å¹¶å‘æ‰§è¡Œï¼šN ä¸ªä»»åŠ¡åŒæ—¶è¿›è¡Œ = 30 åˆ†é’Ÿ
- **æ•ˆç‡æå‡**ï¼šN å€ï¼ˆæ— ä¸Šé™ï¼‰

**å®é™…æ¡ˆä¾‹**ï¼š
- 4 ä¸ªä»»åŠ¡å¹¶å‘ï¼š120 åˆ†é’Ÿ â†’ 30 åˆ†é’Ÿï¼ˆ4 å€æå‡ï¼‰
- 8 ä¸ªä»»åŠ¡å¹¶å‘ï¼š240 åˆ†é’Ÿ â†’ 30 åˆ†é’Ÿï¼ˆ8 å€æå‡ï¼‰
- 16 ä¸ªä»»åŠ¡å¹¶å‘ï¼š480 åˆ†é’Ÿ â†’ 30 åˆ†é’Ÿï¼ˆ16 å€æå‡ï¼‰

**å¹¶å‘å¼€å‘å†³ç­–æµç¨‹**ï¼š
```
ä½¿ç”¨ Sequential Thinking MCP åˆ†æä»»åŠ¡ä¾èµ–ï¼š
  â†“
è¯†åˆ«å¯å¹¶å‘ä»»åŠ¡ç»„ï¼ˆæ— ä¾èµ–å…³ç³»ï¼‰
  â†“
åœ¨å•ä¸ªæ¶ˆæ¯ä¸­å¯åŠ¨æ‰€æœ‰å¹¶å‘ä»»åŠ¡
  â†“
ç­‰å¾…æ‰€æœ‰ä»»åŠ¡å®Œæˆ
  â†“
æ”¶é›†å’Œæ•´åˆç»“æœ
  â†“
è¯†åˆ«ä¸‹ä¸€æ‰¹å¯å¹¶å‘ä»»åŠ¡
  â†“
é‡å¤å¾ªç¯
```

### Phase 3: æ•´åˆé˜¶æ®µ

#### Step 1: æ”¶é›†è¾“å‡ºæ–‡æ¡£

âš ï¸ **Controllerï¼ˆä¸»çª—å£ï¼‰åªè¯»å–è¾“å‡ºæ–‡æ¡£ï¼Œä¸æŸ¥çœ‹æºä»£ç **

Controller ä½¿ç”¨ Read tool è¯»å–æ‰€æœ‰ Subagent çš„è¾“å‡ºæ–‡æ¡£ï¼š
```bash
# è¯»å–è¾“å‡ºæ–‡æ¡£ï¼ˆè€Œéæºä»£ç ï¼‰
Read docs/outputs/phase1/output-1a-auth-api-implementation.md
Read docs/outputs/phase1/output-1b-database-schema.md
Read docs/outputs/phase1/output-1c-frontend-login-ui.md
Read docs/outputs/phase1/output-1d-api-security-audit.md
```

**ä¸ºä»€ä¹ˆåªè¯»è¾“å‡ºæ–‡æ¡£ï¼Ÿ**
- âœ… è¾“å‡ºæ–‡æ¡£å·²åŒ…å«å®ç°æ‘˜è¦å’Œå…³é”®ä¿¡æ¯ï¼ˆ~5k tokensï¼‰
- âœ… é¿å…è¯»å–å¤§é‡æºä»£ç ï¼ˆå¯èƒ½ 20k-50k tokensï¼‰
- âœ… ä¿æŒä¸»çª—å£ token æ¶ˆè€—åœ¨ä½ä½
- âœ… å¿«é€Ÿäº†è§£ä»»åŠ¡å®Œæˆæƒ…å†µå’Œä¸‹ä¸€æ­¥è¡ŒåŠ¨

#### Step 2: æ›´æ–°è¿›åº¦æ–‡æ¡£

âš ï¸ **æ¯æ¬¡ Subagent å®Œæˆä»»åŠ¡åå¿…é¡»ç«‹å³æ›´æ–°è¿›åº¦**

Controller æ›´æ–° `docs/progress/phase1-progress.md`ï¼š

```markdown
# Phase 1: ç”¨æˆ·ç®¡ç†æ¨¡å— - è¿›åº¦è·Ÿè¸ª

## æ€»ä½“çŠ¶æ€
ğŸ”„ è¿›è¡Œä¸­ | å®Œæˆåº¦ï¼š75% (3/4 ä»»åŠ¡å®Œæˆ)
**æœ€åæ›´æ–°**: 2025-10-07 14:30

## ä»»åŠ¡ç»„ Aï¼ˆå¹¶å‘æ‰§è¡Œï¼‰

### âœ… Task 1a: ç”¨æˆ·è®¤è¯ API
- çŠ¶æ€ï¼šâœ… å·²å®Œæˆ
- Subagentï¼šBackend Architect
- å®Œæˆæ—¶é—´ï¼š2025-10-07 10:00
- è¾“å‡ºæ–‡æ¡£ï¼šdocs/outputs/phase1/output-1a-auth-api-implementation.md
- å…³é”®æˆæœï¼š
  - POST /api/auth/register æ³¨å†Œæ¥å£
  - POST /api/auth/login ç™»å½•æ¥å£
  - JWT token ç”Ÿæˆï¼ˆ24h æœ‰æ•ˆæœŸï¼‰
  - bcrypt å¯†ç åŠ å¯†
- Token ä½¿ç”¨ï¼š23k

### âœ… Task 1b: æ•°æ®åº“ Schema è®¾è®¡
- çŠ¶æ€ï¼šâœ… å·²å®Œæˆ
- Subagentï¼šDatabase Architect
- å®Œæˆæ—¶é—´ï¼š2025-10-07 10:00
- è¾“å‡ºæ–‡æ¡£ï¼šdocs/outputs/phase1/output-1b-database-schema.md
- å…³é”®æˆæœï¼š
  - User è¡¨è®¾è®¡ï¼ˆid, email, passwordHash, createdAtï¼‰
  - ç´¢å¼•ç­–ç•¥ï¼ˆemail unique indexï¼‰
  - Prisma migration æ–‡ä»¶
- Token ä½¿ç”¨ï¼š20k

### âœ… Task 1c: å‰ç«¯ç™»å½•ç»„ä»¶
- çŠ¶æ€ï¼šâœ… å·²å®Œæˆ
- Subagentï¼šFrontend Developer
- å®Œæˆæ—¶é—´ï¼š2025-10-07 14:00
- è¾“å‡ºæ–‡æ¡£ï¼šdocs/outputs/phase1/output-1c-frontend-login-ui.md
- å…³é”®æˆæœï¼š
  - LoginForm ç»„ä»¶
  - è¡¨å•éªŒè¯ï¼ˆemail æ ¼å¼ã€å¯†ç é•¿åº¦ï¼‰
  - API è°ƒç”¨é›†æˆ
  - é”™è¯¯æç¤º UI
- Token ä½¿ç”¨ï¼š25k

### ğŸ“… Task 1d: API å®‰å…¨å®¡è®¡
- çŠ¶æ€ï¼šğŸ“… å¾…å¼€å§‹
- Subagentï¼šAPI Security Auditor
- è®¡åˆ’å¼€å§‹ï¼š2025-10-07 15:00

## å†³ç­–è®°å½•
- [2025-10-07 10:00] é‡‡ç”¨ Prisma ORM ç®¡ç†æ•°æ®åº“
- [2025-10-07 10:00] JWT secret å­˜å‚¨åœ¨ç¯å¢ƒå˜é‡
- [2025-10-07 14:00] å‰ç«¯ä½¿ç”¨ React Hook Form è¡¨å•ç®¡ç†

## é£é™©å’Œé—®é¢˜
- âš ï¸ Session ç®¡ç†æ–¹æ¡ˆå¾…å®šï¼ˆå»ºè®®ä½¿ç”¨ Redisï¼‰
- âš ï¸ CSRF ä¿æŠ¤æœªå®ç°ï¼ˆTask 1d å°†å¤„ç†ï¼‰

## ä¸‹ä¸€æ­¥è¡ŒåŠ¨
1. â³ å¯åŠ¨ Task 1d: API å®‰å…¨å®¡è®¡
2. ğŸ“ è§„åˆ’ Phase 2: ç”¨æˆ·æƒé™ç³»ç»Ÿ
3. ğŸ”— è¿›è¡Œå‰åç«¯é›†æˆæµ‹è¯•
```

**è¿›åº¦æ›´æ–°æœ€ä½³å®è·µ**ï¼š
- âœ… æ¯æ¬¡ Subagent å®Œæˆç«‹å³æ›´æ–°ï¼ˆè€Œéæ‰¹é‡æ›´æ–°ï¼‰
- âœ… è®°å½•å®Œæˆæ—¶é—´å’Œ Token ä½¿ç”¨æƒ…å†µ
- âœ… æ‘˜è¦å…³é”®æˆæœå’Œè¾“å‡ºæ–‡æ¡£è·¯å¾„
- âœ… æ›´æ–°æ€»ä½“å®Œæˆåº¦ç™¾åˆ†æ¯”
- âœ… è®°å½•å†³ç­–å’Œé‡åˆ°çš„é—®é¢˜
- âœ… æ˜ç¡®ä¸‹ä¸€æ­¥è¡ŒåŠ¨è®¡åˆ’

#### Step 3: Sequential Thinking åˆ†æä¸‹ä¸€æ­¥

âš ï¸ **ä½¿ç”¨ Sequential Thinking MCP åˆ†æå’Œè§„åˆ’ï¼Œè€Œéå‡­ç›´è§‰å†³ç­–**

Controller ä½¿ç”¨ Sequential Thinking MCP å·¥å…·åˆ†æå½“å‰çŠ¶æ€ï¼š

```typescript
// è°ƒç”¨ Sequential Thinking MCP
æ€è€ƒ 1ï¼šæ£€æŸ¥æ‰€æœ‰ä»»åŠ¡æ˜¯å¦æˆåŠŸå®Œæˆ
  - Task 1a, 1b, 1c: âœ… å®Œæˆ
  - Task 1d: ğŸ“… å¾…å¼€å§‹
  - è¯„ä¼°ï¼šPhase 1 æ¥è¿‘å®Œæˆ

æ€è€ƒ 2ï¼šè¯„ä¼°ä»£ç è´¨é‡å’Œé›†æˆå¯è¡Œæ€§
  - è¾“å‡ºæ–‡æ¡£æ˜¾ç¤ºæ‰€æœ‰æ¥å£ç¬¦åˆ RESTful è§„èŒƒ
  - å‰åç«¯ API contract ä¸€è‡´
  - æ•°æ®åº“ schema æ»¡è¶³è®¤è¯éœ€æ±‚
  - è¯„ä¼°ï¼šè´¨é‡è‰¯å¥½ï¼Œå¯ä»¥é›†æˆæµ‹è¯•

æ€è€ƒ 3ï¼šè¯†åˆ«æ½œåœ¨é—®é¢˜å’Œé£é™©
  - Session ç®¡ç†æ–¹æ¡ˆæœªå®š â†’ éœ€è¦åœ¨ Phase 2 å¤„ç†
  - CSRF ä¿æŠ¤æœªå®ç° â†’ Task 1d å°†å®¡è®¡å¹¶æ·»åŠ 
  - å•å…ƒæµ‹è¯•è¦†ç›–ç‡æœªçŸ¥ â†’ éœ€è¦ç¡®è®¤æµ‹è¯•æƒ…å†µ

æ€è€ƒ 4ï¼šè§„åˆ’ä¸‹ä¸€æ‰¹ä»»åŠ¡
  æ‰¹æ¬¡é€‰é¡¹ï¼š
  A. å®Œæˆ Task 1d åç«‹å³è¿›å…¥ Phase 2
  B. å…ˆè¿›è¡Œé›†æˆæµ‹è¯•ï¼Œç¡®ä¿ Phase 1 å®Œå…¨ç¨³å®š

  å†³ç­–ï¼šé€‰æ‹© Bï¼ˆå…ˆç¨³å›ºå†æ‹“å±•ï¼‰

æ€è€ƒ 5ï¼šä¸‹ä¸€æ‰¹ä»»åŠ¡æ‹†åˆ†
  å¹¶å‘ä»»åŠ¡ç»„ï¼š
  - Task 1d: API å®‰å…¨å®¡è®¡ï¼ˆç‹¬ç«‹ï¼‰
  - Task 1e: é›†æˆæµ‹è¯•ç¼–å†™ï¼ˆå¯å¹¶å‘ï¼‰
  - Task 1f: E2E æµ‹è¯•åœºæ™¯ï¼ˆå¯å¹¶å‘ï¼‰
```

**MCP åˆ†æè¾“å‡º**ï¼š
- ä¸‹ä¸€æ­¥è¡ŒåŠ¨ï¼šå¹¶å‘å¯åŠ¨ Task 1d, 1e, 1f
- é¢„è®¡å®Œæˆæ—¶é—´ï¼š30 åˆ†é’Ÿï¼ˆå¹¶å‘æ‰§è¡Œï¼‰
- é£é™©è¯„ä¼°ï¼šä½é£é™©ï¼Œå¯ä»¥å®‰å…¨æ¨è¿›

**MCP å®‰è£…æ£€æŸ¥å’Œä½¿ç”¨**ï¼š
```typescript
// 1. æ£€æŸ¥ sequentialthinking MCP æ˜¯å¦å·²å®‰è£…
// å¦‚æœæ²¡æœ‰å®‰è£…ï¼Œæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š

// å®‰è£… sequentialthinking MCP
npx @modelcontextprotocol/create-server sequentialthinking

// 2. é…ç½® MCP æœåŠ¡å™¨ï¼ˆåœ¨ cline_mcp_settings.json ä¸­ï¼‰
{
  "mcpServers": {
    "sequentialthinking": {
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/sequentialthinking"]
    }
  }
}

// 3. ä½¿ç”¨ MCP è¿›è¡Œä»»åŠ¡è§„åˆ’
// Controller è°ƒç”¨ sequentialthinking MCP æ¥åˆ†æå’Œæ‹†åˆ†å¤æ‚ä»»åŠ¡
```

#### Step 3: æ›´æ–°è¿›åº¦æ–‡æ¡£
Controller æ›´æ–° `docs/progress/phase1-progress.md`

#### Step 4: å†³ç­–ä¸‹ä¸€æ‰¹ä»»åŠ¡
- å¦‚æœä»»åŠ¡ç»„ A å…¨éƒ¨æˆåŠŸ â†’ å¯åŠ¨ä»»åŠ¡ç»„ B
- å¦‚æœæœ‰å¤±è´¥ä»»åŠ¡ â†’ åˆ†æåŸå› ï¼Œé‡æ–°åˆ†é…
- å¦‚æœéœ€è¦è°ƒæ•´ â†’ åˆ›å»ºè¡¥å……ä»»åŠ¡

### Phase 4: è¿­ä»£

é‡å¤ Phase 2-3ï¼Œç›´åˆ°æ•´ä¸ªé¡¹ç›®å®Œæˆã€‚

---

## ä¼˜ç‚¹æ€»ç»“

### âœ… 1. Token ä½¿ç”¨é«˜æ•ˆ
- **ç²¾ç¡®æ§åˆ¶**ï¼šæ¯ä¸ªä»»åŠ¡ <30k tokensï¼Œè¿œä½äº 50% é™åˆ¶
- **æ— ç´¯ç§¯**ï¼šå¢é‡å¼å¼€å‘é¿å…ä¸Šä¸‹æ–‡è†¨èƒ€
- **æœ€ä½³æ€§èƒ½**ï¼šåœ¨ Claude çš„æœ‰æ•ˆä¸Šä¸‹æ–‡èŒƒå›´å†…ï¼ˆ60k-120kï¼‰

### âœ… 2. å¹¶å‘æ‰§è¡Œé«˜æ•ˆ
- **çœŸæ­£å¹¶å‘**ï¼šæ— é™åˆ¶çš„ Subagent åŒæ—¶å·¥ä½œ
- **äº’ä¸å¹²æ‰°**ï¼šæ¯ä¸ª Subagent æœ‰ç‹¬ç«‹ä¸Šä¸‹æ–‡çª—å£
- **æ—¶é—´èŠ‚çœ**ï¼šç›¸æ¯”ä¸²è¡Œå¼€å‘ï¼Œæ•ˆç‡æå‡ = å¹¶å‘ä»»åŠ¡æ•°ï¼ˆæ— ä¸Šé™ï¼‰
- **å¤§è§„æ¨¡å¹¶è¡Œ**ï¼šæ”¯æŒ 10+ã€20+ã€ç”šè‡³ 50+ ä»»åŠ¡åŒæ—¶æ‰§è¡Œ

### âœ… 3. çŸ¥è¯†å¯å¤ç”¨
- **è¾“å‡ºæ–‡æ¡£**ï¼šæˆä¸ºé¡¹ç›®çŸ¥è¯†åº“
- **ä»»åŠ¡æ¨¡æ¿**ï¼šç›¸ä¼¼ä»»åŠ¡å¯å¤ç”¨
- **æœ€ä½³å®è·µ**ï¼šæˆåŠŸç»éªŒæ–‡æ¡£åŒ–

### âœ… 4. è´¨é‡å¯æ§
- **ä¸“ä¸šåˆ†å·¥**ï¼šæ¯ä¸ª Subagent ä¸“æ³¨å…¶æ“…é•¿é¢†åŸŸ
- **èŒè´£å•ä¸€**ï¼šé™ä½é”™è¯¯ç‡
- **å¯è¿½æº¯**ï¼šå®Œæ•´çš„ä»»åŠ¡ â†’ è¾“å‡ºé“¾

### âœ… 5. æ˜“äºåä½œ
- **æ–‡æ¡£åŒ–**ï¼šå›¢é˜Ÿæˆå‘˜å¯æŸ¥é˜…æ‰€æœ‰ä»»åŠ¡å’Œè¾“å‡º
- **æ ‡å‡†åŒ–**ï¼šç»Ÿä¸€çš„æ–‡æ¡£æ ¼å¼
- **é€æ˜åº¦**ï¼šè¿›åº¦å’Œå†³ç­–å¯è§

### âœ… 6. å®¹é”™æ€§å¼º
- **éš”ç¦»å¤±è´¥**ï¼šå•ä¸ªä»»åŠ¡å¤±è´¥ä¸å½±å“å…¶ä»–
- **æ˜“äºé‡è¯•**ï¼šä»»åŠ¡æ–‡æ¡£å¯é‡æ–°æ‰§è¡Œ
- **æ¸è¿›å¼**ï¼šåˆ†é˜¶æ®µéªŒè¯

### âœ… 7. å¯æ‰©å±•æ€§
- **æ¨¡å—åŒ–**ï¼šæ–°ä»»åŠ¡éµå¾ªç›¸åŒæ¨¡å¼
- **è§’è‰²æ‰©å±•**ï¼šå¯æ·»åŠ æ–°çš„ Subagent è§’è‰²
- **é¡¹ç›®è¿ç§»**ï¼šæ–¹æ³•è®ºå¯åº”ç”¨äºå…¶ä»–é¡¹ç›®

### âœ… 8. æˆæœ¬ä¼˜åŒ–
- **ç¼“å­˜åˆ©ç”¨**ï¼šè¾“å‡ºæ–‡æ¡£å¯è¢«å¤šæ¬¡è¯»å–ï¼ˆç¼“å­˜ token ä»·æ ¼ä½ 10 å€ï¼‰
- **å‡å°‘é‡å¤**ï¼šé¿å…é‡æ–°ç”Ÿæˆå·²æœ‰å†…å®¹
- **ç²¾å‡†èŒƒå›´**ï¼šåªå¤„ç†å¿…è¦çš„ä»£ç 

---

## æœ€ä½³å®è·µ

### 0. æ ¸å¿ƒå·¥ä½œæµå¼ºåˆ¶è§„èŒƒ âš ï¸

#### ğŸš« ä¸»çª—å£ï¼ˆControllerï¼‰ç¦æ­¢äº‹é¡¹

**æ°¸è¿œä¸è¦åœ¨ä¸»çª—å£åšä»¥ä¸‹æ“ä½œ**ï¼š

1. âŒ **ä¸è¦ç›´æ¥å†™ä»£ç **
   ```typescript
   // âŒ é”™è¯¯ï¼šController ç›´æ¥ä½¿ç”¨ Write/Edit tool ä¿®æ”¹ä»£ç 
   Edit src/services/auth.ts

   // âœ… æ­£ç¡®ï¼šåˆ›å»ºä»»åŠ¡æ–‡æ¡£ï¼Œå¯åŠ¨ Subagent
   Write docs/tasks/task-1a-auth-service.md
   Task "å®ç°ç”¨æˆ·è®¤è¯æœåŠ¡" â†’ Backend Architect
   ```

2. âŒ **ä¸è¦ç›´æ¥è¯»å–æºä»£ç æ–‡ä»¶**
   ```typescript
   // âŒ é”™è¯¯ï¼šè¯»å–å¤§é‡æºä»£ç ï¼ˆæ¶ˆè€— 20k-50k tokensï¼‰
   Read src/services/auth.ts
   Read src/services/user.ts
   Read src/api/routes.ts

   // âœ… æ­£ç¡®ï¼šåªè¯»å–è¾“å‡ºæ–‡æ¡£ï¼ˆæ¯ä¸ª ~5k tokensï¼‰
   Read docs/outputs/output-1a-auth-implementation.md
   ```

3. âŒ **ä¸è¦è·³è¿‡ Sequential Thinking MCP**
   ```typescript
   // âŒ é”™è¯¯ï¼šå‡­ç›´è§‰æ‹†åˆ†ä»»åŠ¡
   "æˆ‘è§‰å¾—åº”è¯¥åš Aã€Bã€C ä¸‰ä¸ªä»»åŠ¡"

   // âœ… æ­£ç¡®ï¼šä½¿ç”¨ MCP ç³»ç»Ÿæ€§åˆ†æ
   Sequential Thinking MCP â†’ åˆ†æä¾èµ– â†’ è¯†åˆ«å¹¶å‘æœºä¼š â†’ ç”Ÿæˆä»»åŠ¡è®¡åˆ’
   ```

4. âŒ **ä¸è¦å¿˜è®°æ›´æ–°è¿›åº¦æ–‡æ¡£**
   ```typescript
   // âŒ é”™è¯¯ï¼šSubagent å®Œæˆåä¸æ›´æ–°è¿›åº¦
   Task å®Œæˆ â†’ ç›´æ¥è¿›å…¥ä¸‹ä¸€ä¸ªä»»åŠ¡

   // âœ… æ­£ç¡®ï¼šç«‹å³æ›´æ–°è¿›åº¦
   Task å®Œæˆ â†’ è¯»å–è¾“å‡ºæ–‡æ¡£ â†’ æ›´æ–° progress.md â†’ è§„åˆ’ä¸‹ä¸€æ­¥
   ```

#### âœ… ä¸»çª—å£ï¼ˆControllerï¼‰æ­£ç¡®èŒè´£

**Controller çš„å”¯ä¸€èŒè´£**ï¼š

1. âœ… **ä½¿ç”¨ Sequential Thinking MCP åˆ†æå’Œè§„åˆ’**
   ```typescript
   // æ­¥éª¤ 1: ä½¿ç”¨ MCP æ‹†è§£ä»»åŠ¡
   Sequential Thinking MCP:
     æ€è€ƒ 1: åˆ†æéœ€æ±‚å’Œç›®æ ‡
     æ€è€ƒ 2: è¯†åˆ«ä¸»è¦æ¨¡å—
     æ€è€ƒ 3: åˆ†æä¾èµ–å…³ç³»
     æ€è€ƒ 4: åˆ’åˆ†å¹¶å‘æ‰¹æ¬¡
     æ€è€ƒ 5: ç”Ÿæˆä»»åŠ¡åˆ—è¡¨
   ```

2. âœ… **åˆ›å»ºä»»åŠ¡æ–‡æ¡£**
   ```markdown
   # Task 1a: ç”¨æˆ·è®¤è¯ API

   ## Role
   Backend Architect

   ## Objective
   å®ç°ç”¨æˆ·æ³¨å†Œå’Œç™»å½• API

   ## Requirements
   - POST /api/auth/register
   - POST /api/auth/login
   - JWT token ç”Ÿæˆ

   ## Output Location
   docs/outputs/output-1a-auth-api.md
   ```

3. âœ… **å¹¶å‘å¯åŠ¨ Subagent**
   ```typescript
   // åœ¨å•ä¸ªæ¶ˆæ¯ä¸­å¯åŠ¨æ‰€æœ‰ç‹¬ç«‹ä»»åŠ¡
   Task 1a: Backend Architect - ç”¨æˆ·è®¤è¯ API
   Task 1b: Database Architect - æ•°æ®åº“è®¾è®¡
   Task 1c: Frontend Developer - ç™»å½• UI
   Task 1d: Security Auditor - å®‰å…¨å®¡è®¡

   // 4 ä¸ªä»»åŠ¡åŒæ—¶æ‰§è¡Œï¼ˆå¹¶å‘ï¼‰
   ```

4. âœ… **è¯»å–è¾“å‡ºæ–‡æ¡£å¹¶æ›´æ–°è¿›åº¦**
   ```markdown
   # è¯»å–è¾“å‡ºï¼ˆä¸è¯»æºä»£ç ï¼‰
   Read docs/outputs/output-1a-auth-api.md  (5k tokens)
   Read docs/outputs/output-1b-database.md  (5k tokens)

   # æ›´æ–°è¿›åº¦æ–‡æ¡£
   docs/progress/phase1-progress.md:
   - Task 1a: âœ… å®Œæˆ (2025-10-07 10:00)
   - Task 1b: âœ… å®Œæˆ (2025-10-07 10:00)
   - æ€»ä½“è¿›åº¦: 50% (2/4 å®Œæˆ)
   ```

5. âœ… **ä½¿ç”¨ MCP åˆ†æä¸‹ä¸€æ­¥**
   ```typescript
   Sequential Thinking MCP:
     æ€è€ƒ 1: æ£€æŸ¥ä»»åŠ¡å®Œæˆæƒ…å†µ
     æ€è€ƒ 2: è¯„ä¼°ä»£ç è´¨é‡
     æ€è€ƒ 3: è¯†åˆ«é›†æˆé—®é¢˜
     æ€è€ƒ 4: è§„åˆ’ä¸‹ä¸€æ‰¹ä»»åŠ¡

   è¾“å‡º: ä¸‹ä¸€æ‰¹å¹¶å‘ä»»åŠ¡åˆ—è¡¨
   ```

#### ğŸ“Š Token æ¶ˆè€—å¯¹æ¯”

| æ“ä½œæ¨¡å¼ | Token æ¶ˆè€— | è¯´æ˜ |
|---------|-----------|------|
| âŒ ä¸»çª—å£ç›´æ¥å†™ä»£ç  | ç´¯ç§¯å¢é•¿ | æ¯æ¬¡æ“ä½œéƒ½ç´¯ç§¯å†å²ä¸Šä¸‹æ–‡ |
| âŒ ä¸»çª—å£è¯»å–æºä»£ç  | 20k-50k/æ¬¡ | å¤§å‹æ–‡ä»¶æ¶ˆè€—ä¸¥é‡ |
| âœ… åªè¯»è¾“å‡ºæ–‡æ¡£ | 5k/æ¬¡ | ç²¾ç®€æ‘˜è¦ï¼Œä½æ¶ˆè€— |
| âœ… ä½¿ç”¨ Subagent | 25k/ä»»åŠ¡ | ç‹¬ç«‹ä¸Šä¸‹æ–‡ï¼Œä¸ç´¯ç§¯ |
| âœ… å¹¶å‘ N ä¸ªä»»åŠ¡ | 25kÃ—N | åŒæ—¶æ‰§è¡Œï¼Œæ€»æ—¶é—´ä¸å˜ |

**ç¤ºä¾‹å¯¹æ¯”**ï¼š

```typescript
// âŒ é”™è¯¯æ¨¡å¼ï¼ˆä¸»çª—å£å†™ä»£ç ï¼‰
å¼€å§‹: 0 tokens
è¯»å– 3 ä¸ªæ–‡ä»¶: +45k tokens (ç´¯ç§¯åˆ° 45k)
ä¿®æ”¹ä»£ç : +15k tokens (ç´¯ç§¯åˆ° 60k)
è¯»å–æ›´å¤šæ–‡ä»¶: +30k tokens (ç´¯ç§¯åˆ° 90k)
ç»§ç»­ä¿®æ”¹: +20k tokens (ç´¯ç§¯åˆ° 110k)
... å¾ˆå¿«è¾¾åˆ°ä¸Šä¸‹æ–‡ä¸Šé™

// âœ… æ­£ç¡®æ¨¡å¼ï¼ˆä½¿ç”¨ Subagentï¼‰
å¼€å§‹: 0 tokens
MCP åˆ†æä»»åŠ¡: +5k tokens (ä¸»çª—å£ç´¯ç§¯ 5k)
åˆ›å»º 4 ä¸ªä»»åŠ¡æ–‡æ¡£: +2k tokens (ä¸»çª—å£ç´¯ç§¯ 7k)
å¯åŠ¨ 4 ä¸ª Subagent: 4Ã—25k = 100k tokens (ç‹¬ç«‹ä¸Šä¸‹æ–‡)
è¯»å– 4 ä¸ªè¾“å‡ºæ–‡æ¡£: +20k tokens (ä¸»çª—å£ç´¯ç§¯ 27k)
æ›´æ–°è¿›åº¦: +2k tokens (ä¸»çª—å£ç´¯ç§¯ 29k)
MCP åˆ†æä¸‹ä¸€æ­¥: +5k tokens (ä¸»çª—å£ç´¯ç§¯ 34k)

ç»“æœ: ä¸»çª—å£ä»…ç”¨ 34k tokensï¼Œè¿œä½äºä¸Šé™
```

#### ğŸ¯ å®é™…æ‰§è¡Œæ£€æŸ¥æ¸…å•

æ¯æ¬¡å¼€å‘æ—¶æ£€æŸ¥ï¼š

- [ ] âœ… ä¸»çª—å£æ˜¯å¦ä½¿ç”¨äº† Sequential Thinking MCP æ‹†è§£ä»»åŠ¡ï¼Ÿ
- [ ] âœ… æ˜¯å¦ä¸ºæ¯ä¸ªä»»åŠ¡åˆ›å»ºäº†ç‹¬ç«‹çš„ä»»åŠ¡æ–‡æ¡£ï¼Ÿ
- [ ] âœ… æ˜¯å¦å¹¶å‘å¯åŠ¨äº†æ‰€æœ‰ç‹¬ç«‹ä»»åŠ¡ï¼ˆå•ä¸ªæ¶ˆæ¯å¤šä¸ª Taskï¼‰ï¼Ÿ
- [ ] âœ… ä¸»çª—å£æ˜¯å¦åªè¯»å–è¾“å‡ºæ–‡æ¡£ï¼ˆè€Œéæºä»£ç ï¼‰ï¼Ÿ
- [ ] âœ… æ˜¯å¦åœ¨æ¯ä¸ªä»»åŠ¡å®Œæˆåç«‹å³æ›´æ–°äº†è¿›åº¦æ–‡æ¡£ï¼Ÿ
- [ ] âœ… æ˜¯å¦ä½¿ç”¨ MCP åˆ†æäº†ä¸‹ä¸€æ­¥è¡ŒåŠ¨ï¼Ÿ
- [ ] âŒ ä¸»çª—å£æ˜¯å¦ç›´æ¥ä¿®æ”¹äº†ä»£ç ï¼Ÿï¼ˆåº”è¯¥æ˜¯ NOï¼‰
- [ ] âŒ ä¸»çª—å£æ˜¯å¦è¯»å–äº†æºä»£ç æ–‡ä»¶ï¼Ÿï¼ˆåº”è¯¥æ˜¯ NOï¼‰

---

### 6. æœ¬åœ°å¼€å‘ç¯å¢ƒé…ç½®è§„èŒƒ ğŸ–¥ï¸

#### æ ¸å¿ƒåŸåˆ™
**æœ¬åœ°å¼€å‘è°ƒè¯•æ—¶ï¼Œå‰ç«¯å’Œåç«¯åº”ç”¨å¿…é¡»åœ¨æœ¬åœ°è¿è¡Œï¼Œä¸ä½¿ç”¨ Dockerï¼›æ•°æ®åº“ã€Redis ç­‰åŸºç¡€è®¾æ–½æœåŠ¡ä½¿ç”¨ Dockerï¼›ç”Ÿäº§ç¯å¢ƒå…¨éƒ¨ä½¿ç”¨ Docker**

#### ç¯å¢ƒé…ç½®ç­–ç•¥

**æœ¬åœ°å¼€å‘ç¯å¢ƒ**ï¼š
```yaml
# âœ… æœ¬åœ°è¿è¡Œï¼ˆä¸ç”¨ Dockerï¼‰
å‰ç«¯åº”ç”¨:
  - åŸå› : çƒ­æ›´æ–°å¿«ã€è°ƒè¯•æ–¹ä¾¿ã€IDE é›†æˆå¥½
  - è¿è¡Œæ–¹å¼: npm run dev / yarn dev
  - ç«¯å£: 3000 (æˆ–é…ç½®æ–‡ä»¶æŒ‡å®š)

åç«¯åº”ç”¨:
  - åŸå› : æ–­ç‚¹è°ƒè¯•ã€å¿«é€Ÿé‡å¯ã€æ—¥å¿—å®æ—¶æŸ¥çœ‹
  - è¿è¡Œæ–¹å¼: npm run dev / python main.py
  - ç«¯å£: 8000 (æˆ–é…ç½®æ–‡ä»¶æŒ‡å®š)

# âœ… Docker è¿è¡Œ
æ•°æ®åº“æœåŠ¡:
  - PostgreSQL / MySQL / MongoDB
  - åŸå› : ç‰ˆæœ¬ä¸€è‡´ã€éš”ç¦»ç¯å¢ƒã€å¿«é€Ÿé‡ç½®
  - é…ç½®: docker-compose.yml

Redis / ç¼“å­˜:
  - åŸå› : è½»é‡ã€æ˜“é‡ç½®ã€ç‰ˆæœ¬ä¸€è‡´
  - é…ç½®: docker-compose.yml

æ¶ˆæ¯é˜Ÿåˆ—:
  - RabbitMQ / Kafka / NATS
  - åŸå› : å¤æ‚é…ç½®ã€ç»Ÿä¸€ç®¡ç†
  - é…ç½®: docker-compose.yml
```

**ç”Ÿäº§ç¯å¢ƒ**ï¼š
```yaml
# âœ… å…¨éƒ¨ä½¿ç”¨ Docker
æ‰€æœ‰æœåŠ¡:
  - å‰ç«¯åº”ç”¨ (Nginx + é™æ€æ–‡ä»¶)
  - åç«¯åº”ç”¨ (API æœåŠ¡)
  - æ•°æ®åº“æœåŠ¡
  - ç¼“å­˜æœåŠ¡
  - æ¶ˆæ¯é˜Ÿåˆ—
  - ç›‘æ§æœåŠ¡
é…ç½®æ–¹å¼:
  - Docker Compose (å•æœº)
  - Kubernetes (é›†ç¾¤)
```

#### æœ¬åœ°å¼€å‘é…ç½®ç¤ºä¾‹

**docker-compose.dev.yml**ï¼ˆä»…åŸºç¡€è®¾æ–½ï¼‰ï¼š
```yaml
version: '3.8'

services:
  # æ•°æ®åº“
  postgres:
    image: postgres:15
    ports:
      - "5432:5432"
    environment:
      POSTGRES_DB: dev_db
      POSTGRES_USER: dev_user
      POSTGRES_PASSWORD: dev_pass
    volumes:
      - postgres_data:/var/lib/postgresql/data

  # Redis
  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"
    volumes:
      - redis_data:/data

  # æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆå¦‚éœ€è¦ï¼‰
  rabbitmq:
    image: rabbitmq:3-management
    ports:
      - "5672:5672"
      - "15672:15672"
    volumes:
      - rabbitmq_data:/var/lib/rabbitmq

volumes:
  postgres_data:
  redis_data:
  rabbitmq_data:
```

**å¯åŠ¨æœ¬åœ°å¼€å‘ç¯å¢ƒ**ï¼š
```bash
# 1. å¯åŠ¨åŸºç¡€è®¾æ–½æœåŠ¡ï¼ˆDockerï¼‰
docker-compose -f docker-compose.dev.yml up -d

# 2. å¯åŠ¨åç«¯ï¼ˆæœ¬åœ°ï¼‰
cd backend
npm install
npm run dev  # æˆ– yarn dev

# 3. å¯åŠ¨å‰ç«¯ï¼ˆæœ¬åœ°ï¼‰- æ–°ç»ˆç«¯
cd frontend
npm install
npm run dev  # æˆ– yarn dev

# 4. éªŒè¯æœåŠ¡
curl http://localhost:8000/health  # åç«¯
curl http://localhost:3000          # å‰ç«¯
```

#### é…ç½®æ–‡ä»¶ç®¡ç†

**ç¯å¢ƒå˜é‡é…ç½®**ï¼š
```bash
# .env.developmentï¼ˆæœ¬åœ°å¼€å‘ï¼‰
# æ•°æ®åº“è¿æ¥ï¼ˆDocker æœåŠ¡ï¼‰
DATABASE_URL=postgresql://dev_user:dev_pass@localhost:5432/dev_db
REDIS_URL=redis://localhost:6379

# åº”ç”¨é…ç½®ï¼ˆæœ¬åœ°è¿è¡Œï¼‰
BACKEND_URL=http://localhost:8000
FRONTEND_URL=http://localhost:3000
NODE_ENV=development

# è°ƒè¯•é€‰é¡¹
DEBUG=true
LOG_LEVEL=debug
HOT_RELOAD=true
```

```bash
# .env.productionï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
# æ•°æ®åº“è¿æ¥ï¼ˆDocker å†…éƒ¨ç½‘ç»œï¼‰
DATABASE_URL=postgresql://prod_user:prod_pass@postgres:5432/prod_db
REDIS_URL=redis://redis:6379

# åº”ç”¨é…ç½®ï¼ˆDocker å®¹å™¨ï¼‰
BACKEND_URL=http://backend:8000
FRONTEND_URL=https://example.com
NODE_ENV=production

# ç”Ÿäº§é€‰é¡¹
DEBUG=false
LOG_LEVEL=info
HOT_RELOAD=false
```

#### å¼€å‘å·¥ä½œæµç¨‹

**æ ‡å‡†å¼€å‘æµç¨‹**ï¼š
```
1. å¯åŠ¨åŸºç¡€è®¾æ–½
   â†’ docker-compose -f docker-compose.dev.yml up -d

2. å¼€å‘ä»£ç 
   â†’ å‰ç«¯/åç«¯åœ¨æœ¬åœ°è¿è¡Œï¼Œæ”¯æŒçƒ­æ›´æ–°
   â†’ ä»£ç æ”¹åŠ¨ç«‹å³ç”Ÿæ•ˆï¼Œæ— éœ€é‡å»ºé•œåƒ

3. è°ƒè¯•
   â†’ ä½¿ç”¨ IDE æ–­ç‚¹è°ƒè¯•ï¼ˆVSCode / WebStormï¼‰
   â†’ æŸ¥çœ‹å®æ—¶æ—¥å¿—ï¼ˆç»ˆç«¯è¾“å‡ºï¼‰
   â†’ ä½¿ç”¨ Chrome DevToolsï¼ˆå‰ç«¯ï¼‰

4. æäº¤å‰æµ‹è¯•
   â†’ è¿è¡Œå•å…ƒæµ‹è¯•: npm run test
   â†’ è¿è¡Œé›†æˆæµ‹è¯•: npm run test:e2e
   â†’ æ£€æŸ¥ä»£ç è§„èŒƒ: npm run lint

5. éƒ¨ç½²å‰éªŒè¯
   â†’ æ„å»ºç”Ÿäº§é•œåƒ: docker build -t app:latest .
   â†’ æœ¬åœ°è¿è¡Œç”Ÿäº§é•œåƒ: docker-compose up
   â†’ éªŒè¯åŠŸèƒ½æ­£å¸¸åéƒ¨ç½²
```

#### å¸¸è§é—®é¢˜å¤„ç†

**é—®é¢˜ 1ï¼šæœ¬åœ°åº”ç”¨è¿æ¥ä¸åˆ° Docker æœåŠ¡**
```bash
# è§£å†³æ–¹æ¡ˆï¼šæ£€æŸ¥ç«¯å£æ˜ å°„
docker-compose ps
docker-compose logs postgres
telnet localhost 5432
```

**é—®é¢˜ 2ï¼šDocker æœåŠ¡æ•°æ®æŒä¹…åŒ–**
```bash
# ä½¿ç”¨å‘½åå·ï¼ˆå·²åœ¨ docker-compose.yml é…ç½®ï¼‰
volumes:
  postgres_data:  # æ•°æ®æŒä¹…åŒ–
  redis_data:     # æ•°æ®æŒä¹…åŒ–
```

**é—®é¢˜ 3ï¼šé‡ç½®å¼€å‘ç¯å¢ƒ**
```bash
# é‡ç½®æ‰€æœ‰ Docker æœåŠ¡
docker-compose -f docker-compose.dev.yml down -v
docker-compose -f docker-compose.dev.yml up -d

# é‡ç½®åº”ç”¨ä¾èµ–
rm -rf node_modules package-lock.json
npm install
```

#### æœ€ä½³å®è·µ

**âœ… æ¨èåšæ³•**ï¼š
1. **åˆ†ç¦»å…³æ³¨ç‚¹**ï¼šåº”ç”¨ä»£ç ï¼ˆæœ¬åœ°ï¼‰vs åŸºç¡€è®¾æ–½ï¼ˆDockerï¼‰
2. **ç»Ÿä¸€ç‰ˆæœ¬**ï¼šå›¢é˜Ÿä½¿ç”¨ç›¸åŒçš„ Docker é•œåƒç‰ˆæœ¬
3. **å¿«é€Ÿè¿­ä»£**ï¼šæœ¬åœ°è¿è¡Œæ”¯æŒçƒ­æ›´æ–°ï¼Œæå‡å¼€å‘æ•ˆç‡
4. **ç”Ÿäº§ä¸€è‡´**ï¼šç”Ÿäº§ç¯å¢ƒå®Œå…¨å®¹å™¨åŒ–ï¼Œé¿å…"åœ¨æˆ‘æœºå™¨ä¸Šèƒ½è·‘"é—®é¢˜
5. **æ–‡æ¡£åŒ–é…ç½®**ï¼šåœ¨ README.md ä¸­è¯´æ˜å¯åŠ¨æ­¥éª¤

**âŒ é¿å…åšæ³•**ï¼š
1. æœ¬åœ°å¼€å‘ä¹Ÿç”¨ Docker è¿è¡Œå‰åç«¯ï¼ˆçƒ­æ›´æ–°æ…¢ã€è°ƒè¯•å›°éš¾ï¼‰
2. ç”Ÿäº§ç¯å¢ƒæ··ç”¨ Docker å’Œé Docker éƒ¨ç½²
3. æ•°æ®åº“ç›´æ¥å®‰è£…åœ¨æœ¬åœ°ï¼ˆç‰ˆæœ¬ä¸ä¸€è‡´ã€éš¾ä»¥é‡ç½®ï¼‰
4. ç¼ºå°‘ç¯å¢ƒå˜é‡æ–‡æ¡£ï¼ˆå›¢é˜Ÿæˆå‘˜é…ç½®å›°éš¾ï¼‰

#### Subagent å¼€å‘è§„èŒƒ

**åœ¨ç¼–å†™ Subagent ä»»åŠ¡æ–‡æ¡£æ—¶**ï¼š
```markdown
## Environment Setup

**Development**:
- Frontend: Run locally with `npm run dev` (port 3000)
- Backend: Run locally with `npm run dev` (port 8000)
- Database: Docker container (port 5432)
- Redis: Docker container (port 6379)

**Production**:
- All services run in Docker containers
- Use docker-compose.prod.yml or Kubernetes manifests
```

**åœ¨å®ç°ä»£ç æ—¶**ï¼š
```typescript
// âœ… æ­£ç¡®ï¼šä½¿ç”¨ç¯å¢ƒå˜é‡é€‚é…ä¸åŒç¯å¢ƒ
const config = {
  database: {
    host: process.env.DB_HOST || 'localhost',  // æœ¬åœ°: localhost, ç”Ÿäº§: postgres
    port: parseInt(process.env.DB_PORT || '5432'),
  },
  redis: {
    host: process.env.REDIS_HOST || 'localhost',  // æœ¬åœ°: localhost, ç”Ÿäº§: redis
    port: parseInt(process.env.REDIS_PORT || '6379'),
  }
};

// âŒ é”™è¯¯ï¼šç¡¬ç¼–ç  Docker æœåŠ¡å
const config = {
  database: {
    host: 'postgres',  // æœ¬åœ°å¼€å‘æ— æ³•è¿æ¥
    port: 5432,
  }
};
```

---

### 7. MCP ä½¿ç”¨è§„èŒƒ ğŸ”§

#### æ ¸å¿ƒåŸåˆ™
**ä½¿ç”¨ Sequential Thinking MCP è¿›è¡Œä»»åŠ¡è§„åˆ’å’Œæ‹†åˆ†æ˜¯å¼ºåˆ¶è¦æ±‚ï¼Œå¿…é¡»åœ¨å¼€å‘å‰å®Œæˆ**

#### ä½¿ç”¨åœºæ™¯

**âœ… å¿…é¡»ä½¿ç”¨ MCP çš„åœºæ™¯**ï¼š
1. **å¤æ‚éœ€æ±‚åˆ†æ**ï¼šå½“éœ€æ±‚æ¶‰åŠå¤šä¸ªæ¨¡å—æˆ–ç³»ç»Ÿæ—¶
2. **ä»»åŠ¡æ‹†åˆ†è§„åˆ’**ï¼šåœ¨å¯åŠ¨ Subagent ä¹‹å‰è§„åˆ’ä»»åŠ¡
3. **ä¾èµ–å…³ç³»åˆ†æ**ï¼šè¯†åˆ«ä»»åŠ¡é—´çš„ä¾èµ–å…³ç³»
4. **å¹¶å‘æœºä¼šè¯†åˆ«**ï¼šæ‰¾å‡ºå¯ä»¥å¹¶å‘æ‰§è¡Œçš„ä»»åŠ¡ç»„
5. **é£é™©è¯„ä¼°**ï¼šåˆ†ææ½œåœ¨çš„æŠ€æœ¯é£é™©å’Œå¤æ‚åº¦
6. **é›†æˆå†³ç­–**ï¼šè¯„ä¼°å¤šä¸ª Subagent çš„è¾“å‡ºå¹¶åšå‡ºå†³ç­–

**âŒ ä¸éœ€è¦ä½¿ç”¨ MCP çš„åœºæ™¯**ï¼š
1. **ç®€å•å•ä»»åŠ¡**ï¼šåªéœ€è¦å•ä¸ª Subagent å®Œæˆçš„ç®€å•ä»»åŠ¡
2. **ç´§æ€¥ä¿®å¤**ï¼šå¿«é€Ÿ bug ä¿®å¤ï¼Œæ— éœ€æ·±åº¦è§„åˆ’
3. **é…ç½®è°ƒæ•´**ï¼šç®€å•çš„é…ç½®æ–‡ä»¶ä¿®æ”¹

#### MCP å®‰è£…å’ŒéªŒè¯æµç¨‹

**è‡ªåŠ¨åŒ–æ£€æŸ¥**ï¼š
```typescript
// Controller åœ¨æ¯æ¬¡å¼€å§‹è§„åˆ’å‰æ‰§è¡Œ
async function ensureMCPReady() {
  // 1. è¯»å– MCP é…ç½®
  const configPath = 'C:/Users/53123/AppData/Roaming/Code/User/globalStorage/saoudrizwan.claude-dev/settings/cline_mcp_settings.json';
  const config = JSON.parse(await readFile(configPath));

  // 2. æ£€æŸ¥ sequentialthinking MCP
  if (!config.mcpServers?.sequentialthinking) {
    console.log('[WARN] Sequential Thinking MCP æœªé…ç½®ï¼Œæ­£åœ¨å®‰è£…...');

    // 3. æ·»åŠ é…ç½®
    config.mcpServers = config.mcpServers || {};
    config.mcpServers.sequentialthinking = {
      command: "npx",
      args: ["-y", "@modelcontextprotocol/sequentialthinking"]
    };

    // 4. ä¿å­˜é…ç½®
    await writeFile(configPath, JSON.stringify(config, null, 2));
    console.log('[SUCCESS] Sequential Thinking MCP å·²å®‰è£…');

    // 5. æç¤ºé‡å¯
    console.log('[INFO] è¯·é‡å¯ Claude Code ä»¥åŠ è½½ MCP');
    return false;
  }

  console.log('[INFO] Sequential Thinking MCP å·²å°±ç»ª');
  return true;
}
```

#### MCP ä½¿ç”¨å·¥ä½œæµç¨‹

**æ ‡å‡†æµç¨‹**ï¼š
```
1. æ¥æ”¶å¼€å‘éœ€æ±‚
   â†“
2. æ£€æŸ¥ MCP æ˜¯å¦å®‰è£…ï¼ˆè‡ªåŠ¨ï¼‰
   â†“
3. è°ƒç”¨ Sequential Thinking MCP
   â†“
4. MCP åˆ†æå’Œæ‹†åˆ†ä»»åŠ¡
   æ€è€ƒ 1ï¼šç†è§£éœ€æ±‚æ ¸å¿ƒ
   æ€è€ƒ 2ï¼šè¯†åˆ«å…³é”®æ¨¡å—
   æ€è€ƒ 3ï¼šåˆ†ææ¨¡å—ä¾èµ–
   æ€è€ƒ 4ï¼šåˆ’åˆ†ä»»åŠ¡æ‰¹æ¬¡
   æ€è€ƒ 5ï¼šè¯„ä¼°æŠ€æœ¯é£é™©
   â†“
5. ç”Ÿæˆä»»åŠ¡æ–‡æ¡£ï¼ˆåŸºäº MCP åˆ†æï¼‰
   â†“
6. å¹¶å‘å¯åŠ¨ Subagentï¼ˆæ ¹æ® MCP å»ºè®®ï¼‰
   â†“
7. æ”¶é›†ç»“æœåå†æ¬¡ä½¿ç”¨ MCP åˆ†æ
   â†“
8. MCP å†³ç­–ä¸‹ä¸€æ­¥è¡ŒåŠ¨
```

#### MCP åˆ†æç¤ºä¾‹

**è¾“å…¥**ï¼š
```
éœ€æ±‚ï¼šå®ç°å®Œæ•´çš„ Raydium DEX é›†æˆï¼ŒåŒ…æ‹¬ä»·æ ¼è·å–ã€æµåŠ¨æ€§æŸ¥è¯¢å’Œäº¤æ˜“æ‰§è¡Œ
```

**MCP åˆ†æè¿‡ç¨‹**ï¼š
```
æ€è€ƒ 1ï¼šç†è§£éœ€æ±‚èŒƒå›´
- æ ¸å¿ƒåŠŸèƒ½ï¼šä»·æ ¼è·å–ã€æµåŠ¨æ€§ã€äº¤æ˜“
- æŠ€æœ¯æ ˆï¼šRaydium SDKã€Solana Web3.js
- å¤æ‚åº¦ï¼šä¸­é«˜ï¼ˆæ¶‰åŠå¤šä¸ª SDK è°ƒç”¨ï¼‰

æ€è€ƒ 2ï¼šè¯†åˆ«ç‹¬ç«‹æ¨¡å—
æ¨¡å— Aï¼šä»·æ ¼è·å–æœåŠ¡
  - è¾“å…¥ï¼šä»£å¸å¯¹
  - è¾“å‡ºï¼šå®æ—¶ä»·æ ¼æ•°æ®
  - ä¾èµ–ï¼šRaydium SDKã€RPC è¿æ¥

æ¨¡å— Bï¼šæµåŠ¨æ€§æŸ¥è¯¢æœåŠ¡
  - è¾“å…¥ï¼šä»£å¸å¯¹
  - è¾“å‡ºï¼šæµåŠ¨æ€§æ± ä¿¡æ¯
  - ä¾èµ–ï¼šRaydium SDKã€RPC è¿æ¥

æ¨¡å— Cï¼šäº¤æ˜“æ‰§è¡Œå™¨
  - è¾“å…¥ï¼šäº¤æ˜“å‚æ•°
  - è¾“å‡ºï¼šäº¤æ˜“ç­¾å
  - ä¾èµ–ï¼šä»·æ ¼æœåŠ¡ã€æµåŠ¨æ€§æœåŠ¡ã€é’±åŒ…

æ€è€ƒ 3ï¼šåˆ†æä¾èµ–å…³ç³»
- æ¨¡å— A å’Œ Bï¼šç‹¬ç«‹ï¼Œå¯å¹¶å‘
- æ¨¡å— Cï¼šä¾èµ– A å’Œ Bï¼Œå¿…é¡»ç­‰å¾…

æ€è€ƒ 4ï¼šåˆ’åˆ†æ‰§è¡Œæ‰¹æ¬¡
æ‰¹æ¬¡ 1ï¼ˆå¹¶å‘ï¼‰ï¼š
  - Task 1a: å®ç°ä»·æ ¼è·å–æœåŠ¡
  - Task 1b: å®ç°æµåŠ¨æ€§æŸ¥è¯¢æœåŠ¡

æ‰¹æ¬¡ 2ï¼ˆä¾èµ–æ‰¹æ¬¡ 1ï¼‰ï¼š
  - Task 2a: å®ç°äº¤æ˜“æ‰§è¡Œå™¨

æ€è€ƒ 5ï¼šè¯„ä¼°é£é™©
- æŠ€æœ¯é£é™©ï¼šRaydium SDK API å¯èƒ½å˜åŒ–
- æ€§èƒ½é£é™©ï¼šRPC è°ƒç”¨å»¶è¿Ÿ
- å®‰å…¨é£é™©ï¼šç§é’¥ç®¡ç†

å»ºè®®ï¼š
- ä¸º SDK è°ƒç”¨æ·»åŠ é”™è¯¯å¤„ç†å’Œé‡è¯•
- ä½¿ç”¨è¿æ¥æ± ç®¡ç† RPC è¿æ¥
- äº¤æ˜“æ‰§è¡Œä½¿ç”¨æ¨¡æ‹Ÿæ¨¡å¼æµ‹è¯•
```

**MCP è¾“å‡º**ï¼š
```markdown
# ä»»åŠ¡æ‰§è¡Œè®¡åˆ’

## æ‰¹æ¬¡ 1ï¼šæ•°æ®æœåŠ¡ï¼ˆå¹¶å‘ï¼‰
- Task 1a: Raydium ä»·æ ¼è·å–æœåŠ¡
  - ä¼°è®¡ï¼š25k tokens
  - æ—¶é—´ï¼š30 åˆ†é’Ÿ
  - Subagent: Mainnet Integration Expert

- Task 1b: Raydium æµåŠ¨æ€§æŸ¥è¯¢æœåŠ¡
  - ä¼°è®¡ï¼š25k tokens
  - æ—¶é—´ï¼š30 åˆ†é’Ÿ
  - Subagent: Mainnet Integration Expert

## æ‰¹æ¬¡ 2ï¼šäº¤æ˜“æ‰§è¡Œï¼ˆä¾èµ–æ‰¹æ¬¡ 1ï¼‰
- Task 2a: äº¤æ˜“æ‰§è¡Œå™¨
  - ä¼°è®¡ï¼š30k tokens
  - æ—¶é—´ï¼š40 åˆ†é’Ÿ
  - Subagent: Transaction Execution Specialist

## æ€»ä½“ä¼°ç®—
- Token é¢„ç®—ï¼š80k tokens
- æ€»æ—¶é—´ï¼š70 åˆ†é’Ÿï¼ˆå¹¶å‘ï¼‰vs 100 åˆ†é’Ÿï¼ˆä¸²è¡Œï¼‰
- æ•ˆç‡æå‡ï¼š30%
```

#### å¹¶å‘å¼€å‘å¼ºåˆ¶è§„åˆ™

**åŸºäº MCP åˆ†æçš„å¹¶å‘ç­–ç•¥**ï¼š

```typescript
// âœ… æ­£ç¡®ï¼šæ ¹æ® MCP åˆ†æç»“æœå¹¶å‘å¯åŠ¨
const mcpAnalysis = {
  batch1: [
    { task: '1a', independent: true },
    { task: '1b', independent: true }
  ],
  batch2: [
    { task: '2a', dependsOn: ['1a', '1b'] }
  ]
};

// å¯åŠ¨æ‰¹æ¬¡ 1ï¼ˆå¹¶å‘ï¼‰
Controller å‘é€å•ä¸ªæ¶ˆæ¯ï¼š
  - Task tool call 1: å¯åŠ¨ Task 1a
  - Task tool call 2: å¯åŠ¨ Task 1b

ç­‰å¾…æ‰¹æ¬¡ 1 å®Œæˆåï¼š
  - Task tool call 3: å¯åŠ¨ Task 2a

// âŒ é”™è¯¯ï¼šå¿½ç•¥ MCP åˆ†æï¼Œä¸²è¡Œæ‰§è¡Œç‹¬ç«‹ä»»åŠ¡
// ä¸è¦è¿™æ ·åšï¼š
å¯åŠ¨ Task 1a â†’ ç­‰å¾… â†’ å¯åŠ¨ Task 1b â†’ ç­‰å¾… â†’ å¯åŠ¨ Task 2a
```

#### MCP è´¨é‡æ£€æŸ¥

**MCP åˆ†æè´¨é‡æ ‡å‡†**ï¼š
- [ ] è¯†åˆ«äº†æ‰€æœ‰å…³é”®æ¨¡å—
- [ ] æ­£ç¡®åˆ†æäº†ä¾èµ–å…³ç³»
- [ ] åˆ’åˆ†äº†åˆç†çš„ä»»åŠ¡æ‰¹æ¬¡
- [ ] è¯„ä¼°äº†æŠ€æœ¯é£é™©
- [ ] ä¼°ç®—äº† Token å’Œæ—¶é—´æˆæœ¬
- [ ] æä¾›äº†å¹¶å‘æ‰§è¡Œå»ºè®®

**éªŒè¯ MCP è¾“å‡º**ï¼š
```typescript
// Controller éªŒè¯ MCP åˆ†æç»“æœ
function validateMCPAnalysis(analysis) {
  // 1. æ£€æŸ¥ä»»åŠ¡æ‹†åˆ†æ˜¯å¦åˆç†
  if (analysis.tasks.some(t => t.estimatedTokens > 40000)) {
    console.warn('[WARN] ä»»åŠ¡è¿‡å¤§ï¼Œå»ºè®®è¿›ä¸€æ­¥æ‹†åˆ†');
  }

  // 2. æ£€æŸ¥ä¾èµ–å…³ç³»æ˜¯å¦æ­£ç¡®
  const dependencyGraph = buildDependencyGraph(analysis);
  if (hasCyclicDependency(dependencyGraph)) {
    console.error('[ERROR] æ£€æµ‹åˆ°å¾ªç¯ä¾èµ–');
  }

  // 3. æ£€æŸ¥å¹¶å‘æœºä¼š
  const concurrentTasks = findConcurrentTasks(analysis);
  console.log(`[INFO] å¯å¹¶å‘ä»»åŠ¡æ•°ï¼š${concurrentTasks.length}`);

  return true;
}
```

#### å®é™…åº”ç”¨ç¤ºä¾‹

**åœºæ™¯ï¼šæ–°åŠŸèƒ½å¼€å‘**
```
1. å¼€å‘è€…éœ€æ±‚ï¼š
   "æ·»åŠ å¤š DEX ä»·æ ¼èšåˆåŠŸèƒ½ï¼Œæ”¯æŒ Raydiumã€Orcaã€Jupiter"

2. Controller è°ƒç”¨ MCPï¼š
   æ€è€ƒ 1ï¼šè¯†åˆ« 3 ä¸ªç‹¬ç«‹çš„é›†æˆä»»åŠ¡
   æ€è€ƒ 2ï¼šå‘ç°å¯ä»¥å®Œå…¨å¹¶å‘
   æ€è€ƒ 3ï¼šå»ºè®®å¹¶å‘å¯åŠ¨ 3 ä¸ª Subagent

3. Controller æ‰§è¡Œï¼š
   å•ä¸ªæ¶ˆæ¯å¯åŠ¨ 3 ä¸ª Task tool è°ƒç”¨
   - Task 1a: Raydium é›†æˆ
   - Task 1b: Orca é›†æˆ
   - Task 1c: Jupiter é›†æˆ

4. ç»“æœï¼š
   - æ—¶é—´ï¼š30 åˆ†é’Ÿï¼ˆvs ä¸²è¡Œ 90 åˆ†é’Ÿï¼‰
   - æ•ˆç‡æå‡ï¼š3 å€
```

#### æœ€ä½³å®è·µ

**âœ… æ¨èåšæ³•**ï¼š
1. **æ¯æ¬¡è§„åˆ’å‰æ£€æŸ¥ MCP**ï¼šç¡®ä¿ MCP å·²å®‰è£…å’Œé…ç½®
2. **å¤æ‚ä»»åŠ¡å¿…ç”¨ MCP**ï¼šè¶…è¿‡ 3 ä¸ªå­ä»»åŠ¡çš„å¿…é¡»ä½¿ç”¨ MCP åˆ†æ
3. **ç›¸ä¿¡ MCP åˆ†æ**ï¼šä¸¥æ ¼æŒ‰ç…§ MCP çš„å¹¶å‘å»ºè®®æ‰§è¡Œ
4. **è®°å½• MCP è¾“å‡º**ï¼šå°† MCP åˆ†æç»“æœä¿å­˜åˆ°æ–‡æ¡£
5. **éªŒè¯ MCP å»ºè®®**ï¼šæ‰§è¡Œå‰æ£€æŸ¥ä¾èµ–å…³ç³»å’Œèµ„æºä¼°ç®—

**âŒ é¿å…åšæ³•**ï¼š
1. è·³è¿‡ MCP ç›´æ¥è§„åˆ’å¤æ‚ä»»åŠ¡
2. å¿½ç•¥ MCP çš„å¹¶å‘å»ºè®®ï¼Œé‡‡ç”¨ä¸²è¡Œæ‰§è¡Œ
3. ä¸è®°å½• MCP åˆ†æè¿‡ç¨‹
4. å¯¹ MCP çš„ä¾èµ–åˆ†ææå‡ºè´¨ç–‘ä½†ä¸éªŒè¯
5. åœ¨ MCP æœªå®‰è£…æ—¶ç»§ç»­æ‰§è¡Œ

#### ç›‘æ§å’Œä¼˜åŒ–

**MCP ä½¿ç”¨æŒ‡æ ‡**ï¼š
```typescript
// è·Ÿè¸ª MCP ä½¿ç”¨æƒ…å†µ
const mcpMetrics = {
  totalAnalyses: 0,        // MCP åˆ†ææ¬¡æ•°
  tasksIdentified: 0,      // è¯†åˆ«çš„ä»»åŠ¡æ•°
  concurrentTasks: 0,      // å¹¶å‘ä»»åŠ¡æ•°
  timeSaved: 0,           // èŠ‚çœçš„æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰
  tokenEfficiency: 0      // Token æ•ˆç‡æå‡ï¼ˆ%ï¼‰
};

// æ¯æ¬¡ä½¿ç”¨ MCP åæ›´æ–°æŒ‡æ ‡
function trackMCPUsage(analysis) {
  mcpMetrics.totalAnalyses++;
  mcpMetrics.tasksIdentified += analysis.tasks.length;
  mcpMetrics.concurrentTasks += analysis.concurrentGroups;

  const serialTime = analysis.tasks.reduce((sum, t) => sum + t.estimatedTime, 0);
  const parallelTime = Math.max(...analysis.batches.map(b => b.estimatedTime));
  mcpMetrics.timeSaved += (serialTime - parallelTime);
}
```

### 1. ä»»åŠ¡è®¾è®¡åŸåˆ™

#### âœ… DOï¼ˆæ¨èåšæ³•ï¼‰
- **å•ä¸€èŒè´£**ï¼šä¸€ä¸ªä»»åŠ¡åªåšä¸€ä»¶äº‹
- **æ˜ç¡®è¾¹ç•Œ**ï¼šæ¸…æ™°çš„è¾“å…¥å’Œè¾“å‡º
- **å¯æµ‹è¯•**ï¼šä»»åŠ¡å®Œæˆåå¯éªŒè¯
- **æ–‡æ¡£å…ˆè¡Œ**ï¼šå…ˆå†™ä»»åŠ¡æ–‡æ¡£ï¼Œå†å¯åŠ¨ Subagent

#### âŒ DON'Tï¼ˆé¿å…åšæ³•ï¼‰
- **ä»»åŠ¡è¿‡å¤§**ï¼šä¸€ä¸ªä»»åŠ¡ä¿®æ”¹ >3 ä¸ªæ–‡ä»¶
- **èŒè´£æ··æ‚**ï¼šä¸€ä¸ªä»»åŠ¡æ¶‰åŠå¤šä¸ªé¢†åŸŸ
- **æ¨¡ç³Šç›®æ ‡**ï¼šæ²¡æœ‰æ˜ç¡®çš„æˆåŠŸæ ‡å‡†
- **è·³è¿‡æ–‡æ¡£**ï¼šç›´æ¥åœ¨ prompt ä¸­å†™å¤§é‡ä»£ç 

### 1.0 ä»£ç è´¨é‡å’Œæ³¨é‡Šè§„èŒƒ ğŸ“

#### æ ¸å¿ƒåŸåˆ™
**ä»£ç å¿…é¡»åŒ…å«è¯¦ç»†çš„æ³¨é‡Šã€å®ç°çœŸæ­£çš„ä¸šåŠ¡é€»è¾‘ã€å…·å¤‡ç”Ÿäº§ç¯å¢ƒè´¨é‡ï¼ˆå¥å£®ã€å¯ç»´æŠ¤ã€å¯æ‰©å±•ï¼‰ã€åŠæ—¶å‘ç°å¹¶åé¦ˆä¸åˆç†éœ€æ±‚**

#### ä»£ç æ³¨é‡Šè¦æ±‚

**âœ… å¿…é¡»æ·»åŠ æ³¨é‡Šçš„åœ°æ–¹**ï¼š

1. **æ–‡ä»¶å¤´éƒ¨æ³¨é‡Š**ï¼š
```typescript
/**
 * æ–‡ä»¶å: userAuthService.ts
 * æè¿°: ç”¨æˆ·è®¤è¯å’ŒæˆæƒæœåŠ¡
 * åŠŸèƒ½:
 *   - ç”¨æˆ·æ³¨å†Œå’Œç™»å½•
 *   - JWT token ç”Ÿæˆå’ŒéªŒè¯
 *   - å¯†ç åŠ å¯†å’ŒéªŒè¯
 * ä¾èµ–:
 *   - bcrypt: v5.1.0
 *   - jsonwebtoken: v9.0.2
 *   - @prisma/client: v5.0.0
 * ä½œè€…: Subagent-BackendArchitect
 * æ—¥æœŸ: 2025-01-15
 */
```

2. **ç±»å’Œæ¥å£æ³¨é‡Š**ï¼š
```typescript
/**
 * ç”¨æˆ·è®¤è¯æœåŠ¡ç±»
 * è´Ÿè´£å¤„ç†ç”¨æˆ·æ³¨å†Œã€ç™»å½•å’Œ JWT token ç®¡ç†
 *
 * ä½¿ç”¨ç¤ºä¾‹:
 * ```typescript
 * const authService = new UserAuthService(prisma, jwtSecret);
 * const result = await authService.login('user@example.com', 'password123');
 * console.log(`Token: ${result.token}`);
 * ```
 *
 * @throws {AuthenticationError} - è®¤è¯å¤±è´¥æ—¶æŠ›å‡º
 * @throws {ValidationError} - å‚æ•°éªŒè¯å¤±è´¥æ—¶æŠ›å‡º
 */
export class UserAuthService {
  // å®ç°...
}
```

3. **å‡½æ•°æ³¨é‡Š**ï¼š
```typescript
/**
 * ç”¨æˆ·ç™»å½•
 *
 * @param email - ç”¨æˆ·é‚®ç®±
 * @param password - ç”¨æˆ·å¯†ç 
 * @param options - å¯é€‰é…ç½®
 * @param options.rememberMe - æ˜¯å¦ä¿æŒç™»å½•ï¼ˆé»˜è®¤ falseï¼‰
 * @param options.tokenExpiry - Token æœ‰æ•ˆæœŸï¼ˆç§’ï¼Œé»˜è®¤ 86400ï¼‰
 * @returns Promise<AuthResult> - è¿”å› token å’Œç”¨æˆ·ä¿¡æ¯
 *
 * @example
 * ```typescript
 * // åŸºæœ¬ç™»å½•
 * const result = await login('user@example.com', 'password123');
 *
 * // ä¿æŒ7å¤©ç™»å½•
 * const result = await login('user@example.com', 'password123', {
 *   rememberMe: true,
 *   tokenExpiry: 604800
 * });
 * ```
 *
 * @throws {ValidationError} - é‚®ç®±æˆ–å¯†ç æ ¼å¼é”™è¯¯
 * @throws {AuthenticationError} - ç”¨æˆ·ä¸å­˜åœ¨æˆ–å¯†ç é”™è¯¯
 */
async login(
  email: string,
  password: string,
  options?: LoginOptions
): Promise<AuthResult> {
  // 1. å‚æ•°éªŒè¯
  if (!email || !password) {
    throw new ValidationError('é‚®ç®±å’Œå¯†ç ä¸èƒ½ä¸ºç©º');
  }

  // 2. æŸ¥æ‰¾ç”¨æˆ·
  const user = await this.userRepo.findByEmail(email);
  if (!user) {
    console.log(`[AUTH] ç”¨æˆ·ä¸å­˜åœ¨: ${email}`);
    throw new AuthenticationError('ç”¨æˆ·ä¸å­˜åœ¨æˆ–å¯†ç é”™è¯¯');
  }

  // 3. éªŒè¯å¯†ç 
  try {
    const isValid = await compare(password, user.passwordHash);
    if (!isValid) {
      console.log(`[AUTH] å¯†ç é”™è¯¯: ${email}`);
      throw new AuthenticationError('ç”¨æˆ·ä¸å­˜åœ¨æˆ–å¯†ç é”™è¯¯');
    }

    // 4. ç”Ÿæˆ JWT token
    const tokenExpiry = options?.tokenExpiry || 86400;
    const token = this.generateToken(user, tokenExpiry);

    // 5. è®°å½•ç™»å½•æ—¥å¿—
    await this.logLogin(user.id, 'success');

    console.log(`[AUTH] ç™»å½•æˆåŠŸ: ${email}`);
    return {
      token,
      user: { id: user.id, email: user.email, name: user.name }
    };
  } catch (error) {
    await this.logLogin(user.id, 'failed');
    console.error(`[ERROR] ç™»å½•å¤±è´¥ ${email}:`, error);
    throw new AuthenticationError('ç™»å½•å¤±è´¥', { cause: error });
  }
}
```

4. **å¤æ‚é€»è¾‘æ³¨é‡Š**ï¼š
```typescript
// è®¡ç®—ç”¨æˆ·æƒé™
// ç®—æ³•è¯´æ˜ï¼š
// 1. è·å–ç”¨æˆ·çš„æ‰€æœ‰è§’è‰²
// 2. è·å–æ¯ä¸ªè§’è‰²å…³è”çš„æƒé™
// 3. åˆå¹¶æ‰€æœ‰æƒé™å¹¶å»é‡
// 4. æ£€æŸ¥æ˜¯å¦æœ‰å…¨å±€ç®¡ç†å‘˜æƒé™
// 5. è¿”å›æƒé™åˆ—è¡¨
const userRoles = await this.roleRepo.findByUserId(userId);
const allPermissions = new Set<string>();

for (const role of userRoles) {
  const permissions = await this.permissionRepo.findByRoleId(role.id);
  permissions.forEach(p => allPermissions.add(p.name));
}

// æ£€æŸ¥å…¨å±€ç®¡ç†å‘˜
const isAdmin = userRoles.some(role => role.name === 'SUPER_ADMIN');
if (isAdmin) {
  // ç®¡ç†å‘˜æ‹¥æœ‰æ‰€æœ‰æƒé™
  allPermissions.add('*');
}

return {
  userId,
  permissions: Array.from(allPermissions),
  isAdmin
};
```

5. **TODO å’Œ FIXME æ³¨é‡Š**ï¼š
```typescript
// TODO: æ·»åŠ OAuthç¬¬ä¸‰æ–¹ç™»å½•æ”¯æŒï¼ˆä¼˜å…ˆçº§ï¼šé«˜ï¼‰
// èƒŒæ™¯: ç”¨æˆ·å¸Œæœ›ä½¿ç”¨ Google/GitHub å¿«é€Ÿç™»å½•
// é¢„è®¡å®Œæˆ: v2.0.0
// è´Ÿè´£äºº: @auth-team

// FIXME: å¹¶å‘ç™»å½•æ—¶Sessionå†²çªé—®é¢˜ï¼ˆIssue #123ï¼‰
// å¤ç°: ç”¨æˆ·åŒæ—¶åœ¨å¤šè®¾å¤‡ç™»å½•æ—¶ï¼Œ5% æ¦‚ç‡å‘ç”Ÿsessionè¦†ç›–
// ä¸´æ—¶æ–¹æ¡ˆ: æ·»åŠ äº†è®¾å¤‡IDå­—æ®µåŒºåˆ†session
// æ ¹æœ¬æ–¹æ¡ˆ: éœ€è¦å®ç°Redisé›†ç¾¤ä¿è¯sessionä¸€è‡´æ€§
```

**âŒ é¿å…çš„æ³¨é‡Š**ï¼š
```typescript
// âŒ åºŸè¯æ³¨é‡Šï¼ˆä»£ç å·²ç»å¾ˆæ¸…æ¥šï¼‰
const price = 100; // è®¾ç½®ä»·æ ¼ä¸º100

// âŒ è¿‡æ—¶æ³¨é‡Šï¼ˆä»£ç å·²æ”¹ï¼Œæ³¨é‡Šæœªæ›´æ–°ï¼‰
// ä½¿ç”¨ axios è·å–æ•°æ®
const data = await fetch(url); // å®é™…å·²æ”¹ç”¨ fetch

// âŒ æ³¨é‡Šæ‰çš„ä»£ç ï¼ˆåº”è¯¥åˆ é™¤æˆ–ç§»åˆ° git historyï¼‰
// const oldPrice = await getOldPrice();
// return oldPrice * 1.1;
```

#### ç”Ÿäº§ç¯å¢ƒä»£ç è´¨é‡æ ‡å‡†

**âœ… å¿…é¡»å®ç°çš„åŠŸèƒ½**ï¼š

1. **çœŸå®ä¸šåŠ¡é€»è¾‘ï¼ˆä¸è¦ Mock æ•°æ®ï¼‰**ï¼š
```typescript
// âŒ é”™è¯¯ï¼šè¿”å›å‡æ•°æ®
async getPrice(): Promise<number> {
  return 100; // Mock æ•°æ®
}

// âœ… æ­£ç¡®ï¼šçœŸå®å®ç°
async getPrice(base: string, quote: string): Promise<number> {
  // 1. è¿æ¥ Raydium RPC
  const connection = new Connection(this.rpcUrl);

  // 2. è·å–æ± åœ°å€
  const poolAddress = await this.getPoolAddress(base, quote);

  // 3. è·å–è´¦æˆ·ä¿¡æ¯
  const accountInfo = await connection.getAccountInfo(poolAddress);

  // 4. è§£ææ± æ•°æ®
  const poolState = this.parsePoolState(accountInfo.data);

  // 5. è®¡ç®—ä»·æ ¼
  return poolState.quoteReserve / poolState.baseReserve;
}
```

2. **å¥å£®æ€§ï¼ˆé”™è¯¯å¤„ç†å’Œè¾¹ç•Œæ¡ä»¶ï¼‰**ï¼š
```typescript
// âœ… æ­£ç¡®ï¼šå®Œæ•´çš„é”™è¯¯å¤„ç†
async getPrice(base: string, quote: string): Promise<number> {
  // å‚æ•°éªŒè¯
  if (!base || !quote) {
    throw new ValidationError('ä»£å¸ç¬¦å·ä¸èƒ½ä¸ºç©º');
  }

  if (base === quote) {
    throw new ValidationError('åŸºç¡€ä»£å¸å’ŒæŠ¥ä»·ä»£å¸ä¸èƒ½ç›¸åŒ');
  }

  // ç½‘ç»œè¯·æ±‚é‡è¯•
  let lastError: Error | null = null;
  for (let attempt = 1; attempt <= this.maxRetries; attempt++) {
    try {
      const result = await this.fetchPoolData(base, quote);

      // æ•°æ®éªŒè¯
      if (!result || result.baseReserve <= 0 || result.quoteReserve <= 0) {
        throw new DataError('æ± æ•°æ®æ— æ•ˆ');
      }

      return result.quoteReserve / result.baseReserve;
    } catch (error) {
      lastError = error as Error;
      console.warn(`[RETRY] ç¬¬ ${attempt}/${this.maxRetries} æ¬¡å°è¯•å¤±è´¥:`, error);

      // ç­‰å¾…åé‡è¯•ï¼ˆæŒ‡æ•°é€€é¿ï¼‰
      if (attempt < this.maxRetries) {
        await sleep(Math.pow(2, attempt) * 1000);
      }
    }
  }

  // æ‰€æœ‰é‡è¯•éƒ½å¤±è´¥
  throw new NetworkError(`è·å–ä»·æ ¼å¤±è´¥ï¼ˆå·²é‡è¯• ${this.maxRetries} æ¬¡ï¼‰`, {
    cause: lastError
  });
}
```

3. **å¯ç»´æŠ¤æ€§ï¼ˆä»£ç ç»„ç»‡å’Œè®¾è®¡æ¨¡å¼ï¼‰**ï¼š
```typescript
// âœ… æ­£ç¡®ï¼šå•ä¸€èŒè´£ï¼Œä¾èµ–æ³¨å…¥
export class RaydiumPriceService {
  constructor(
    private connection: Connection,
    private cache: CacheService,
    private config: RaydiumConfig,
    private logger: Logger
  ) {}

  // å…¬å…±æ¥å£ï¼šè·å–ä»·æ ¼
  async getPrice(base: string, quote: string): Promise<number> {
    this.validateTokens(base, quote);

    const cached = await this.getCachedPrice(base, quote);
    if (cached) return cached;

    const price = await this.fetchPrice(base, quote);
    await this.cachePrice(base, quote, price);

    return price;
  }

  // ç§æœ‰æ–¹æ³•ï¼šèŒè´£å•ä¸€
  private validateTokens(base: string, quote: string): void {
    // éªŒè¯é€»è¾‘
  }

  private async getCachedPrice(base: string, quote: string): Promise<number | null> {
    // ç¼“å­˜é€»è¾‘
  }

  private async fetchPrice(base: string, quote: string): Promise<number> {
    // è·å–é€»è¾‘
  }

  private async cachePrice(base: string, quote: string, price: number): Promise<void> {
    // ç¼“å­˜æ›´æ–°é€»è¾‘
  }
}
```

4. **å¯æ‰©å±•æ€§ï¼ˆé…ç½®åŒ–å’Œæ’ä»¶åŒ–ï¼‰**ï¼š
```typescript
// âœ… æ­£ç¡®ï¼šé…ç½®é©±åŠ¨ï¼Œæ˜“æ‰©å±•
export interface DEXPriceProvider {
  getName(): string;
  getPrice(base: string, quote: string): Promise<number>;
  getSupportedTokens(): Promise<string[]>;
}

export class PriceAggregator {
  private providers: Map<string, DEXPriceProvider> = new Map();

  // åŠ¨æ€æ³¨å†Œ DEX æä¾›å•†
  registerProvider(provider: DEXPriceProvider): void {
    this.providers.set(provider.getName(), provider);
  }

  // èšåˆå¤šä¸ª DEX çš„ä»·æ ¼
  async getAveragePrice(base: string, quote: string): Promise<number> {
    const prices = await Promise.all(
      Array.from(this.providers.values()).map(p => p.getPrice(base, quote))
    );

    return prices.reduce((sum, p) => sum + p, 0) / prices.length;
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const aggregator = new PriceAggregator();
aggregator.registerProvider(new RaydiumPriceService(...));
aggregator.registerProvider(new OrcaPriceService(...));
aggregator.registerProvider(new SerumPriceService(...)); // æœªæ¥å¯è½»æ¾æ·»åŠ 
```

#### éœ€æ±‚åˆç†æ€§æ£€æŸ¥

**Controller å¿…é¡»åœ¨å¯åŠ¨ Subagent å‰æ£€æŸ¥éœ€æ±‚**ï¼š

**âœ… åˆç†éœ€æ±‚ç¤ºä¾‹**ï¼š
- "å®ç° Raydium ä»·æ ¼è·å–åŠŸèƒ½ï¼Œæ”¯æŒç¼“å­˜å’Œé”™è¯¯é‡è¯•"
- "æ·»åŠ ç›‘æ§å‘Šè­¦ï¼Œå½“ä»·å·® > 1% æ—¶å‘é€é€šçŸ¥"
- "ä¼˜åŒ–äº¤æ˜“æ‰§è¡Œå™¨ï¼Œå‡å°‘ gas è´¹ç”¨"

**âŒ ä¸åˆç†éœ€æ±‚ç¤ºä¾‹åŠå¤„ç†**ï¼š
1. **éœ€æ±‚ï¼šå®ç°æ— é£é™©å¥—åˆ©æœºå™¨äººï¼Œä¿è¯ 100% ç›ˆåˆ©**
   ```
   âš ï¸ åœæ­¢å¼€å‘
   åŸå› ï¼šæŠ€æœ¯ä¸Šä¸å¯èƒ½å®ç°æ— é£é™©å¥—åˆ©ï¼ˆå­˜åœ¨æ»‘ç‚¹ã€gas è´¹ã€ç½‘ç»œå»¶è¿Ÿç­‰é£é™©ï¼‰
   å»ºè®®ï¼šæ”¹ä¸º"å®ç°é£é™©å¯æ§çš„å¥—åˆ©æœºå™¨äººï¼Œç›®æ ‡èƒœç‡ > 70%"
   ```

2. **éœ€æ±‚ï¼šç›´æ¥ä½¿ç”¨ç”¨æˆ·ç§é’¥è¿›è¡Œäº¤æ˜“**
   ```
   âš ï¸ åœæ­¢å¼€å‘
   åŸå› ï¼šå®‰å…¨é£é™©æé«˜ï¼Œè¿åæœ€ä½³å®è·µ
   å»ºè®®ï¼šä½¿ç”¨ç¡¬ä»¶é’±åŒ…æˆ–å¤šé‡ç­¾åæ–¹æ¡ˆï¼Œç§é’¥åŠ å¯†å­˜å‚¨
   ```

3. **éœ€æ±‚ï¼šç»•è¿‡ DEX åˆçº¦ï¼Œç›´æ¥ä¿®æ”¹é“¾ä¸ŠçŠ¶æ€**
   ```
   âš ï¸ åœæ­¢å¼€å‘
   åŸå› ï¼šåŒºå—é“¾ä¸å¯ç¯¡æ”¹ï¼ŒæŠ€æœ¯ä¸Šä¸å¯èƒ½å®ç°
   å»ºè®®ï¼šé€šè¿‡åˆæ³•çš„äº¤æ˜“æ¥å£ä¸ DEX äº¤äº’
   ```

4. **éœ€æ±‚ï¼šæŠ“å–æ‰€æœ‰ DEX çš„å®æ—¶æ•°æ®ï¼Œæ— é™åˆ¶å¹¶å‘è¯·æ±‚**
   ```
   âš ï¸ åœæ­¢å¼€å‘
   åŸå› ï¼šè¿å RPC èŠ‚ç‚¹ä½¿ç”¨æ”¿ç­–ï¼Œä¼šå¯¼è‡´ IP è¢«å°ç¦
   å»ºè®®ï¼šä½¿ç”¨é€Ÿç‡é™åˆ¶ï¼ˆå¦‚æ¯ç§’ 10 æ¬¡è¯·æ±‚ï¼‰ï¼Œæˆ–ä½¿ç”¨ä»˜è´¹ RPC æœåŠ¡
   ```

**Controller æ£€æŸ¥æµç¨‹**ï¼š
```typescript
async function validateRequirement(requirement: string): Promise<ValidationResult> {
  // 1. æŠ€æœ¯å¯è¡Œæ€§æ£€æŸ¥
  const technicalIssues = checkTechnicalFeasibility(requirement);
  if (technicalIssues.length > 0) {
    return {
      valid: false,
      reason: 'æŠ€æœ¯ä¸å¯è¡Œ',
      issues: technicalIssues,
      action: 'åœæ­¢å¼€å‘ï¼Œä¸ç”¨æˆ·è®¨è®ºæ›¿ä»£æ–¹æ¡ˆ'
    };
  }

  // 2. å®‰å…¨é£é™©æ£€æŸ¥
  const securityIssues = checkSecurityRisks(requirement);
  if (securityIssues.length > 0) {
    return {
      valid: false,
      reason: 'å­˜åœ¨å®‰å…¨é£é™©',
      issues: securityIssues,
      action: 'åœæ­¢å¼€å‘ï¼Œå»ºè®®å®‰å…¨çš„å®ç°æ–¹å¼'
    };
  }

  // 3. åˆè§„æ€§æ£€æŸ¥
  const complianceIssues = checkCompliance(requirement);
  if (complianceIssues.length > 0) {
    return {
      valid: false,
      reason: 'è¿åä½¿ç”¨æ”¿ç­–æˆ–æ³•å¾‹æ³•è§„',
      issues: complianceIssues,
      action: 'åœæ­¢å¼€å‘ï¼Œæé†’ç”¨æˆ·åˆè§„é£é™©'
    };
  }

  // 4. æ€§èƒ½å’Œæˆæœ¬æ£€æŸ¥
  const costIssues = checkCostEffectiveness(requirement);
  if (costIssues.length > 0) {
    return {
      valid: true, // å¯ä»¥å®ç°ï¼Œä½†éœ€è­¦å‘Š
      warnings: costIssues,
      action: 'ç»§ç»­å¼€å‘ï¼Œä½†åœ¨æ–‡æ¡£ä¸­è¯´æ˜æˆæœ¬å’Œæ€§èƒ½å½±å“'
    };
  }

  return { valid: true, action: 'ç»§ç»­å¼€å‘' };
}
```

**åœæ­¢å¼€å‘çš„é€šçŸ¥æ¨¡æ¿**ï¼š
```
âš ï¸ å‘ç°éœ€æ±‚é—®é¢˜ï¼Œå·²åœæ­¢å¼€å‘

**é—®é¢˜ç±»å‹**: [æŠ€æœ¯ä¸å¯è¡Œ / å®‰å…¨é£é™© / åˆè§„é—®é¢˜]

**å…·ä½“é—®é¢˜**:
- [é—®é¢˜æè¿° 1]
- [é—®é¢˜æè¿° 2]

**å»ºè®®æ–¹æ¡ˆ**:
- æ–¹æ¡ˆ A: [å®‰å…¨/åˆè§„çš„æ›¿ä»£æ–¹æ¡ˆ]
- æ–¹æ¡ˆ B: [ç®€åŒ–ç‰ˆå®ç°]
- æ–¹æ¡ˆ C: [ä½¿ç”¨ç¬¬ä¸‰æ–¹æœåŠ¡]

**æ˜¯å¦ç»§ç»­ï¼Ÿè¯·ç¡®è®¤ä¿®æ”¹åçš„éœ€æ±‚**
```

### 1.1 è°ƒè¯•æ—¥å¿—è§„èŒƒ ğŸ”

#### æ ¸å¿ƒåŸåˆ™
**æ‰€æœ‰ä»£ç å¿…é¡»è¾“å‡ºç»ˆç«¯è°ƒè¯•æ—¥å¿—ï¼ŒåŒ…æ‹¬å‰ç«¯å’Œåç«¯ä»£ç **

#### æ—¥å¿—è¦æ±‚

**âœ… å¿…é¡»åšåˆ°**ï¼š
- **åç«¯æ—¥å¿—**ï¼šä½¿ç”¨ `console.log/console.error` è¾“å‡ºåˆ°ç»ˆç«¯
- **å‰ç«¯æ—¥å¿—**ï¼šä½¿ç”¨æœåŠ¡ç«¯æ—¥å¿—æˆ– Node.js æ—¥å¿—è¾“å‡ºåˆ°ç»ˆç«¯ï¼Œ**ä¸è¦åªè¾“å‡ºåˆ°æµè§ˆå™¨æ§åˆ¶å°**
- **å…³é”®èŠ‚ç‚¹**ï¼šå‡½æ•°å…¥å£ã€å‡ºå£ã€å…³é”®åˆ†æ”¯ã€é”™è¯¯å¤„ç†éƒ½è¦è®°å½•
- **ä¸Šä¸‹æ–‡ä¿¡æ¯**ï¼šåŒ…å«å¿…è¦çš„å‚æ•°å€¼ã€çŠ¶æ€ä¿¡æ¯ã€æ—¶é—´æˆ³
- **é”™è¯¯å †æ ˆ**ï¼šæ•è·å¹¶è¾“å‡ºå®Œæ•´çš„é”™è¯¯å †æ ˆä¿¡æ¯
- **åˆ†çº§è¾“å‡º**ï¼šåŒºåˆ† INFOã€WARNã€ERROR ç­‰çº§åˆ«

**æ—¥å¿—æ ¼å¼ç¤ºä¾‹**ï¼š
```typescript
// åç«¯ - Node.js/Express
console.log('[INFO] [RaydiumPriceFetcher] Fetching price for:', tokenPair);
console.error('[ERROR] [RaydiumPriceFetcher] Failed to fetch price:', error.message, error.stack);

// å‰ç«¯ - Next.js Server Component
console.log('[INFO] [PriceDisplay] Rendering price component:', { price, timestamp });

// å‰ç«¯ - API Route
export async function GET(request: Request) {
  console.log('[INFO] [API /api/price] Request received:', request.url);
  // ...
  console.log('[INFO] [API /api/price] Response:', result);
}
```

**âŒ ç¦æ­¢åšæ³•**ï¼š
- å‰ç«¯ä»£ç ä»…ä½¿ç”¨ `console.log` è¾“å‡ºåˆ°æµè§ˆå™¨æ§åˆ¶å°
- ç¼ºå°‘å…³é”®æ“ä½œçš„æ—¥å¿—è®°å½•
- æ—¥å¿—ä¿¡æ¯ä¸åŒ…å«ä¸Šä¸‹æ–‡
- åæ‰é”™è¯¯ä¸è¾“å‡ºå †æ ˆ

#### æ—¥å¿—è¦†ç›–èŒƒå›´

**å¿…é¡»è®°å½•çš„åœºæ™¯**ï¼š
1. **å‡½æ•°å…¥å£**ï¼šè®°å½•å‚æ•°å’Œè°ƒç”¨æ—¶é—´
2. **å¤–éƒ¨è°ƒç”¨**ï¼šAPI è¯·æ±‚ã€æ•°æ®åº“æŸ¥è¯¢ã€RPC è°ƒç”¨
3. **æ¡ä»¶åˆ†æ”¯**ï¼šé‡è¦çš„ if/elseã€switch åˆ†æ”¯
4. **å¾ªç¯æ“ä½œ**ï¼šæ‰¹é‡å¤„ç†çš„è¿›åº¦å’Œç»“æœ
5. **é”™è¯¯å¤„ç†**ï¼šæ‰€æœ‰ try/catch å—
6. **å¼‚æ­¥æ“ä½œ**ï¼šPromiseã€async/await çš„çŠ¶æ€
7. **çŠ¶æ€å˜æ›´**ï¼šå…³é”®æ•°æ®çš„ä¿®æ”¹

**æ—¥å¿—ç¤ºä¾‹**ï¼š
```typescript
async function fetchRaydiumPrice(tokenPair: string): Promise<PriceData | null> {
  console.log(`[INFO] [fetchRaydiumPrice] START - tokenPair: ${tokenPair}, timestamp: ${Date.now()}`);

  const maxRetries = 3;
  let attempt = 0;

  while (attempt < maxRetries) {
    attempt++;
    console.log(`[INFO] [fetchRaydiumPrice] Attempt ${attempt}/${maxRetries}`);

    try {
      const connection = new Connection(process.env.SOLANA_RPC_URL!);
      console.log(`[INFO] [fetchRaydiumPrice] Connection established to RPC`);

      const poolInfo = await this.getRaydiumPool(tokenPair);
      console.log(`[INFO] [fetchRaydiumPrice] Pool info retrieved:`, poolInfo ? 'success' : 'not found');

      if (!poolInfo) {
        throw new Error(`Pool not found for ${tokenPair}`);
      }

      const price = this.calculatePrice(poolInfo);
      console.log(`[INFO] [fetchRaydiumPrice] Price calculated: ${price}`);

      const result = {
        tokenPair,
        price,
        timestamp: Date.now(),
        source: 'raydium'
      };

      console.log(`[INFO] [fetchRaydiumPrice] SUCCESS - Result:`, JSON.stringify(result));
      return result;

    } catch (error) {
      console.error(`[ERROR] [fetchRaydiumPrice] Attempt ${attempt} failed:`, error.message);
      console.error(`[ERROR] [fetchRaydiumPrice] Stack trace:`, error.stack);

      if (attempt >= maxRetries) {
        console.error(`[ERROR] [fetchRaydiumPrice] FAILED - All ${maxRetries} attempts exhausted`);
        return null;
      }

      const delay = Math.pow(2, attempt) * 1000;
      console.log(`[INFO] [fetchRaydiumPrice] Retrying in ${delay}ms...`);
      await this.sleep(delay);
    }
  }

  console.log(`[INFO] [fetchRaydiumPrice] END - Returning null`);
  return null;
}
```

### 1.2 æµ‹è¯•éªŒè¯è§„èŒƒ âœ…

#### æ ¸å¿ƒåŸåˆ™
**æ¯æ¬¡ä»£ç å®ç°å®Œæˆåï¼Œå¿…é¡»è¿è¡Œé¡¹ç›®å¹¶æ£€æŸ¥ç»ˆç«¯æ—¥å¿—ï¼Œç¡®ä¿æ²¡æœ‰é”™è¯¯æˆ–è­¦å‘Š**

#### æµ‹è¯•æµç¨‹

**âœ… å¿…é¡»æ‰§è¡Œçš„æ­¥éª¤**ï¼š

1. **è¿è¡Œé¡¹ç›®**
   ```bash
   # åç«¯é¡¹ç›®
   npm run dev
   # æˆ–
   npm start

   # å‰ç«¯é¡¹ç›®
   npm run dev
   # æˆ–
   yarn dev
   ```

2. **è§‚å¯Ÿç»ˆç«¯æ—¥å¿—**
   - æ£€æŸ¥å¯åŠ¨è¿‡ç¨‹ä¸­æ˜¯å¦æœ‰é”™è¯¯
   - æ£€æŸ¥æ˜¯å¦æœ‰æœªæ•è·çš„å¼‚å¸¸
   - æ£€æŸ¥æ˜¯å¦æœ‰åºŸå¼ƒ API è­¦å‘Š
   - æ£€æŸ¥æ˜¯å¦æœ‰ç±»å‹é”™è¯¯

3. **è§¦å‘ä»£ç è·¯å¾„**
   - è®¿é—®ç›¸å…³é¡µé¢æˆ– API ç«¯ç‚¹
   - è§¦å‘æ–°å®ç°çš„åŠŸèƒ½
   - éªŒè¯æ—¥å¿—è¾“å‡ºç¬¦åˆé¢„æœŸ

4. **æ£€æŸ¥æ—¥å¿—è´¨é‡**
   - ç¡®è®¤å…³é”®æ“ä½œæœ‰æ—¥å¿—è¾“å‡º
   - ç¡®è®¤æ—¥å¿—ä¿¡æ¯å®Œæ•´ï¼ˆåŒ…å«ä¸Šä¸‹æ–‡ï¼‰
   - ç¡®è®¤é”™è¯¯æœ‰å®Œæ•´å †æ ˆä¿¡æ¯
   - ç¡®è®¤æ—¥å¿—çº§åˆ«æ­£ç¡®ï¼ˆINFO/WARN/ERRORï¼‰

5. **ä¿®å¤é—®é¢˜**
   - å¦‚æœå‘ç°é”™è¯¯ï¼Œç«‹å³ä¿®å¤
   - å¦‚æœå‘ç°è­¦å‘Šï¼Œè¯„ä¼°å¹¶å¤„ç†
   - é‡æ–°è¿è¡Œæµ‹è¯•ç›´åˆ°æ²¡æœ‰é—®é¢˜

#### éªŒè¯æ¸…å•

**åœ¨æäº¤ä»£ç å‰å¿…é¡»ç¡®è®¤**ï¼š

- [ ] é¡¹ç›®èƒ½å¤ŸæˆåŠŸå¯åŠ¨ï¼Œæ— å¯åŠ¨é”™è¯¯
- [ ] ç»ˆç«¯æ—¥å¿—ä¸­æ²¡æœ‰ ERROR çº§åˆ«çš„è¾“å‡º
- [ ] ç»ˆç«¯æ—¥å¿—ä¸­æ²¡æœ‰æœªå¤„ç†çš„ Promise rejection
- [ ] æ–°åŠŸèƒ½çš„æ—¥å¿—è¾“å‡ºå®Œæ•´ä¸”æ¸…æ™°
- [ ] é”™è¯¯å¤„ç†è·¯å¾„æœ‰æ­£ç¡®çš„æ—¥å¿—è¾“å‡º
- [ ] æ²¡æœ‰å†—ä½™æˆ–åƒåœ¾æ—¥å¿—ï¼ˆå¦‚è¿‡åº¦çš„ debug ä¿¡æ¯ï¼‰
- [ ] å‰ç«¯ä»£ç çš„æ—¥å¿—åœ¨ç»ˆç«¯å¯è§ï¼ˆä¸ä»…åœ¨æµè§ˆå™¨æ§åˆ¶å°ï¼‰

#### å¸¸è§é—®é¢˜æ£€æŸ¥

**å¿…é¡»æ’æŸ¥çš„é—®é¢˜**ï¼š

1. **ç±»å‹é”™è¯¯**
   ```
   âŒ TypeError: Cannot read property 'xxx' of undefined
   âœ… æ£€æŸ¥å¯¹è±¡æ˜¯å¦å­˜åœ¨ï¼Œæ·»åŠ å¯é€‰é“¾æˆ–é»˜è®¤å€¼
   ```

2. **å¼‚æ­¥é”™è¯¯**
   ```
   âŒ UnhandledPromiseRejectionWarning
   âœ… æ‰€æœ‰ Promise å¿…é¡»æœ‰ .catch() æˆ–åœ¨ try/catch ä¸­
   ```

3. **ç¯å¢ƒå˜é‡**
   ```
   âŒ process.env.XXX is undefined
   âœ… æ£€æŸ¥ .env æ–‡ä»¶é…ç½®ï¼Œæ·»åŠ é»˜è®¤å€¼æˆ–é”™è¯¯æç¤º
   ```

4. **ä¾èµ–ç¼ºå¤±**
   ```
   âŒ Cannot find module 'xxx'
   âœ… è¿è¡Œ npm install æˆ– yarn install
   ```

5. **ç«¯å£å ç”¨**
   ```
   âŒ EADDRINUSE: address already in use :::3000
   âœ… æ›´æ¢ç«¯å£æˆ–å…³é—­å ç”¨è¿›ç¨‹
   ```

#### æ—¥å¿—éªŒè¯ç¤ºä¾‹

**è‰¯å¥½çš„æµ‹è¯•è¾“å‡º**ï¼š
```
[INFO] [Server] Starting on port 3000...
[INFO] [Database] Connecting to MongoDB...
[INFO] [Database] Connected successfully
[INFO] [RaydiumPriceFetcher] Initializing with RPC: https://api.mainnet-beta.solana.com
[INFO] [Server] Server ready on http://localhost:3000

[INFO] [API /api/price] Request received: /api/price?pair=SOL/USDC
[INFO] [fetchRaydiumPrice] START - tokenPair: SOL/USDC, timestamp: 1696234567890
[INFO] [fetchRaydiumPrice] Attempt 1/3
[INFO] [fetchRaydiumPrice] Connection established to RPC
[INFO] [fetchRaydiumPrice] Pool info retrieved: success
[INFO] [fetchRaydiumPrice] Price calculated: 142.35
[INFO] [fetchRaydiumPrice] SUCCESS - Result: {"tokenPair":"SOL/USDC","price":142.35,"timestamp":1696234567890,"source":"raydium"}
[INFO] [API /api/price] Response: {"success":true,"data":{"price":142.35}}
```

**æœ‰é—®é¢˜çš„æµ‹è¯•è¾“å‡º**ï¼ˆéœ€è¦ä¿®å¤ï¼‰ï¼š
```
[INFO] [Server] Starting on port 3000...
[INFO] [Database] Connecting to MongoDB...
[ERROR] [Database] Connection failed: MongoNetworkError: connect ECONNREFUSED 127.0.0.1:27017
    at connectionFailureError (/app/node_modules/mongodb/lib/core/connection/connect.js:362:14)
    at Socket.<anonymous> (/app/node_modules/mongodb/lib/core/connection/connect.js:330:16)
    ...
âŒ éœ€è¦ä¿®å¤ï¼šæ£€æŸ¥ MongoDB è¿æ¥é…ç½®æˆ–å¯åŠ¨ MongoDB æœåŠ¡

[INFO] [API /api/price] Request received: /api/price?pair=SOL/USDC
[ERROR] [fetchRaydiumPrice] Attempt 1 failed: Cannot read property 'baseReserve' of null
[ERROR] [fetchRaydiumPrice] Stack trace: TypeError: Cannot read property 'baseReserve' of null
    at RaydiumPriceFetcher.calculatePrice (/app/src/fetcher.ts:45:30)
    ...
âŒ éœ€è¦ä¿®å¤ï¼šæ·»åŠ  null æ£€æŸ¥æˆ–æ”¹è¿›é”™è¯¯å¤„ç†
```

#### æŒç»­æ”¹è¿›

**è¿­ä»£å¾ªç¯**ï¼š
```
1. å®ç°ä»£ç  + æ·»åŠ æ—¥å¿—
   â†“
2. è¿è¡Œé¡¹ç›®
   â†“
3. æ£€æŸ¥ç»ˆç«¯æ—¥å¿—
   â†“
4. å‘ç°é—®é¢˜ï¼Ÿ
   â”œâ”€ æ˜¯ â†’ ä¿®å¤ä»£ç  â†’ å›åˆ°æ­¥éª¤ 2
   â””â”€ å¦ â†’ æµ‹è¯•é€šè¿‡ âœ…
```

**æˆåŠŸæ ‡å‡†**ï¼š
- è¿ç»­ 3 æ¬¡è¿è¡Œéƒ½æ²¡æœ‰é”™è¯¯
- æ‰€æœ‰åŠŸèƒ½è·¯å¾„éƒ½è¢«è§¦å‘å¹¶æœ‰æ—¥å¿—è®°å½•
- æ—¥å¿—è¾“å‡ºæ¸…æ™°ã€å®Œæ•´ã€æ˜“äºè°ƒè¯•

### 2. æ–‡æ¡£ç¼–å†™åŸåˆ™

#### ä»»åŠ¡æ–‡æ¡£
```markdown
âœ… å¥½çš„ä»»åŠ¡æ–‡æ¡£ï¼š
- ç›®æ ‡æ¸…æ™°ï¼ˆ1-2 å¥è¯ï¼‰
- è¾“å…¥æ˜ç¡®ï¼ˆå…·ä½“æ–‡ä»¶å’Œè¡Œå·ï¼‰
- è¦æ±‚å…·ä½“ï¼ˆå¯é‡åŒ–çš„æ ‡å‡†ï¼‰
- çº¦æŸæ˜ç¡®ï¼ˆå…¼å®¹æ€§ã€æ€§èƒ½ç­‰ï¼‰

âŒ å·®çš„ä»»åŠ¡æ–‡æ¡£ï¼š
- ç›®æ ‡æ¨¡ç³Šï¼ˆ"ä¼˜åŒ–ç³»ç»Ÿ"ï¼‰
- è¾“å…¥ä¸æ˜ï¼ˆ"ç›¸å…³ä»£ç "ï¼‰
- è¦æ±‚ç¬¼ç»Ÿï¼ˆ"å°½å¯èƒ½å¥½"ï¼‰
- æ— çº¦æŸï¼ˆå¯¼è‡´ä¸å…¼å®¹æ”¹åŠ¨ï¼‰
```

#### è¾“å‡ºæ–‡æ¡£
```markdown
âœ… å¥½çš„è¾“å‡ºæ–‡æ¡£ï¼š
- åŒ…å«å®Œæ•´ä»£ç æˆ–å…³é”®æ”¹åŠ¨
- æµ‹è¯•ç»“æœæ¸…æ™°
- ä½¿ç”¨ç¤ºä¾‹å®Œæ•´
- åç»­å»ºè®®å…·ä½“

âŒ å·®çš„è¾“å‡ºæ–‡æ¡£ï¼š
- åªæœ‰ä»£ç ï¼Œæ— è¯´æ˜
- æ— æµ‹è¯•ç»“æœ
- æ— ä½¿ç”¨ç¤ºä¾‹
- æ— åç»­å»ºè®®
```

### 3. Subagent è§’è‰²è®¾è®¡

#### ä¸“ä¸šåŒ–åŸåˆ™
æ¯ä¸ª Subagent åº”è¯¥ï¼š
- æœ‰æ˜ç¡®çš„ä¸“é•¿é¢†åŸŸ
- å·¥ä½œèŒƒå›´æ¸…æ™°ï¼ˆç‰¹å®šç›®å½•/æ¨¡å—ï¼‰
- ä¸é‡å èŒè´£

#### ç¤ºä¾‹
```
âœ… å¥½çš„è§’è‰²åˆ†å·¥ï¼š
- Data Integration Expert: ä¸“æ³¨ DEX æ•°æ®è·å–
- Risk Management Expert: ä¸“æ³¨é£é™©æ§åˆ¶é€»è¾‘
- Transaction Expert: ä¸“æ³¨äº¤æ˜“æ‰§è¡Œ

âŒ å·®çš„è§’è‰²åˆ†å·¥ï¼š
- General Developer: ä»€ä¹ˆéƒ½åš
- Backend Expert: èŒƒå›´è¿‡å¤§
- Helper: èŒè´£ä¸æ˜
```

### 4. Controller å†³ç­–åŸåˆ™

#### ä½¿ç”¨ Sequential Thinking
```
æ€è€ƒ 1ï¼šåˆ†æå½“å‰çŠ¶æ€
æ€è€ƒ 2ï¼šè¯†åˆ«å¯å¹¶å‘ä»»åŠ¡
æ€è€ƒ 3ï¼šæ£€æŸ¥ä¾èµ–å…³ç³»
æ€è€ƒ 4ï¼šè¯„ä¼°é£é™©
æ€è€ƒ 5ï¼šå†³å®šæ‰§è¡Œé¡ºåº
```

#### è´¨é‡æ£€æŸ¥
- æ¯ä¸ª Phase ç»“æŸåï¼Œå®¡æŸ¥æ‰€æœ‰è¾“å‡º
- è¿è¡Œé›†æˆæµ‹è¯•
- æ›´æ–°çŸ¥è¯†åº“

### 5. Token é¢„ç®—ç›‘æ§

#### é¢„é˜²æ€§æªæ–½
```
1. åˆ›å»ºä»»åŠ¡æ—¶ä¼°ç®— token
2. é™åˆ¶æ–‡ä»¶æ•°é‡ï¼ˆ1-2 ä¸ªï¼‰
3. é™åˆ¶æ–‡ä»¶å¤§å°ï¼ˆ200-300 è¡Œï¼‰
4. ä½¿ç”¨æ–‡æ¡£å¼•ç”¨è€Œéå¤åˆ¶ä»£ç 
```

#### åº”å¯¹è¶…é¢„ç®—
```
å¦‚æœä»»åŠ¡é¢„è®¡ >40k tokensï¼š
  â†’ æ‹†åˆ†ä¸º 2-3 ä¸ªå°ä»»åŠ¡
  â†’ ä½¿ç”¨æ›´ç²¾ç»†çš„æ–‡ä»¶èŒƒå›´
  â†’ å‡å°‘èƒŒæ™¯ä¿¡æ¯
```

---

## TDD ä¸ Subagent æ–¹æ³•è®ºæ•´åˆ

### æ•´åˆä¼˜åŠ¿

å°† TDD å·¥ä½œæµç¨‹ä¸ Subagent å¹¶å‘å¼€å‘ç›¸ç»“åˆï¼Œå¯ä»¥è·å¾—ä»¥ä¸‹ä¼˜åŠ¿ï¼š

1. **è´¨é‡ä¿è¯**ï¼šTDD ç¡®ä¿æ¯ä¸ªåŠŸèƒ½éƒ½æœ‰æµ‹è¯•è¦†ç›–
2. **å¹¶å‘å¼€å‘**ï¼šå¤šä¸ªåŠŸèƒ½çš„ TDD å¾ªç¯å¯ä»¥å¹¶å‘è¿›è¡Œ
3. **æ¸è¿›å¼äº¤ä»˜**ï¼šæ¯ä¸ª TDD å¾ªç¯éƒ½æ˜¯ä¸€ä¸ªå¯äº¤ä»˜çš„å¢é‡
4. **æ–‡æ¡£åŒ–**ï¼šæ¯ä¸ªé˜¶æ®µéƒ½æœ‰è¯¦ç»†çš„æ–‡æ¡£è®°å½•

### å®é™…å·¥ä½œæµç¨‹

#### åœºæ™¯ï¼šå®ç° 4 ä¸ªç‹¬ç«‹çš„æ•°æ®è·å–åŠŸèƒ½

```
Controller åˆ†æå’Œè§„åˆ’
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚        â”‚        â”‚
åŠŸèƒ½ A            åŠŸèƒ½ B   åŠŸèƒ½ C   åŠŸèƒ½ D
Raydiumä»·æ ¼      Orcaä»·æ ¼  ç›‘æ§    Shadowæ¨¡å¼
â”‚                 â”‚        â”‚        â”‚
â”œâ”€ RED ğŸ”´        â”œâ”€ RED    â”œâ”€ RED   â”œâ”€ RED
â”‚  â†“             â”‚  â†“      â”‚  â†“     â”‚  â†“
â”œâ”€ GREEN ğŸŸ¢      â”œâ”€ GREEN  â”œâ”€ GREEN â”œâ”€ GREEN
â”‚  â†“             â”‚  â†“      â”‚  â†“     â”‚  â†“
â””â”€ REFACTOR ğŸ”§   â””â”€ REFAC  â””â”€ REFAC â””â”€ REFAC
         â”‚                 â”‚        â”‚        â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
         Controller æ•´åˆå’ŒéªŒè¯
```

#### å¹¶å‘æ‰§è¡Œç­–ç•¥

**ç¬¬ä¸€è½®ï¼šRED é˜¶æ®µå¹¶å‘**

Controller åˆ›å»º 4 ä¸ª RED ä»»åŠ¡æ–‡æ¡£ï¼Œå¹¶å‘å¯åŠ¨ 4 ä¸ª TDD Red-Phase Specialistï¼š

```markdown
ä»»åŠ¡ 1a: Raydium ä»·æ ¼è·å– - RED
ä»»åŠ¡ 1b: Orca ä»·æ ¼è·å– - RED
ä»»åŠ¡ 1c: ç›‘æ§æ¡†æ¶ - RED
ä»»åŠ¡ 1d: Shadow æ¨¡å¼æ‰§è¡Œå™¨ - RED

å¹¶å‘æ‰§è¡Œï¼š4 Ã— 23k tokens = 92k tokens
```

æ‰€æœ‰ Subagent å®Œæˆåï¼ŒController æ”¶é›†è¾“å‡ºï¼š
- 4 ä¸ªæµ‹è¯•æ–‡ä»¶
- 4 ä¸ª RED é˜¶æ®µè¾“å‡ºæ–‡æ¡£
- æ‰€æœ‰æµ‹è¯•éƒ½æ˜¯å¤±è´¥çŠ¶æ€ï¼ˆç¬¦åˆé¢„æœŸï¼‰

**ç¬¬äºŒè½®ï¼šGREEN é˜¶æ®µå¹¶å‘**

Controller åˆ›å»º 4 ä¸ª GREEN ä»»åŠ¡æ–‡æ¡£ï¼Œå¹¶å‘å¯åŠ¨ 4 ä¸ª TDD Green-Phase Developerï¼š

```markdown
ä»»åŠ¡ 1a: Raydium ä»·æ ¼è·å– - GREEN
ä»»åŠ¡ 1b: Orca ä»·æ ¼è·å– - GREEN
ä»»åŠ¡ 1c: ç›‘æ§æ¡†æ¶ - GREEN
ä»»åŠ¡ 1d: Shadow æ¨¡å¼æ‰§è¡Œå™¨ - GREEN

å¹¶å‘æ‰§è¡Œï¼š4 Ã— 23k tokens = 92k tokens
```

æ‰€æœ‰ Subagent å®Œæˆåï¼ŒController æ”¶é›†è¾“å‡ºï¼š
- 4 ä¸ªå®ç°æ–‡ä»¶
- 4 ä¸ª GREEN é˜¶æ®µè¾“å‡ºæ–‡æ¡£
- æ‰€æœ‰æµ‹è¯•éƒ½é€šè¿‡ï¼ˆç»¿è‰²çŠ¶æ€ï¼‰

**ç¬¬ä¸‰è½®ï¼šREFACTOR é˜¶æ®µå¹¶å‘**

Controller åˆ›å»º 4 ä¸ª REFACTOR ä»»åŠ¡æ–‡æ¡£ï¼Œå¹¶å‘å¯åŠ¨ 4 ä¸ª TDD Refactor Specialistï¼š

```markdown
ä»»åŠ¡ 1a: Raydium ä»·æ ¼è·å– - REFACTOR
ä»»åŠ¡ 1b: Orca ä»·æ ¼è·å– - REFACTOR
ä»»åŠ¡ 1c: ç›‘æ§æ¡†æ¶ - REFACTOR
ä»»åŠ¡ 1d: Shadow æ¨¡å¼æ‰§è¡Œå™¨ - REFACTOR

å¹¶å‘æ‰§è¡Œï¼š4 Ã— 23k tokens = 92k tokens
```

æ‰€æœ‰ Subagent å®Œæˆåï¼ŒController æ”¶é›†è¾“å‡ºï¼š
- 4 ä¸ªä¼˜åŒ–åçš„å®ç°æ–‡ä»¶
- 4 ä¸ª REFACTOR é˜¶æ®µè¾“å‡ºæ–‡æ¡£
- æ‰€æœ‰æµ‹è¯•ä¾ç„¶é€šè¿‡ï¼Œä»£ç è´¨é‡æå‡

### TDD ä»»åŠ¡æ–‡æ¡£å®Œæ•´ç¤ºä¾‹

```markdown
# Task Group 1: Raydium ä»·æ ¼è·å–åŠŸèƒ½ - TDD å®Œæ•´å¾ªç¯

## Task 1a-RED: Raydium ä»·æ ¼è·å– - ç¼–å†™æµ‹è¯•

### Role
TDD Red-Phase Specialist

### Objective
ä¸º Raydium mainnet ä»·æ ¼è·å–åŠŸèƒ½ç¼–å†™å¤±è´¥çš„æµ‹è¯•ç”¨ä¾‹

### Context
- å½“å‰ç³»ç»Ÿä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®
- éœ€è¦é›†æˆçœŸå®çš„ Raydium SDK
- æ”¯æŒå¸¸è§ä»£å¸å¯¹ï¼ˆSOL/USDC, SOL/USDT ç­‰ï¼‰

### Requirements
1. æµ‹è¯•æ­£å¸¸æƒ…å†µï¼šæˆåŠŸè·å–ä»·æ ¼
2. æµ‹è¯•è¾¹ç•Œæƒ…å†µï¼šæ— æ•ˆä»£å¸å¯¹ã€ç©ºå€¼å¤„ç†
3. æµ‹è¯•å¼‚å¸¸æƒ…å†µï¼šç½‘ç»œå¤±è´¥ã€é‡è¯•æœºåˆ¶
4. æµ‹è¯•æ€§èƒ½ï¼šå»¶è¿Ÿåº” <500ms
5. æµ‹è¯•ç¼“å­˜ï¼šç›¸åŒè¯·æ±‚åº”ä½¿ç”¨ç¼“å­˜

### Output Location
docs/outputs/tdd/phase1/raydium-red.md

### Success Criteria
- [ ] è‡³å°‘ 5 ä¸ªæµ‹è¯•ç”¨ä¾‹
- [ ] è¦†ç›–æ­£å¸¸ã€è¾¹ç•Œã€å¼‚å¸¸åœºæ™¯
- [ ] æ‰€æœ‰æµ‹è¯•å¤±è´¥ï¼ˆåŠŸèƒ½æœªå®ç°ï¼‰
- [ ] æµ‹è¯•ä»£ç æ¸…æ™°å¯è¯»

---

## Task 1a-GREEN: Raydium ä»·æ ¼è·å– - å®ç°åŠŸèƒ½

### Role
TDD Green-Phase Developer

### Objective
å®ç° Raydium ä»·æ ¼è·å–åŠŸèƒ½ï¼Œè®©æ‰€æœ‰æµ‹è¯•é€šè¿‡

### Input
- æµ‹è¯•æ–‡ä»¶ï¼štests/raydium-price-fetcher.test.ts
- RED é˜¶æ®µè¾“å‡ºï¼šdocs/outputs/tdd/phase1/raydium-red.md

### Requirements
1. è®©æ‰€æœ‰æµ‹è¯•ä»çº¢è‰²å˜ä¸ºç»¿è‰²
2. ä½¿ç”¨æœ€ç®€å•çš„å®ç°æ–¹å¼
3. å…è®¸ç¡¬ç¼–ç å’Œä¸´æ—¶æ–¹æ¡ˆ
4. ä¸è¿½æ±‚å®Œç¾è®¾è®¡

### Output Location
docs/outputs/tdd/phase1/raydium-green.md

### Success Criteria
- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡
- [ ] ä»£ç ç®€å•ç›´æ¥
- [ ] æ»¡è¶³æ‰€æœ‰åŠŸèƒ½è¦æ±‚

---

## Task 1a-REFACTOR: Raydium ä»·æ ¼è·å– - ä¼˜åŒ–ä»£ç 

### Role
TDD Refactor Specialist

### Objective
ä¼˜åŒ–ä»£ç è´¨é‡ï¼Œä¿æŒæµ‹è¯•é€šè¿‡

### Input
- GREEN é˜¶æ®µè¾“å‡ºï¼šdocs/outputs/tdd/phase1/raydium-green.md
- å®ç°æ–‡ä»¶ï¼šsrc/raydium-price-fetcher.ts
- æµ‹è¯•æ–‡ä»¶ï¼štests/raydium-price-fetcher.test.ts

### Requirements
1. æ¶ˆé™¤é‡å¤ä»£ç 
2. æå–æ–¹æ³•ï¼Œæå‡å¯è¯»æ€§
3. åº”ç”¨è®¾è®¡æ¨¡å¼ï¼ˆå¦‚éœ€è¦ï¼‰
4. ä¼˜åŒ–æ€§èƒ½
5. ç¡®ä¿æ‰€æœ‰æµ‹è¯•ä¾ç„¶é€šè¿‡

### Output Location
docs/outputs/tdd/phase1/raydium-refactor.md

### Success Criteria
- [ ] ä»£ç è´¨é‡æå‡
- [ ] æ— é‡å¤ä»£ç 
- [ ] æ–¹æ³•å¹³å‡é•¿åº¦ <15 è¡Œ
- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡
- [ ] æµ‹è¯•è¦†ç›–ç‡ â‰¥90%
```

### Token ä½¿ç”¨ä¼˜åŒ–

é€šè¿‡ TDD ä¸‰é˜¶æ®µæ–¹æ³•ï¼Œæ¯ä¸ªåŠŸèƒ½çš„ token ä½¿ç”¨å¦‚ä¸‹ï¼š

```
RED é˜¶æ®µ:    ~23k tokens (æµ‹è¯•ç¼–å†™)
GREEN é˜¶æ®µ:  ~23k tokens (åŠŸèƒ½å®ç°)
REFACTOR é˜¶æ®µ: ~23k tokens (ä»£ç ä¼˜åŒ–)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ€»è®¡:        ~69k tokens (å•ä¸ªåŠŸèƒ½å®Œæ•´ TDD å¾ªç¯)
```

**å¹¶å‘æ‰§è¡Œ 4 ä¸ªåŠŸèƒ½**ï¼š
- RED é˜¶æ®µå¹¶å‘ï¼š   4 Ã— 23k = 92k tokens
- GREEN é˜¶æ®µå¹¶å‘ï¼š 4 Ã— 23k = 92k tokens
- REFACTOR é˜¶æ®µå¹¶å‘ï¼š4 Ã— 23k = 92k tokens

**æ€»è®¡**ï¼šçº¦ 276k tokensï¼Œåˆ† 3 è½®æ‰§è¡Œ

**ä¸²è¡Œæ‰§è¡Œå¯¹æ¯”**ï¼š
- å¦‚æœä¸²è¡Œæ‰§è¡Œï¼Œéœ€è¦ 12 æ¬¡ä»»åŠ¡ï¼ˆ4 åŠŸèƒ½ Ã— 3 é˜¶æ®µï¼‰
- æ—¶é—´æ¶ˆè€—ï¼š12 æ¬¡äº¤äº’
- å¹¶å‘æ‰§è¡Œåªéœ€ 3 æ¬¡äº¤äº’ï¼ˆæ¯ä¸ªé˜¶æ®µä¸€æ¬¡ï¼‰

**æ•ˆç‡æå‡**ï¼š**4 å€**ï¼ˆ12 æ¬¡ â†’ 3 æ¬¡ï¼‰

### å®é™…åº”ç”¨å»ºè®®

#### ä½•æ—¶ä½¿ç”¨ TDD + Subagent

**âœ… æ¨èåœºæ™¯**ï¼š
1. **æ–°åŠŸèƒ½å¼€å‘**ï¼šéœ€æ±‚æ˜ç¡®ï¼Œå¯ä»¥å…ˆå†™æµ‹è¯•
2. **Bug ä¿®å¤**ï¼šå…ˆå†™å¤ç° bug çš„æµ‹è¯•ï¼Œå†ä¿®å¤
3. **é‡æ„ä¼˜åŒ–**ï¼šå·²æœ‰æµ‹è¯•ä¿æŠ¤ï¼Œæ”¾å¿ƒé‡æ„
4. **API å¼€å‘**ï¼šæ¥å£è®¾è®¡å…ˆè¡Œï¼ŒTDD æœ€åˆé€‚
5. **å…³é”®æ¨¡å—**ï¼šé£é™©ç®¡ç†ã€äº¤æ˜“æ‰§è¡Œç­‰æ ¸å¿ƒåŠŸèƒ½

**âŒ ä¸æ¨èåœºæ™¯**ï¼š
1. **æ¢ç´¢æ€§å¼€å‘**ï¼šéœ€æ±‚ä¸æ˜ç¡®ï¼Œéš¾ä»¥å…ˆå†™æµ‹è¯•
2. **å¿«é€ŸåŸå‹**ï¼šéªŒè¯æƒ³æ³•é˜¶æ®µï¼Œæµ‹è¯•æˆæœ¬é«˜
3. **ç®€å•è„šæœ¬**ï¼šä¸€æ¬¡æ€§ä»»åŠ¡ï¼Œæ— éœ€æµ‹è¯•
4. **UI è°ƒæ•´**ï¼šè§†è§‰æ•ˆæœéš¾ä»¥è‡ªåŠ¨åŒ–æµ‹è¯•

#### æ··åˆæ¨¡å¼

å¯¹äºå¤æ‚é¡¹ç›®ï¼Œå¯ä»¥æ··åˆä½¿ç”¨ï¼š

```
æ ¸å¿ƒåŠŸèƒ½ï¼ˆæ•°æ®é›†æˆã€é£é™©æ§åˆ¶ï¼‰
  â†’ ä½¿ç”¨ TDD + Subagentï¼ˆé«˜è´¨é‡ï¼Œæœ‰æµ‹è¯•ï¼‰

è¾…åŠ©åŠŸèƒ½ï¼ˆæ—¥å¿—ã€é…ç½®ï¼‰
  â†’ ä½¿ç”¨ä¼ ç»Ÿ Subagentï¼ˆå¿«é€Ÿå®ç°ï¼‰

åŸå‹éªŒè¯ï¼ˆæ–°ç­–ç•¥å°è¯•ï¼‰
  â†’ å¿«é€Ÿå¼€å‘ï¼ŒéªŒè¯åå† TDD é‡å†™
```

### è¿›åº¦è·Ÿè¸ªç¤ºä¾‹

```markdown
# Phase 1: Shadow Mode - TDD è¿›åº¦

## åŠŸèƒ½ A: Raydium ä»·æ ¼è·å–
- âœ… RED é˜¶æ®µå®Œæˆï¼ˆ2025-10-02 10:00ï¼‰
- âœ… GREEN é˜¶æ®µå®Œæˆï¼ˆ2025-10-02 10:30ï¼‰
- âœ… REFACTOR é˜¶æ®µå®Œæˆï¼ˆ2025-10-02 11:00ï¼‰
- ğŸ“„ è¾“å‡ºæ–‡æ¡£ï¼š
  - docs/outputs/tdd/phase1/raydium-red.md
  - docs/outputs/tdd/phase1/raydium-green.md
  - docs/outputs/tdd/phase1/raydium-refactor.md

## åŠŸèƒ½ B: Orca ä»·æ ¼è·å–
- âœ… RED é˜¶æ®µå®Œæˆ
- âœ… GREEN é˜¶æ®µå®Œæˆ
- ğŸ”„ REFACTOR é˜¶æ®µè¿›è¡Œä¸­

## åŠŸèƒ½ C: ç›‘æ§æ¡†æ¶
- âœ… RED é˜¶æ®µå®Œæˆ
- ğŸ”„ GREEN é˜¶æ®µè¿›è¡Œä¸­
- ğŸ“… REFACTOR é˜¶æ®µå¾…å¼€å§‹

## åŠŸèƒ½ D: Shadow æ¨¡å¼æ‰§è¡Œå™¨
- ğŸ”„ RED é˜¶æ®µè¿›è¡Œä¸­
- ğŸ“… GREEN é˜¶æ®µå¾…å¼€å§‹
- ğŸ“… REFACTOR é˜¶æ®µå¾…å¼€å§‹

## æ€»ä½“è¿›åº¦
- å·²å®Œæˆï¼š5/12 ä»»åŠ¡ï¼ˆ42%ï¼‰
- è¿›è¡Œä¸­ï¼š2/12 ä»»åŠ¡
- å¾…å¼€å§‹ï¼š5/12 ä»»åŠ¡
```

---

## å®é™…åº”ç”¨ç¤ºä¾‹

### æ¡ˆä¾‹ï¼šç”¨æˆ·è®¤è¯ API å®ç°ï¼ˆä½¿ç”¨ TDD æ–¹æ³•ï¼‰

#### Step 1: åˆ›å»ºä»»åŠ¡æ–‡æ¡£
```markdown
# Task 1a: ç”¨æˆ·è®¤è¯ API ç«¯ç‚¹

## Role
Backend Architect

## Objective
å®ç°ç”¨æˆ·ç™»å½•å’Œæ³¨å†Œçš„ RESTful API ç«¯ç‚¹ï¼ŒåŒ…æ‹¬ JWT è®¤è¯

## Context
- æ–°å»ºé¡¹ç›®ï¼Œå°šæ— è®¤è¯ç³»ç»Ÿ
- ä½¿ç”¨ Express.js + TypeScript
- æ•°æ®åº“ä½¿ç”¨ PostgreSQL + Prisma ORM

## Input Files
- src/api/routes/ (æ–°å»º)
- src/services/auth/ (æ–°å»º)
- prisma/schema.prisma (éœ€è¦åˆ›å»º User model)

## Requirements
1. å®ç° POST /api/auth/register æ³¨å†Œç«¯ç‚¹
2. å®ç° POST /api/auth/login ç™»å½•ç«¯ç‚¹
3. å¯†ç ä½¿ç”¨ bcrypt åŠ å¯†
4. è¿”å› JWT tokenï¼ˆ24å°æ—¶æœ‰æ•ˆæœŸï¼‰
5. æ·»åŠ è¾“å…¥éªŒè¯ï¼ˆemail æ ¼å¼ã€å¯†ç å¼ºåº¦ï¼‰
6. æ·»åŠ é”™è¯¯å¤„ç†ï¼ˆç”¨æˆ·å·²å­˜åœ¨ã€å¯†ç é”™è¯¯ç­‰ï¼‰

## Constraints
- ä¸ä¿®æ”¹å…¶ä»–æ¨¡å—
- ä¿æŒ RESTful è§„èŒƒ
- API å“åº”æ—¶é—´ <200ms

## Output Location
docs/outputs/phase1/output-1a-auth-api-implementation.md

## Token Budget
é¢„è®¡ï¼š25k tokens

## Success Criteria
- [ ] æ³¨å†Œæ¥å£æ­£å¸¸å·¥ä½œ
- [ ] ç™»å½•è¿”å›æœ‰æ•ˆ JWT
- [ ] æ‰€æœ‰è¾¹ç•Œæ¡ä»¶æœ‰é”™è¯¯å¤„ç†
- [ ] å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•é€šè¿‡
```

#### Step 2: å¯åŠ¨ Subagent
Controller ä½¿ç”¨ Task toolï¼š
```
è¯·æ‰§è¡Œä»¥ä¸‹ä»»åŠ¡ï¼š

ä½ æ˜¯ Backend Architectï¼Œä¸“ç²¾ RESTful API è®¾è®¡å’Œè®¤è¯ç³»ç»Ÿã€‚

1. è¯»å–ä»»åŠ¡æ–‡æ¡£ï¼šdocs/tasks/phase1/task-1a-user-auth-api.md
2. æŒ‰ç…§è¦æ±‚å®ç°åŠŸèƒ½
3. ç¼–å†™æµ‹è¯•ç”¨ä¾‹
4. å°†ç»“æœå†™å…¥ï¼šdocs/outputs/phase1/output-1a-auth-api-implementation.md

ç¡®ä¿ä»£ç ç®€æ´ã€å¯ç»´æŠ¤ï¼Œå¹¶åŒ…å«å¿…è¦çš„æ³¨é‡Šã€‚
```

#### Step 3: Subagent è¾“å‡º
```markdown
# Output 1a: ç”¨æˆ·è®¤è¯ API - å®ç°æŠ¥å‘Š

## Status
âœ… å·²å®Œæˆ

## Modified Files
- src/api/routes/auth.routes.ts (æ–°å»º)
- src/services/auth/auth.service.ts (æ–°å»º)
- src/middleware/validation.middleware.ts (æ–°å»º)
- prisma/schema.prisma (æ›´æ–°)

## Implementation

### æ ¸å¿ƒæ”¹åŠ¨
```typescript
// src/services/auth/auth.service.ts
import { hash, compare } from 'bcrypt';
import { sign } from 'jsonwebtoken';
import { PrismaClient } from '@prisma/client';

export class AuthService {
  private prisma = new PrismaClient();
  private jwtSecret = process.env.JWT_SECRET!;

  async register(email: string, password: string) {
    // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²å­˜åœ¨
    const existing = await this.prisma.user.findUnique({ where: { email } });
    if (existing) {
      throw new Error('User already exists');
    }

    // å¯†ç åŠ å¯†
    const passwordHash = await hash(password, 10);

    // åˆ›å»ºç”¨æˆ·
    const user = await this.prisma.user.create({
      data: { email, passwordHash }
    });

    return {
      token: this.generateToken(user),
      user: { id: user.id, email: user.email }
    };
  }

  async login(email: string, password: string) {
    const user = await this.prisma.user.findUnique({ where: { email } });
    if (!user) {
      throw new Error('Invalid credentials');
    }

    const isValid = await compare(password, user.passwordHash);
    if (!isValid) {
      throw new Error('Invalid credentials');
    }

    return {
      token: this.generateToken(user),
      user: { id: user.id, email: user.email }
    };
  }

  private generateToken(user: any) {
    return sign(
      { userId: user.id, email: user.email },
      this.jwtSecret,
      { expiresIn: '24h' }
    );
  }
}

    } catch (error) {
      attempt++;
      if (attempt >= maxRetries) {
        console.error(`Failed to fetch Raydium price after ${maxRetries} attempts:`, error);
        return null;
      }
      // æŒ‡æ•°é€€é¿
      await this.sleep(Math.pow(2, attempt) * 1000);
    }
  }

  return null;
}

private async getRaydiumPool(tokenA: string, tokenB: string) {
  // å®ç°æ± å­æŸ¥è¯¢é€»è¾‘
  // ...
}
```

### è®¾è®¡å†³ç­–
- **é‡è¯•æœºåˆ¶**ï¼šä½¿ç”¨æŒ‡æ•°é€€é¿ï¼ˆ1s, 2s, 4sï¼‰é¿å…é¢‘ç¹è¯·æ±‚
- **é”™è¯¯å¤„ç†**ï¼šè¿”å› null è€ŒéæŠ›å‡ºå¼‚å¸¸ï¼Œä¿æŒä¸åŸæ¥å£å…¼å®¹
- **ç¼“å­˜å‹å¥½**ï¼šä¸åœ¨å‡½æ•°å†…éƒ¨ç¼“å­˜ï¼Œç”±ä¸Šå±‚ retrievePriceData å¤„ç†

## Testing

### å•å…ƒæµ‹è¯•
```typescript
describe('fetchRaydiumPrice', () => {
  it('should fetch SOL/USDC price', async () => {
    const price = await rag.fetchRaydiumPrice('SOL/USDC');
    expect(price).toBeDefined();
    expect(price.source).toBe('raydium');
    expect(price.price).toBeGreaterThan(0);
  });

  it('should handle invalid token pair', async () => {
    const price = await rag.fetchRaydiumPrice('INVALID/PAIR');
    expect(price).toBeNull();
  });

  it('should retry on network error', async () => {
    // Mock network failure then success
    // ...
  });
});
```

### æµ‹è¯•ç»“æœ
- âœ… SOL/USDC ä»·æ ¼è·å–æˆåŠŸï¼š$142.35
- âœ… SOL/USDT ä»·æ ¼è·å–æˆåŠŸï¼š$142.28
- âœ… æ— æ•ˆä»£å¸å¯¹æ­£ç¡®è¿”å› null
- âœ… é‡è¯•æœºåˆ¶éªŒè¯é€šè¿‡
- â±ï¸ å¹³å‡å»¶è¿Ÿï¼š187msï¼ˆç¬¦åˆ <500ms è¦æ±‚ï¼‰

## Usage

### åŸºæœ¬ç”¨æ³•
```typescript
const rag = new MarketDataRAG(process.env.SOLANA_RPC_URL!);
const price = await rag.fetchRaydiumPrice('SOL/USDC');
console.log(price?.price); // 142.35
```

## Dependencies
- å·²æœ‰ï¼š@raydium-io/raydium-sdk@1.3.1-beta.58 âœ…
- å·²æœ‰ï¼š@solana/web3.js@1.98.4 âœ…

## Next Steps
- å»ºè®®ï¼šæ·»åŠ å¯¹æ›´å¤šä»£å¸å¯¹çš„æ”¯æŒï¼ˆå½“å‰åªæ”¯æŒä¸»æµä»£å¸ï¼‰
- å»ºè®®ï¼šè€ƒè™‘ä½¿ç”¨ WebSocket è®¢é˜…å®æ—¶ä»·æ ¼æ›´æ–°
- å»ºè®®ï¼šæ·»åŠ ä»·æ ¼åˆç†æ€§æ£€æŸ¥ï¼ˆé˜²æ­¢å¼‚å¸¸æ•°æ®ï¼‰

## Issues & Limitations
- å½“å‰ä¾èµ– Raydium SDK çš„ APIï¼Œå¦‚æœ SDK æ›´æ–°å¯èƒ½éœ€è¦è°ƒæ•´
- æŸäº›å°ä¼—ä»£å¸å¯¹å¯èƒ½æ²¡æœ‰å¯¹åº”çš„ pool

## Token Usage
å®é™…ä½¿ç”¨ï¼š23k tokens (é¢„ç®—ï¼š25k tokens) âœ…
```

#### Step 4: Controller æ•´åˆ
Controller è¯»å–è¾“å‡ºæ–‡æ¡£ï¼Œä½¿ç”¨ Sequential Thinking åˆ†æï¼š
```
æ€è€ƒ 1ï¼šä»»åŠ¡å®Œæˆè´¨é‡å¦‚ä½•ï¼Ÿ
  â†’ ä»£ç å®ç°å®Œæ•´ï¼Œæµ‹è¯•å……åˆ†ï¼Œå»¶è¿Ÿç¬¦åˆè¦æ±‚

æ€è€ƒ 2ï¼šæ˜¯å¦æœ‰éœ€è¦æ”¹è¿›çš„åœ°æ–¹ï¼Ÿ
  â†’ å»ºè®®ä¸­æåˆ°çš„ WebSocket è®¢é˜…å¯ä»¥ä½œä¸ºåç»­ä¼˜åŒ–ä»»åŠ¡

æ€è€ƒ 3ï¼šæ˜¯å¦å¯ä»¥å¯åŠ¨ä¸‹ä¸€ä¸ªä»»åŠ¡ï¼Ÿ
  â†’ å¯ä»¥ï¼ŒTask 1b (Orca) ä¸ Task 1a ç‹¬ç«‹ï¼Œå¯å¹¶å‘æ‰§è¡Œ

æ€è€ƒ 4ï¼šæ˜¯å¦éœ€è¦åˆ›å»ºæ–°ä»»åŠ¡ï¼Ÿ
  â†’ å¯ä»¥å°†"WebSocket å®æ—¶è®¢é˜…"ä½œä¸º Phase 2 çš„ä¼˜åŒ–ä»»åŠ¡

å†³ç­–ï¼š
  âœ… Task 1a æˆåŠŸå®Œæˆ
  âœ… å¯ä»¥å¹¶å‘å¯åŠ¨ Task 1b, 1c, 1d
  ğŸ“ è®°å½•å»ºè®®åˆ°çŸ¥è¯†åº“
```

---

---

## ğŸ¯ ä½¿ç”¨æœ¬æ¨¡æ¿çš„æ­¥éª¤

æœ¬æ–‡æ¡£æ˜¯ä¸€ä¸ª**é€šç”¨ Web é¡¹ç›®å¼€å‘æ–¹æ³•è®ºæ¨¡æ¿**ã€‚è¦å°†å…¶åº”ç”¨åˆ°ä½ çš„å…·ä½“é¡¹ç›®ï¼Œè¯·æŒ‰ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š

### 1. å®šä¹‰é¡¹ç›®ç‰¹å®šçš„ Subagent è§’è‰²

æ ¹æ®ä½ çš„æŠ€æœ¯æ ˆå’Œé¡¹ç›®éœ€æ±‚ï¼Œåœ¨ [Subagent è§’è‰²å®šä¹‰](#subagent-è§’è‰²å®šä¹‰) éƒ¨åˆ†ï¼š

- **ä¿ç•™**ï¼šTDD Red/Green/Refactor Specialistï¼ˆé€šç”¨ï¼‰
- **è°ƒæ•´**ï¼šFrontend/Backend/Database ç­‰è§’è‰²çš„å…·ä½“æŠ€æœ¯æ ˆ
- **æ·»åŠ **ï¼šé¡¹ç›®ç‰¹å®šçš„ä¸“ä¸šè§’è‰²ï¼ˆå¦‚ï¼šæ”¯ä»˜é›†æˆã€æ¨èç®—æ³•ã€å®æ—¶é€šä¿¡ç­‰ï¼‰

**ç¤ºä¾‹**ï¼š
- ç”µå•†é¡¹ç›®ï¼šæ·»åŠ  "Payment Integration Specialist"ã€"Inventory Management Expert"
- SaaS é¡¹ç›®ï¼šæ·»åŠ  "Multi-tenancy Architect"ã€"Billing System Expert"
- å®æ—¶åº”ç”¨ï¼šæ·»åŠ  "WebSocket Engineer"ã€"Message Queue Specialist"

### 2. æ›´æ–°ç›®å½•ç»“æ„

å°† [ç›®å½•ç»“æ„](#ç›®å½•ç»“æ„) ä¸­çš„ç¤ºä¾‹è·¯å¾„æ›¿æ¢ä¸ºä½ çš„é¡¹ç›®ç»“æ„ï¼š

```bash
# æ›¿æ¢è¿™äº›è·¯å¾„ä¸ºä½ çš„å®é™…é¡¹ç›®è·¯å¾„
your-web-project/       â†’ my-ecommerce-app/
src/frontend/           â†’ client/
src/backend/            â†’ server/
```

### 3. æ›¿æ¢ä»£ç ç¤ºä¾‹

æ–‡æ¡£ä¸­çš„ä»£ç ç¤ºä¾‹ï¼ˆç”¨æˆ·è®¤è¯ï¼‰ä»…ä¾›å‚è€ƒï¼Œå°†å…¶æ›¿æ¢ä¸ºä½ çš„å®é™…åŠŸèƒ½éœ€æ±‚ï¼š

- **ç¤ºä¾‹åœºæ™¯**ï¼šç”¨æˆ·è®¤è¯ â†’ ä½ çš„æ ¸å¿ƒåŠŸèƒ½ï¼ˆå¦‚ï¼šå•†å“æœç´¢ã€è®¢å•å¤„ç†ç­‰ï¼‰
- **æŠ€æœ¯æ ˆ**ï¼šExpress.js â†’ ä½ çš„æ¡†æ¶ï¼ˆDjangoã€Spring Bootã€Laravel ç­‰ï¼‰

### 4. è°ƒæ•´ä»»åŠ¡æ¨¡æ¿

æ ¹æ®ä½ çš„å¼€å‘æµç¨‹ï¼Œä¿®æ”¹ [ä»»åŠ¡æ–‡æ¡£æ¨¡æ¿](#ä»»åŠ¡æ–‡æ¡£task-document)ï¼š

- **æ·»åŠ **ï¼šé¡¹ç›®ç‰¹å®šçš„çº¦æŸï¼ˆæ€§èƒ½æŒ‡æ ‡ã€å®‰å…¨è¦æ±‚ç­‰ï¼‰
- **è°ƒæ•´**ï¼šToken é¢„ç®—æ ¹æ®ä»»åŠ¡å¤æ‚åº¦
- **æ›´æ–°**ï¼šSuccess Criteria åŒ¹é…ä½ çš„è´¨é‡æ ‡å‡†

### 5. é…ç½® MCP ç¯å¢ƒ

æŒ‰ç…§ [Phase 0: MCP ç¯å¢ƒå‡†å¤‡](#phase-0-mcp-ç¯å¢ƒå‡†å¤‡) çš„æ­¥éª¤ï¼Œç¡®ä¿ï¼š

- Sequential Thinking MCP æ­£ç¡®å®‰è£…
- é…ç½®æ–‡ä»¶è·¯å¾„æ­£ç¡®
- æµ‹è¯• MCP åŠŸèƒ½æ­£å¸¸

### 6. å¼€å§‹ä½ çš„ç¬¬ä¸€ä¸ªä»»åŠ¡

ä»ä¸€ä¸ªå°åŠŸèƒ½å¼€å§‹ï¼ŒéªŒè¯æ•´ä¸ªæµç¨‹ï¼š

1. åˆ›å»ºä»»åŠ¡æ–‡æ¡£ï¼ˆå‚è€ƒæ¨¡æ¿ï¼‰
2. å¯åŠ¨ Subagent
3. æ”¶é›†è¾“å‡º
4. ä½¿ç”¨ Sequential Thinking åˆ†æ
5. è¿­ä»£æ”¹è¿›

---

## æ€»ç»“

### æ ¸å¿ƒä»·å€¼

è¿™å¥—æ–¹æ³•è®ºçš„æ ¸å¿ƒä»·å€¼åœ¨äºï¼š

1. **å·¥ç¨‹åŒ– AI åä½œ**ï¼šå°† AI è¾…åŠ©å¼€å‘ä»"å¯¹è¯å¼ç¼–ç¨‹"æå‡åˆ°"å·¥ç¨‹åŒ–æµç¨‹"
2. **çŸ¥è¯†èµ„äº§åŒ–**ï¼šæ¯ä¸ªä»»åŠ¡çš„è¾“å‡ºæˆä¸ºå¯å¤ç”¨çš„çŸ¥è¯†èµ„äº§
3. **è§„æ¨¡åŒ–èƒ½åŠ›**ï¼šæ”¯æŒå¤§å‹å¤æ‚é¡¹ç›®çš„ç³»ç»ŸåŒ–å¼€å‘
4. **è´¨é‡å¯æ§**ï¼šé€šè¿‡ä¸“ä¸šåˆ†å·¥å’Œæ–‡æ¡£åŒ–ä¿è¯è´¨é‡

### é€‚ç”¨åœºæ™¯

- âœ… å¤§å‹é¡¹ç›®ï¼ˆ>10 ä¸ªæ¨¡å—ï¼‰
- âœ… å¤æ‚æ¶æ„ï¼ˆå¾®æœåŠ¡ã€å¤šå±‚æ¬¡ï¼‰
- âœ… é•¿æœŸç»´æŠ¤ï¼ˆéœ€è¦çŸ¥è¯†ç§¯ç´¯ï¼‰
- âœ… å›¢é˜Ÿåä½œï¼ˆéœ€è¦æ–‡æ¡£åŒ–ï¼‰

### æœªæ¥å±•æœ›

éšç€ AI èƒ½åŠ›çš„æå‡ï¼Œè¿™å¥—æ–¹æ³•è®ºå¯ä»¥è¿›ä¸€æ­¥æ¼”åŒ–ï¼š

1. **è‡ªåŠ¨åŒ–å·¥ä½œæµ**ï¼šè‡ªåŠ¨ç”Ÿæˆä»»åŠ¡æ–‡æ¡£å’Œè¿›åº¦è·Ÿè¸ª
2. **æ™ºèƒ½ä»»åŠ¡åˆ†è§£**ï¼šAI è‡ªåŠ¨è¯†åˆ«ä¾èµ–å…³ç³»å’Œå¹¶å‘æœºä¼š
3. **è´¨é‡è‡ªåŠ¨æ£€æŸ¥**ï¼šAI è‡ªåŠ¨å®¡æŸ¥ä»£ç è´¨é‡å’Œä¸€è‡´æ€§
4. **çŸ¥è¯†å›¾è°±æ„å»º**ï¼šè‡ªåŠ¨å»ºç«‹ä»»åŠ¡ã€ä»£ç ã€çŸ¥è¯†ä¹‹é—´çš„å…³è”

---

## ğŸ’¼ å¸¸è§ Web é¡¹ç›®åº”ç”¨åœºæ™¯

æœ¬èŠ‚æä¾›ä¸åŒç±»å‹ Web é¡¹ç›®çš„ Subagent è§’è‰²é…ç½®å»ºè®®å’Œä»»åŠ¡åˆ†è§£ç¤ºä¾‹ã€‚

### åœºæ™¯1ï¼šç”µå•†å¹³å° (E-Commerce)

#### æ¨è Subagent é…ç½®

```markdown
æ ¸å¿ƒè§’è‰²ï¼š
- Frontend Developerï¼ˆå•†å“å±•ç¤ºã€è´­ç‰©è½¦UIï¼‰
- Backend Architectï¼ˆè®¢å•APIã€åº“å­˜ç®¡ç†ï¼‰
- Database Architectï¼ˆå•†å“è¡¨ã€è®¢å•è¡¨è®¾è®¡ï¼‰
- Payment Integration Specialistï¼ˆæ”¯ä»˜æµç¨‹ï¼‰
- Search Engineerï¼ˆå•†å“æœç´¢å’Œæ¨èï¼‰
- API Security Auditorï¼ˆæ”¯ä»˜å®‰å…¨å®¡è®¡ï¼‰

ä¸“ä¸šè§’è‰²ï¼š
- Inventory Management Expertï¼ˆåº“å­˜ç³»ç»Ÿï¼‰
- Email Notification Specialistï¼ˆè®¢å•é€šçŸ¥ï¼‰
- Image Optimization Specialistï¼ˆå•†å“å›¾ç‰‡å¤„ç†ï¼‰
```

#### å…¸å‹ä»»åŠ¡æ‹†åˆ†

```markdown
Phase 1: å•†å“ç®¡ç†
- Task 1a: å•†å“æ•°æ®åº“è®¾è®¡ï¼ˆDatabase Architectï¼‰
- Task 1b: å•†å“åˆ—è¡¨APIï¼ˆBackend Architectï¼‰
- Task 1c: å•†å“å±•ç¤ºé¡µé¢ï¼ˆFrontend Developerï¼‰
- Task 1d: å•†å“æœç´¢åŠŸèƒ½ï¼ˆSearch Engineerï¼‰

Phase 2: è´­ç‰©æµç¨‹
- Task 2a: è´­ç‰©è½¦åŠŸèƒ½ï¼ˆFrontend + Backendï¼‰
- Task 2b: è®¢å•åˆ›å»ºAPIï¼ˆBackend Architectï¼‰
- Task 2c: åº“å­˜æ‰£å‡é€»è¾‘ï¼ˆInventory Expertï¼‰

Phase 3: æ”¯ä»˜é›†æˆ
- Task 3a: Stripe æ”¯ä»˜é›†æˆï¼ˆPayment Specialistï¼‰
- Task 3b: æ”¯ä»˜å®‰å…¨å®¡è®¡ï¼ˆSecurity Auditorï¼‰
- Task 3c: è®¢å•çŠ¶æ€åŒæ­¥ï¼ˆBackend Architectï¼‰
```

### åœºæ™¯2ï¼šSaaS ç®¡ç†å¹³å°

#### æ¨è Subagent é…ç½®

```markdown
æ ¸å¿ƒè§’è‰²ï¼š
- Frontend Developerï¼ˆDashboard UIï¼‰
- Backend Architectï¼ˆå¤šç§Ÿæˆ·APIï¼‰
- Database Architectï¼ˆç§Ÿæˆ·éš”ç¦»è®¾è®¡ï¼‰
- Auth & Permission Specialistï¼ˆRBACç³»ç»Ÿï¼‰
- Subscription Billing Specialistï¼ˆè®¢é˜…è®¡è´¹ï¼‰

ä¸“ä¸šè§’è‰²ï¼š
- Multi-tenancy Architectï¼ˆç§Ÿæˆ·æ¶æ„ï¼‰
- Analytics Dashboard Specialistï¼ˆæ•°æ®æŠ¥è¡¨ï¼‰
- Webhook Integration Specialistï¼ˆç¬¬ä¸‰æ–¹é›†æˆï¼‰
```

#### å…¸å‹ä»»åŠ¡æ‹†åˆ†

```markdown
Phase 1: ç§Ÿæˆ·åŸºç¡€
- Task 1a: å¤šç§Ÿæˆ·æ•°æ®éš”ç¦»è®¾è®¡ï¼ˆMulti-tenancy Architectï¼‰
- Task 1b: ç§Ÿæˆ·æ³¨å†Œå’Œè®¤è¯ï¼ˆAuth Specialistï¼‰
- Task 1c: ç§Ÿæˆ·ç®¡ç†åå°ï¼ˆFrontend Developerï¼‰

Phase 2: æƒé™ç³»ç»Ÿ
- Task 2a: RBAC æƒé™æ¨¡å‹è®¾è®¡ï¼ˆAuth Specialistï¼‰
- Task 2b: æƒé™APIå®ç°ï¼ˆBackend Architectï¼‰
- Task 2c: æƒé™ç®¡ç†ç•Œé¢ï¼ˆFrontend Developerï¼‰

Phase 3: è®¢é˜…è®¡è´¹
- Task 3a: è®¢é˜…è®¡åˆ’è®¾è®¡ï¼ˆBilling Specialistï¼‰
- Task 3b: Stripe è®¢é˜…é›†æˆï¼ˆPayment Specialistï¼‰
- Task 3c: ä½¿ç”¨é‡ç»Ÿè®¡ï¼ˆAnalytics Specialistï¼‰
```

### åœºæ™¯3ï¼šç¤¾äº¤/å†…å®¹å¹³å°

#### æ¨è Subagent é…ç½®

```markdown
æ ¸å¿ƒè§’è‰²ï¼š
- Frontend Developerï¼ˆFeedæµã€äº’åŠ¨UIï¼‰
- Backend Architectï¼ˆå†…å®¹APIã€å…³æ³¨ç³»ç»Ÿï¼‰
- Database Architectï¼ˆå›¾å…³ç³»è®¾è®¡ï¼‰
- Real-time Specialistï¼ˆWebSocketã€æ¨é€ï¼‰
- Content Moderation Specialistï¼ˆå†…å®¹å®¡æ ¸ï¼‰

ä¸“ä¸šè§’è‰²ï¼š
- Feed Algorithm Specialistï¼ˆæ¨èç®—æ³•ï¼‰
- Media Processing Specialistï¼ˆå›¾ç‰‡/è§†é¢‘å¤„ç†ï¼‰
- Notification System Specialistï¼ˆé€šçŸ¥ç³»ç»Ÿï¼‰
```

#### å…¸å‹ä»»åŠ¡æ‹†åˆ†

```markdown
Phase 1: ç”¨æˆ·ç¤¾äº¤
- Task 1a: ç”¨æˆ·å…³ç³»æ•°æ®æ¨¡å‹ï¼ˆDatabase Architectï¼‰
- Task 1b: å…³æ³¨/ç²‰ä¸APIï¼ˆBackend Architectï¼‰
- Task 1c: ç”¨æˆ·ä¸»é¡µUIï¼ˆFrontend Developerï¼‰

Phase 2: å†…å®¹å‘å¸ƒ
- Task 2a: å†…å®¹å‘å¸ƒAPIï¼ˆBackend Architectï¼‰
- Task 2b: å›¾ç‰‡ä¸Šä¼ å’Œå¤„ç†ï¼ˆMedia Specialistï¼‰
- Task 2c: å†…å®¹å®¡æ ¸æµç¨‹ï¼ˆModeration Specialistï¼‰

Phase 3: å®æ—¶äº’åŠ¨
- Task 3a: WebSocket æœåŠ¡ï¼ˆReal-time Specialistï¼‰
- Task 3b: å®æ—¶é€šçŸ¥æ¨é€ï¼ˆNotification Specialistï¼‰
- Task 3c: Feed æµç®—æ³•ï¼ˆAlgorithm Specialistï¼‰
```

### åœºæ™¯4ï¼šä¼ä¸šç®¡ç†ç³»ç»Ÿ (ERP/CRM)

#### æ¨è Subagent é…ç½®

```markdown
æ ¸å¿ƒè§’è‰²ï¼š
- Frontend Developerï¼ˆè¡¨å•ã€åˆ—è¡¨UIï¼‰
- Backend Architectï¼ˆä¸šåŠ¡æµç¨‹APIï¼‰
- Database Architectï¼ˆå¤æ‚ä¸šåŠ¡æ¨¡å‹ï¼‰
- Report Generator Specialistï¼ˆæŠ¥è¡¨ç³»ç»Ÿï¼‰
- Workflow Engine Specialistï¼ˆå®¡æ‰¹æµç¨‹ï¼‰

ä¸“ä¸šè§’è‰²ï¼š
- Excel Import/Export Specialistï¼ˆæ•°æ®å¯¼å…¥å¯¼å‡ºï¼‰
- Print Template Designerï¼ˆæ‰“å°æ¨¡æ¿ï¼‰
- Integration Hub Specialistï¼ˆç¬¬ä¸‰æ–¹ç³»ç»Ÿé›†æˆï¼‰
```

#### å…¸å‹ä»»åŠ¡æ‹†åˆ†

```markdown
Phase 1: åŸºç¡€æ•°æ®
- Task 1a: å®¢æˆ·/ä¾›åº”å•†æ•°æ®æ¨¡å‹ï¼ˆDatabase Architectï¼‰
- Task 1b: åŸºç¡€æ•°æ®CRUD APIï¼ˆBackend Architectï¼‰
- Task 1c: æ•°æ®ç®¡ç†ç•Œé¢ï¼ˆFrontend Developerï¼‰

Phase 2: ä¸šåŠ¡æµç¨‹
- Task 2a: å®¡æ‰¹å·¥ä½œæµè®¾è®¡ï¼ˆWorkflow Specialistï¼‰
- Task 2b: è®¢å•ç®¡ç†æµç¨‹ï¼ˆBackend Architectï¼‰
- Task 2c: æµç¨‹çŠ¶æ€ç•Œé¢ï¼ˆFrontend Developerï¼‰

Phase 3: æŠ¥è¡¨åˆ†æ
- Task 3a: æŠ¥è¡¨æ•°æ®æ¨¡å‹ï¼ˆDatabase Architectï¼‰
- Task 3b: æŠ¥è¡¨ç”Ÿæˆå¼•æ“ï¼ˆReport Generatorï¼‰
- Task 3c: å¯è§†åŒ–å›¾è¡¨ï¼ˆFrontend Developerï¼‰
```

### åœºæ™¯5ï¼šå®æ—¶åä½œå·¥å…·

#### æ¨è Subagent é…ç½®

```markdown
æ ¸å¿ƒè§’è‰²ï¼š
- Frontend Developerï¼ˆåä½œUIã€Canvasï¼‰
- Backend Architectï¼ˆåä½œAPIï¼‰
- Database Architectï¼ˆæ–‡æ¡£å­˜å‚¨ï¼‰
- WebSocket Specialistï¼ˆå®æ—¶åŒæ­¥ï¼‰
- CRDT Specialistï¼ˆå†²çªè§£å†³ï¼‰

ä¸“ä¸šè§’è‰²ï¼š
- Document Versioning Specialistï¼ˆç‰ˆæœ¬æ§åˆ¶ï¼‰
- Presence Management Specialistï¼ˆåœ¨çº¿çŠ¶æ€ï¼‰
- Export & Sharing Specialistï¼ˆæ–‡æ¡£åˆ†äº«ï¼‰
```

#### å…¸å‹ä»»åŠ¡æ‹†åˆ†

```markdown
Phase 1: æ–‡æ¡£ç¼–è¾‘
- Task 1a: æ–‡æ¡£æ•°æ®æ¨¡å‹ï¼ˆDatabase Architectï¼‰
- Task 1b: ç¼–è¾‘å™¨UIå®ç°ï¼ˆFrontend Developerï¼‰
- Task 1c: æ–‡æ¡£ä¿å­˜APIï¼ˆBackend Architectï¼‰

Phase 2: å®æ—¶åä½œ
- Task 2a: WebSocket å®æ—¶é€šä¿¡ï¼ˆWebSocket Specialistï¼‰
- Task 2b: CRDT å†²çªè§£å†³ï¼ˆCRDT Specialistï¼‰
- Task 2c: åœ¨çº¿ç”¨æˆ·å±•ç¤ºï¼ˆPresence Specialistï¼‰

Phase 3: ç‰ˆæœ¬å’Œåˆ†äº«
- Task 3a: ç‰ˆæœ¬å†å²è®°å½•ï¼ˆVersioning Specialistï¼‰
- Task 3b: æ–‡æ¡£åˆ†äº«æƒé™ï¼ˆBackend Architectï¼‰
- Task 3c: å¯¼å‡ºåŠŸèƒ½ï¼ˆExport Specialistï¼‰
```

### é€šç”¨åŸåˆ™

ä¸åŒé¡¹ç›®ç±»å‹é€‰æ‹© Subagent çš„åŸåˆ™ï¼š

1. **æ ¸å¿ƒåŠŸèƒ½ä¼˜å…ˆ**ï¼šå…ˆé…ç½®æ ¸å¿ƒä¸šåŠ¡ç›¸å…³çš„ Subagent
2. **æŠ€æœ¯æ ˆåŒ¹é…**ï¼šé€‰æ‹©ä¸é¡¹ç›®æŠ€æœ¯æ ˆå¯¹åº”çš„ä¸“å®¶è§’è‰²
3. **å¤æ‚åº¦å†³å®š**ï¼šç®€å•åŠŸèƒ½ç”¨é€šç”¨è§’è‰²ï¼Œå¤æ‚åŠŸèƒ½åˆ›å»ºä¸“é—¨è§’è‰²
4. **è¿­ä»£è°ƒæ•´**ï¼šéšé¡¹ç›®æ¼”è¿›åŠ¨æ€å¢å‡ Subagent
