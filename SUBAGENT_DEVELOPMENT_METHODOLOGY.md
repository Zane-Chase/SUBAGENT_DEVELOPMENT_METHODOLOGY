# Subagent å¹¶å‘å¼€å‘æ–¹æ³•è®º

> åŸºäº Sequential Thinking + æ–‡æ¡£åŒ–å·¥ä½œæµçš„ AI åä½œå¼€å‘æ–¹æ³•
>
> **ç‰ˆæœ¬**: 1.0
> **æ—¥æœŸ**: 2025-10-01
> **é€‚ç”¨**: å¤§å‹å¤æ‚é¡¹ç›®çš„ AI è¾…åŠ©å¼€å‘

---

## ğŸ“‹ ç›®å½•

- [æ–¹æ³•è®ºæ¦‚è¿°](#æ–¹æ³•è®ºæ¦‚è¿°)
- [æ ¸å¿ƒåŸç†](#æ ¸å¿ƒåŸç†)
- [æ¶æ„è®¾è®¡](#æ¶æ„è®¾è®¡)
- [Token æ§åˆ¶ç­–ç•¥](#token-æ§åˆ¶ç­–ç•¥)
- [æ–‡æ¡£åŒ–å·¥ä½œæµ](#æ–‡æ¡£åŒ–å·¥ä½œæµ)
- [å®Œæ•´å·¥ä½œæµç¨‹](#å®Œæ•´å·¥ä½œæµç¨‹)
- [ä¼˜ç‚¹æ€»ç»“](#ä¼˜ç‚¹æ€»ç»“)
- [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)
- [å®é™…åº”ç”¨ç¤ºä¾‹](#å®é™…åº”ç”¨ç¤ºä¾‹)

---

## æ–¹æ³•è®ºæ¦‚è¿°

### ä»€ä¹ˆæ˜¯ Subagent å¹¶å‘å¼€å‘ï¼Ÿ

Subagent å¹¶å‘å¼€å‘æ˜¯ä¸€ç§åŸºäº **AI Agent è§’è‰²åˆ†å·¥** å’Œ **æ–‡æ¡£åŒ–çŸ¥è¯†ç®¡ç†** çš„è½¯ä»¶å¼€å‘æ–¹æ³•è®ºã€‚å®ƒé€šè¿‡ä»¥ä¸‹æ–¹å¼æå‡å¼€å‘æ•ˆç‡ï¼š

1. **Sequential Thinking Controller**ï¼ˆæ€»åè°ƒå™¨ï¼‰è´Ÿè´£å…¨å±€è§„åˆ’å’Œå†³ç­–
2. **å¤šä¸ªä¸“ä¸š Subagent**ï¼ˆé€šè¿‡ä¸åŒ prompt å®šä¹‰ï¼‰å¹¶å‘å¤„ç†ç‹¬ç«‹ä»»åŠ¡
3. **æ–‡æ¡£åŒ–å·¥ä½œæµ** å®ç°çŸ¥è¯†æŒä¹…åŒ–å’Œä¸Šä¸‹æ–‡éš”ç¦»
4. **Token é¢„ç®—æ§åˆ¶** ç¡®ä¿æ¯ä¸ª Agent é«˜æ•ˆè¿è¡Œ

### é€‚ç”¨åœºæ™¯

âœ… **é€‚åˆ**ï¼š
- å¤§å‹é¡¹ç›®ï¼ˆå¤šæ¨¡å—ã€å¤šå±‚æ¬¡ï¼‰
- å¤æ‚ç³»ç»Ÿæ¶æ„ï¼ˆå¾®æœåŠ¡ã€å¤šç»„ä»¶é›†æˆï¼‰
- é•¿æœŸè¿­ä»£å¼€å‘ï¼ˆéœ€è¦çŸ¥è¯†ç§¯ç´¯ï¼‰
- å›¢é˜Ÿåä½œé¡¹ç›®ï¼ˆéœ€è¦æ–‡æ¡£åŒ–æ²Ÿé€šï¼‰

âŒ **ä¸é€‚åˆ**ï¼š
- ç®€å•çš„å•æ–‡ä»¶ä¿®æ”¹
- ä¸€æ¬¡æ€§å°è„šæœ¬å¼€å‘
- æ— éœ€å¤ç”¨çš„ä¸€æ¬¡æ€§ä»»åŠ¡

---

## æ ¸å¿ƒåŸç†

### 1. è§’è‰²åˆ†ç¦»åŸåˆ™ï¼ˆSeparation of Concernsï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Sequential Thinking Controller (æˆ‘)                 â”‚
â”‚  - å…¨å±€åˆ†æå’Œå†³ç­–                                        â”‚
â”‚  - ä»»åŠ¡åˆ†è§£å’Œåˆ†é…                                        â”‚
â”‚  - ç»“æœæ•´åˆå’Œè´¨é‡æ§åˆ¶                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚              â”‚              â”‚
    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
    â”‚ Subagent1 â”‚  â”‚ Subagent2 â”‚  â”‚ Subagent3 â”‚
    â”‚ æ•°æ®é›†æˆ  â”‚  â”‚ é£é™©ç®¡ç†  â”‚  â”‚ ç­–ç•¥ä¼˜åŒ–  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚              â”‚              â”‚
    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
    â”‚ Subagent4 â”‚  â”‚ Subagent5 â”‚  â”‚ Subagent6 â”‚
    â”‚ äº¤æ˜“æ‰§è¡Œ  â”‚  â”‚ ç›‘æ§å‘Šè­¦  â”‚  â”‚ æµ‹è¯•éƒ¨ç½²  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å…³é”®ç‚¹**ï¼š
- Controller ä¸å†™å…·ä½“ä»£ç ï¼Œåªåšåˆ†æå’Œå†³ç­–
- Subagent ä¸“æ³¨äºç‰¹å®šé¢†åŸŸï¼ŒèŒè´£å•ä¸€
- æ¯ä¸ª Subagent æœ‰ç‹¬ç«‹çš„ä¸Šä¸‹æ–‡çª—å£

### 2. æ–‡æ¡£åŒ–çŸ¥è¯†ç®¡ç†ï¼ˆStructured Note-Takingï¼‰

**çµæ„Ÿæ¥æº**ï¼šAnthropic çš„ Context Engineering æœ€ä½³å®è·µ

> "Agent å®šæœŸå°†ç»“æœå†™å…¥æŒä¹…åŒ–å­˜å‚¨ï¼Œåç»­ä»»åŠ¡åªéœ€è¯»å–æ–‡æ¡£ï¼Œè€Œä¸æ˜¯é‡æ–°æ‰§è¡Œæ‰€æœ‰å†å²æ“ä½œ"

**å®ç°æ–¹å¼**ï¼š
```
ä»»åŠ¡ A â†’ è¾“å‡ºæ–‡æ¡£ A
              â†“
ä»»åŠ¡ Bï¼ˆè¯»å–æ–‡æ¡£ Aï¼‰â†’ è¾“å‡ºæ–‡æ¡£ B
                            â†“
ä»»åŠ¡ Cï¼ˆè¯»å–æ–‡æ¡£ Bï¼‰â†’ è¾“å‡ºæ–‡æ¡£ C
```

**ä¼˜åŠ¿**ï¼š
- é¿å…ä¸Šä¸‹æ–‡ç´¯ç§¯ï¼ˆæ¯ä¸ªä»»åŠ¡éƒ½æ˜¯è½»é‡çº§çš„ï¼‰
- çŸ¥è¯†å¯å¤ç”¨ï¼ˆæ–‡æ¡£å¯è¢«åç»­ä»»åŠ¡æˆ–äººç±»æŸ¥é˜…ï¼‰
- å¯è¿½æº¯ï¼ˆå®Œæ•´çš„ä»»åŠ¡é“¾è®°å½•ï¼‰

### 3. Token é¢„ç®—æ§åˆ¶ï¼ˆContext Window Managementï¼‰

**æ ¸å¿ƒç†å¿µ**ï¼šä¸è¦å¡«æ»¡ä¸Šä¸‹æ–‡çª—å£ï¼ˆAndrej Karpathyï¼š"å¡«å……æ°å½“ä¿¡æ¯çš„è‰ºæœ¯"ï¼‰

**ç§‘å­¦ä¾æ®**ï¼š
- Claude Sonnet 4 çš„æœ‰æ•ˆä¸Šä¸‹æ–‡é•¿åº¦çº¦ **60k-120k tokens**
- è¶…è¿‡æœ‰æ•ˆé•¿åº¦ä¼šå¯¼è‡´æ€§èƒ½ä¸‹é™ï¼ˆlost-in-the-middle effectï¼‰
- è®¾å®š **50% é¢„ç®—é™åˆ¶**ï¼ˆ100k tokensï¼‰ç¡®ä¿æœ€ä½³æ€§èƒ½

**æ§åˆ¶ç­–ç•¥**ï¼š
| ç»„ä»¶ | Token é¢„ç®— | å æ¯” |
|------|-----------|------|
| Controllerï¼ˆæˆ‘ï¼‰ | 40k-60k | 20-30% |
| å•ä¸ª Subagent | 20k-30k | 10-15% |
| 4 ä¸ªå¹¶å‘ Subagent | 80k-120k | 40-60% |
| å®‰å…¨ç¼“å†² | 20k-40k | 10-20% |

### 4. ä»»åŠ¡ç²’åº¦æ§åˆ¶ï¼ˆTask Granularityï¼‰

**åŸåˆ™**ï¼šä¸€ä¸ªä»»åŠ¡åªä¿®æ”¹ 1-2 ä¸ªæ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶ 200-300 è¡Œ

**Token ä¼°ç®—å…¬å¼**ï¼š
```
å•ä¸ªä»»åŠ¡ Token ä½¿ç”¨ = ä»»åŠ¡æ–‡æ¡£ (5k)
                    + è¯»å–ä»£ç  (6k)
                    + ç”Ÿæˆä»£ç  (10k)
                    + æµ‹è¯•è¯´æ˜ (3k)
                    â‰ˆ 25k tokens
```

**å¤§ä»»åŠ¡åˆ†è§£ç¤ºä¾‹**ï¼š
```
âŒ å¤§ä»»åŠ¡ï¼š"å®ç°å®Œæ•´çš„ Raydium é›†æˆ"ï¼ˆé¢„è®¡ 80k tokensï¼‰

âœ… æ‹†åˆ†ä¸º 4 ä¸ªå°ä»»åŠ¡ï¼š
  - ä»»åŠ¡ 1a: å®ç°ä»·æ ¼è·å–å‡½æ•°ï¼ˆ25kï¼‰
  - ä»»åŠ¡ 1b: å®ç°ç¼“å­˜æœºåˆ¶ï¼ˆ20kï¼‰
  - ä»»åŠ¡ 1c: æ·»åŠ é”™è¯¯å¤„ç†ï¼ˆ15kï¼‰
  - ä»»åŠ¡ 1d: ç¼–å†™æµ‹è¯•ç”¨ä¾‹ï¼ˆ20kï¼‰
```

---

## æ¶æ„è®¾è®¡

### ç›®å½•ç»“æ„

```
dex_bot/
â”œâ”€â”€ SUBAGENT_DEVELOPMENT_METHODOLOGY.md   # æœ¬æ–‡æ¡£
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ agents/                           # Subagent è§’è‰²å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ mainnet-integration-expert.md
â”‚   â”‚   â”œâ”€â”€ risk-management-architect.md
â”‚   â”‚   â”œâ”€â”€ strategy-optimizer.md
â”‚   â”‚   â”œâ”€â”€ transaction-specialist.md
â”‚   â”‚   â”œâ”€â”€ monitoring-engineer.md
â”‚   â”‚   â””â”€â”€ testing-architect.md
â”‚   â”‚
â”‚   â”œâ”€â”€ tasks/                            # ä»»åŠ¡è¾“å…¥ï¼ˆç»™ Subagent çš„æŒ‡ä»¤ï¼‰
â”‚   â”‚   â”œâ”€â”€ phase1/
â”‚   â”‚   â”‚   â”œâ”€â”€ task-1a-raydium-price-fetch.md
â”‚   â”‚   â”‚   â”œâ”€â”€ task-1b-orca-price-fetch.md
â”‚   â”‚   â”‚   â”œâ”€â”€ task-1c-monitoring-setup.md
â”‚   â”‚   â”‚   â””â”€â”€ task-1d-shadow-mode.md
â”‚   â”‚   â”œâ”€â”€ phase2/
â”‚   â”‚   â”‚   â”œâ”€â”€ task-2a-virtual-wallet.md
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â””â”€â”€ phase3/
â”‚   â”‚       â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ outputs/                          # ä»»åŠ¡è¾“å‡ºï¼ˆSubagent å®Œæˆçš„æˆæœï¼‰
â”‚   â”‚   â”œâ”€â”€ phase1/
â”‚   â”‚   â”‚   â”œâ”€â”€ output-1a-raydium-implementation.md
â”‚   â”‚   â”‚   â”œâ”€â”€ output-1b-orca-implementation.md
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”œâ”€â”€ phase2/
â”‚   â”‚   â””â”€â”€ phase3/
â”‚   â”‚
â”‚   â”œâ”€â”€ progress/                         # è¿›åº¦è·Ÿè¸ª
â”‚   â”‚   â”œâ”€â”€ phase1-progress.md
â”‚   â”‚   â”œâ”€â”€ phase2-progress.md
â”‚   â”‚   â””â”€â”€ phase3-progress.md
â”‚   â”‚
â”‚   â””â”€â”€ knowledge-base/                   # å¯å¤ç”¨çŸ¥è¯†åº“
â”‚       â”œâ”€â”€ raydium-integration-guide.md
â”‚       â”œâ”€â”€ risk-management-patterns.md
â”‚       â””â”€â”€ deployment-checklist.md
â”‚
â””â”€â”€ src/                                  # å®é™…ä»£ç 
    â””â”€â”€ ...
```

### Subagent è§’è‰²å®šä¹‰

#### 1. Mainnet Data Integration Expert ğŸ”—
- **ä¸“é•¿**ï¼šSolana DEX æ•°æ®é›†æˆï¼Œç²¾é€š Raydium SDKã€Orca SDK
- **èŒè´£**ï¼šå®ç°çœŸå® mainnet æ•°æ®æºé›†æˆ
- **å·¥ä½œèŒƒå›´**ï¼š`src/context-engineering/rag/`, `src/dex/`

#### 2. Risk Management Architect ğŸ›¡ï¸
- **ä¸“é•¿**ï¼šDeFi é£é™©ç®¡ç†ï¼Œå¥—åˆ©äº¤æ˜“é£é™©æ§åˆ¶
- **èŒè´£**ï¼šè®¾è®¡ Circuit Breakerã€èµ„é‡‘é™é¢ã€æ»‘ç‚¹ä¿æŠ¤
- **å·¥ä½œèŒƒå›´**ï¼šæ–°å¢é£é™©ç®¡ç†æ¨¡å—

#### 3. Strategy & Learning Optimizer ğŸ§ 
- **ä¸“é•¿**ï¼šAI ç­–ç•¥ä¼˜åŒ–ï¼Œæœºå™¨å­¦ä¹ å†³ç­–ç³»ç»Ÿ
- **èŒè´£**ï¼šä¼˜åŒ– Prompt Engineering å’Œ Memory æ¨¡å—
- **å·¥ä½œèŒƒå›´**ï¼š`src/context-engineering/prompt/`, `src/context-engineering/memory/`

#### 4. Transaction Execution Specialist âš¡
- **ä¸“é•¿**ï¼šSolana äº¤æ˜“æ‰§è¡Œï¼ŒDEX swapï¼ŒGas ä¼˜åŒ–
- **èŒè´£**ï¼šå®ç°çœŸå®çš„äº¤æ˜“æ‰§è¡Œé€»è¾‘
- **å·¥ä½œèŒƒå›´**ï¼š`src/executor/`, `src/dex/`

#### 5. Monitoring & Dashboard Engineer ğŸ“Š
- **ä¸“é•¿**ï¼šç³»ç»Ÿç›‘æ§ï¼Œæ•°æ®å¯è§†åŒ–
- **èŒè´£**ï¼šæ„å»ºå®æ—¶ç›‘æ§å’Œå‰ç«¯ä»ªè¡¨æ¿
- **å·¥ä½œèŒƒå›´**ï¼š`src/monitoring/`, `frontend/`

#### 6. Testing & Deployment Architect ğŸš€
- **ä¸“é•¿**ï¼šDevOpsï¼Œæ¸è¿›å¼éƒ¨ç½²
- **èŒè´£**ï¼šè®¾è®¡ Shadow Modeã€Paper Tradingã€Canary Deploy
- **å·¥ä½œèŒƒå›´**ï¼š`src/phases/`, `tests/`

---

## Token æ§åˆ¶ç­–ç•¥

### äº”å±‚é˜²æŠ¤æœºåˆ¶

#### 1ï¸âƒ£ ä»»åŠ¡ç²’åº¦æ§åˆ¶
```yaml
è§„åˆ™:
  - æ¯ä¸ªä»»åŠ¡åªä¿®æ”¹ 1-2 ä¸ªæ–‡ä»¶
  - æ¯ä¸ªæ–‡ä»¶é™åˆ¶åœ¨ 200-300 è¡Œ
  - æ˜ç¡®è¾“å…¥å’Œè¾“å‡ºèŒƒå›´

Token ä¼°ç®—:
  ä»»åŠ¡æ–‡æ¡£: ~5k
  è¯»å–ä»£ç : ~6k (1-2ä¸ªæ–‡ä»¶)
  ç”Ÿæˆä»£ç : ~10k
  æµ‹è¯•è¯´æ˜: ~3k
  æ€»è®¡: ~25k tokens
```

#### 2ï¸âƒ£ è¾“å…¥æ–‡æ¡£åŒ–
```markdown
# ä»»åŠ¡æ–‡æ¡£æ¨¡æ¿

## Role
[Subagent è§’è‰²åç§°]

## Objective
[ç®€çŸ­çš„ä»»åŠ¡ç›®æ ‡ï¼Œ1-2 å¥è¯]

## Input Files
- path/to/file1.ts (line 100-150)
- path/to/file2.ts (specific function)

## Requirements
1. å…·ä½“è¦æ±‚ 1
2. å…·ä½“è¦æ±‚ 2
3. å…·ä½“è¦æ±‚ 3

## Output Location
docs/outputs/[phase]/output-[id]-[name].md

## Token Budget
é¢„è®¡ï¼š25k tokens
```

**ä¼˜åŠ¿**ï¼š
- Subagent è¯»å–æ–‡æ¡£ï¼ˆ~3k tokensï¼‰ï¼Œè€Œä¸æ˜¯åœ¨ prompt ä¸­åŒ…å«å¤§é‡ä»£ç 
- Controller åˆ›å»ºæ–‡æ¡£æ—¶å¯ä»¥ç²¾ç¡®æ§åˆ¶èŒƒå›´

#### 3ï¸âƒ£ è¾“å‡ºæ–‡æ¡£åŒ–
```markdown
# è¾“å‡ºæ–‡æ¡£æ¨¡æ¿

## Modified Files
- path/to/file1.ts
- path/to/file2.ts

## Implementation
[æ ¸å¿ƒä»£ç æ”¹åŠ¨æˆ–å®Œæ•´å®ç°]

## Testing Results
- âœ… å•å…ƒæµ‹è¯•é€šè¿‡
- âœ… é›†æˆæµ‹è¯•é€šè¿‡
- â±ï¸ æ€§èƒ½æŒ‡æ ‡

## Usage
[ä»£ç ä½¿ç”¨ç¤ºä¾‹]

## Next Steps
- å»ºè®® 1
- å»ºè®® 2
```

**ä¼˜åŠ¿**ï¼š
- åç»­ä»»åŠ¡åªéœ€è¯»å–è¾“å‡ºæ–‡æ¡£ï¼ˆ~5k tokensï¼‰
- é¿å…é‡æ–°æ‰§è¡Œæ‰€æœ‰å†å²æ“ä½œ
- æˆä¸ºå¯å¤ç”¨çš„çŸ¥è¯†åº“

#### 4ï¸âƒ£ å¢é‡å¼å¼€å‘
```
ä»»åŠ¡ 1a â†’ è¾“å‡º 1a (25k)
              â†“
ä»»åŠ¡ 1b (è¯»å–è¾“å‡º 1aï¼Œ5k) â†’ è¾“å‡º 1b (25k)
                                  â†“
ä»»åŠ¡ 1c (è¯»å–è¾“å‡º 1bï¼Œ5k) â†’ è¾“å‡º 1c (25k)
```

**å…³é”®**ï¼šæ¯ä¸ªæ–°ä»»åŠ¡åªè¯»å–å‰ä¸€ä¸ªçš„è¾“å‡ºæ–‡æ¡£ï¼Œä¸é‡æ–°ç”Ÿæˆ

#### 5ï¸âƒ£ å¹¶å‘æ‰§è¡Œéš”ç¦»
```
ä»»åŠ¡ 1a (Raydium)   â†’ è¾“å‡º 1a  â”€â”
ä»»åŠ¡ 1b (Orca)      â†’ è¾“å‡º 1b  â”€â”¤
ä»»åŠ¡ 1c (Monitor)   â†’ è¾“å‡º 1c  â”€â”¼â†’ Controller æ•´åˆ â†’ å†³ç­–
ä»»åŠ¡ 1d (Shadow)    â†’ è¾“å‡º 1d  â”€â”˜

æ¯ä¸ªä»»åŠ¡ç‹¬ç«‹ä¸Šä¸‹æ–‡ï¼š25k Ã— 4 = 100k tokens
```

---

## æ–‡æ¡£åŒ–å·¥ä½œæµ

### ä»»åŠ¡æ–‡æ¡£ï¼ˆTask Documentï¼‰

**ä½œç”¨**ï¼šç»™ Subagent çš„è¯¦ç»†æŒ‡ä»¤

**æ ‡å‡†æ ¼å¼**ï¼š
```markdown
# Task [ID]: [ä»»åŠ¡åç§°]

## Role
[Subagent è§’è‰²åç§°]

## Objective
[1-2 å¥è¯çš„ä»»åŠ¡ç›®æ ‡]

## Context
[å¿…è¦çš„èƒŒæ™¯ä¿¡æ¯]

## Input Files
- src/path/to/file1.ts (line 100-150)
- src/path/to/file2.ts (function: functionName)

## Requirements
1. åŠŸèƒ½è¦æ±‚ 1
2. åŠŸèƒ½è¦æ±‚ 2
3. éåŠŸèƒ½è¦æ±‚ï¼ˆæ€§èƒ½ã€å®‰å…¨ç­‰ï¼‰

## Constraints
- ä¿æŒä¸ç°æœ‰æ¥å£å…¼å®¹
- éµå¾ªé¡¹ç›®ä»£ç è§„èŒƒ
- æ·»åŠ å¿…è¦çš„é”™è¯¯å¤„ç†

## Output Location
docs/outputs/[phase]/output-[id]-[name].md

## Token Budget
é¢„è®¡ï¼š25k tokens

## Success Criteria
- [ ] åŠŸèƒ½å®ç°å®Œæ•´
- [ ] æµ‹è¯•é€šè¿‡
- [ ] æ–‡æ¡£å®Œå–„
```

### è¾“å‡ºæ–‡æ¡£ï¼ˆOutput Documentï¼‰

**ä½œç”¨**ï¼šSubagent å®Œæˆä»»åŠ¡åçš„äº¤ä»˜æˆæœ

**æ ‡å‡†æ ¼å¼**ï¼š
```markdown
# Output [ID]: [ä»»åŠ¡åç§°] - å®ç°æŠ¥å‘Š

## Status
âœ… å·²å®Œæˆ / âš ï¸ éƒ¨åˆ†å®Œæˆ / âŒ å¤±è´¥

## Modified Files
- src/path/to/file1.ts
- src/path/to/file2.ts

## Implementation

### æ ¸å¿ƒæ”¹åŠ¨
[å…³é”®ä»£ç ç‰‡æ®µæˆ–å®Œæ•´å®ç°]

### è®¾è®¡å†³ç­–
- å†³ç­– 1ï¼š[åŸå› ]
- å†³ç­– 2ï¼š[åŸå› ]

## Testing

### å•å…ƒæµ‹è¯•
```typescript
[æµ‹è¯•ä»£ç ]
```

### æµ‹è¯•ç»“æœ
- âœ… æµ‹è¯• A é€šè¿‡
- âœ… æµ‹è¯• B é€šè¿‡
- â±ï¸ æ€§èƒ½ï¼šå¹³å‡ 150ms

## Usage

### åŸºæœ¬ç”¨æ³•
```typescript
[ä»£ç ç¤ºä¾‹]
```

### é«˜çº§ç”¨æ³•
[æ›´å¤æ‚çš„ç¤ºä¾‹]

## Dependencies
- æ–°å¢ä¾èµ–ï¼š[package@version]
- ä¾èµ–çš„å…¶ä»–æ¨¡å—ï¼š[module names]

## Next Steps
- å»ºè®® 1ï¼š[å…·ä½“æè¿°]
- å»ºè®® 2ï¼š[å…·ä½“æè¿°]

## Issues & Limitations
- å·²çŸ¥é—®é¢˜ 1
- é™åˆ¶ 1

## Token Usage
å®é™…ä½¿ç”¨ï¼š23k tokens (é¢„ç®—ï¼š25k)
```

### è¿›åº¦æ–‡æ¡£ï¼ˆProgress Documentï¼‰

**ä½œç”¨**ï¼šè·Ÿè¸ªæ•´ä¸ª Phase çš„è¿›åº¦

**æ ‡å‡†æ ¼å¼**ï¼š
```markdown
# Phase 1: Shadow Mode - è¿›åº¦è·Ÿè¸ª

## æ€»ä½“çŠ¶æ€
ğŸ”„ è¿›è¡Œä¸­ | å®Œæˆåº¦ï¼š60%

## ä»»åŠ¡ç»„ Aï¼ˆå¹¶å‘æ‰§è¡Œï¼‰

### Task 1a: Raydium ä»·æ ¼è·å–
- çŠ¶æ€ï¼šâœ… å·²å®Œæˆ
- Subagentï¼šMainnet Integration Expert
- å®Œæˆæ—¶é—´ï¼š2025-10-01
- è¾“å‡ºï¼šdocs/outputs/phase1/output-1a-raydium-implementation.md

### Task 1b: Orca ä»·æ ¼è·å–
- çŠ¶æ€ï¼šâœ… å·²å®Œæˆ
- Subagentï¼šMainnet Integration Expert
- å®Œæˆæ—¶é—´ï¼š2025-10-01
- è¾“å‡ºï¼šdocs/outputs/phase1/output-1b-orca-implementation.md

### Task 1c: ç›‘æ§æ¡†æ¶
- çŠ¶æ€ï¼šğŸ”„ è¿›è¡Œä¸­
- Subagentï¼šMonitoring Engineer
- é¢„è®¡å®Œæˆï¼š2025-10-02

### Task 1d: Shadow Mode æ‰§è¡Œå™¨
- çŠ¶æ€ï¼šğŸ“… å¾…å¼€å§‹
- Subagentï¼šTesting Architect

## å†³ç­–è®°å½•
- [2025-10-01] å†³å®šä½¿ç”¨ Helius RPC ä½œä¸ºä¸»èŠ‚ç‚¹
- [2025-10-01] ç¼“å­˜ TTL è®¾ç½®ä¸º 100ms

## é£é™©å’Œé—®é¢˜
- âš ï¸ Raydium SDK æ–‡æ¡£ä¸å®Œæ•´ï¼Œéœ€è¦æŸ¥çœ‹æºç 
- âš ï¸ RPC é€Ÿç‡é™åˆ¶éœ€è¦æ³¨æ„

## ä¸‹ä¸€æ­¥è¡ŒåŠ¨
1. å®Œæˆä»»åŠ¡ç»„ A çš„å‰©ä½™ä»»åŠ¡
2. å¼€å§‹ä»»åŠ¡ç»„ Bï¼ˆé£é™©è¯„ä¼°ã€ç­–ç•¥ä¼˜åŒ–ï¼‰
3. é›†æˆæ‰€æœ‰æ¨¡å—å¹¶æµ‹è¯•
```

---

## å®Œæ•´å·¥ä½œæµç¨‹

### Phase 1: å‡†å¤‡é˜¶æ®µ

#### Step 1: åˆ›å»º Subagent è§’è‰²å®šä¹‰
```bash
docs/agents/
â”œâ”€â”€ mainnet-integration-expert.md
â”œâ”€â”€ risk-management-architect.md
â”œâ”€â”€ strategy-optimizer.md
â”œâ”€â”€ transaction-specialist.md
â”œâ”€â”€ monitoring-engineer.md
â””â”€â”€ testing-architect.md
```

#### Step 2: ä»»åŠ¡åˆ†è§£
Controllerï¼ˆæˆ‘ï¼‰ä½¿ç”¨ Sequential Thinking åˆ†æé¡¹ç›®ï¼Œåˆ†è§£ä¸ºå°ä»»åŠ¡ï¼š
```
Phase 1: Shadow Mode
  â”œâ”€â”€ ä»»åŠ¡ç»„ Aï¼ˆå¹¶å‘ï¼‰
  â”‚   â”œâ”€â”€ Task 1a: Raydium ä»·æ ¼è·å–
  â”‚   â”œâ”€â”€ Task 1b: Orca ä»·æ ¼è·å–
  â”‚   â”œâ”€â”€ Task 1c: ç›‘æ§æ¡†æ¶
  â”‚   â””â”€â”€ Task 1d: Shadow æ‰§è¡Œå™¨
  â””â”€â”€ ä»»åŠ¡ç»„ Bï¼ˆä¾èµ– Aï¼‰
      â”œâ”€â”€ Task 1e: é£é™©è¯„ä¼°
      â”œâ”€â”€ Task 1f: ç­–ç•¥ä¼˜åŒ–
      â””â”€â”€ Task 1g: æ€§èƒ½æŒ‡æ ‡
```

### Phase 2: æ‰§è¡Œé˜¶æ®µ

#### Step 1: åˆ›å»ºä»»åŠ¡æ–‡æ¡£
Controller ä½¿ç”¨ Write tool åˆ›å»ºï¼š
```
docs/tasks/phase1/task-1a-raydium-price-fetch.md
docs/tasks/phase1/task-1b-orca-price-fetch.md
docs/tasks/phase1/task-1c-monitoring-setup.md
docs/tasks/phase1/task-1d-shadow-mode.md
```

#### Step 2: å¹¶å‘å¯åŠ¨ Subagent
Controller åœ¨**å•ä¸ªæ¶ˆæ¯**ä¸­ä½¿ç”¨ Task tool å¯åŠ¨ 4 ä¸ª Subagentï¼š

```
Subagent 1 (Mainnet Expert):
  - è¯»å–ï¼šdocs/tasks/phase1/task-1a-raydium-price-fetch.md
  - æ‰§è¡Œï¼šå®ç°åŠŸèƒ½
  - è¾“å‡ºï¼šdocs/outputs/phase1/output-1a-raydium-implementation.md

Subagent 2 (Mainnet Expert):
  - è¯»å–ï¼šdocs/tasks/phase1/task-1b-orca-price-fetch.md
  - æ‰§è¡Œï¼šå®ç°åŠŸèƒ½
  - è¾“å‡ºï¼šdocs/outputs/phase1/output-1b-orca-implementation.md

Subagent 3 (Monitoring Engineer):
  - è¯»å–ï¼šdocs/tasks/phase1/task-1c-monitoring-setup.md
  - æ‰§è¡Œï¼šå®ç°åŠŸèƒ½
  - è¾“å‡ºï¼šdocs/outputs/phase1/output-1c-monitoring-implementation.md

Subagent 4 (Testing Architect):
  - è¯»å–ï¼šdocs/tasks/phase1/task-1d-shadow-mode.md
  - æ‰§è¡Œï¼šå®ç°åŠŸèƒ½
  - è¾“å‡ºï¼šdocs/outputs/phase1/output-1d-shadow-implementation.md
```

**Token ä½¿ç”¨**ï¼š4 Ã— 25k = 100k tokensï¼ˆåœ¨é¢„ç®—å†…ï¼‰

### Phase 3: æ•´åˆé˜¶æ®µ

#### Step 1: æ”¶é›†è¾“å‡º
Controller ä½¿ç”¨ Read tool è¯»å–æ‰€æœ‰è¾“å‡ºæ–‡æ¡£ï¼š
```
Read docs/outputs/phase1/output-1a-raydium-implementation.md
Read docs/outputs/phase1/output-1b-orca-implementation.md
Read docs/outputs/phase1/output-1c-monitoring-implementation.md
Read docs/outputs/phase1/output-1d-shadow-implementation.md
```

#### Step 2: Sequential Thinking åˆ†æ
Controller ä½¿ç”¨ Sequential Thinking MCP åˆ†æï¼š
```
æ€è€ƒ 1ï¼šæ£€æŸ¥æ‰€æœ‰ä»»åŠ¡æ˜¯å¦æˆåŠŸå®Œæˆ
æ€è€ƒ 2ï¼šè¯„ä¼°ä»£ç è´¨é‡å’Œä¸€è‡´æ€§
æ€è€ƒ 3ï¼šè¯†åˆ«æ½œåœ¨çš„é›†æˆé—®é¢˜
æ€è€ƒ 4ï¼šå†³å®šä¸‹ä¸€æ­¥è¡ŒåŠ¨
```

#### Step 3: æ›´æ–°è¿›åº¦æ–‡æ¡£
Controller æ›´æ–° `docs/progress/phase1-progress.md`

#### Step 4: å†³ç­–ä¸‹ä¸€æ‰¹ä»»åŠ¡
- å¦‚æœä»»åŠ¡ç»„ A å…¨éƒ¨æˆåŠŸ â†’ å¯åŠ¨ä»»åŠ¡ç»„ B
- å¦‚æœæœ‰å¤±è´¥ä»»åŠ¡ â†’ åˆ†æåŸå› ï¼Œé‡æ–°åˆ†é…
- å¦‚æœéœ€è¦è°ƒæ•´ â†’ åˆ›å»ºè¡¥å……ä»»åŠ¡

### Phase 4: è¿­ä»£

é‡å¤ Phase 2-3ï¼Œç›´åˆ°æ•´ä¸ªé¡¹ç›®å®Œæˆã€‚

---

## ä¼˜ç‚¹æ€»ç»“

### âœ… 1. Token ä½¿ç”¨é«˜æ•ˆ
- **ç²¾ç¡®æ§åˆ¶**ï¼šæ¯ä¸ªä»»åŠ¡ <30k tokensï¼Œè¿œä½äº 50% é™åˆ¶
- **æ— ç´¯ç§¯**ï¼šå¢é‡å¼å¼€å‘é¿å…ä¸Šä¸‹æ–‡è†¨èƒ€
- **æœ€ä½³æ€§èƒ½**ï¼šåœ¨ Claude çš„æœ‰æ•ˆä¸Šä¸‹æ–‡èŒƒå›´å†…ï¼ˆ60k-120kï¼‰

### âœ… 2. å¹¶å‘æ‰§è¡Œé«˜æ•ˆ
- **çœŸæ­£å¹¶å‘**ï¼š4-6 ä¸ª Subagent åŒæ—¶å·¥ä½œ
- **äº’ä¸å¹²æ‰°**ï¼šç‹¬ç«‹ä¸Šä¸‹æ–‡çª—å£
- **æ—¶é—´èŠ‚çœ**ï¼šç›¸æ¯”ä¸²è¡Œå¼€å‘ï¼Œæ•ˆç‡æå‡ 4-6 å€

### âœ… 3. çŸ¥è¯†å¯å¤ç”¨
- **è¾“å‡ºæ–‡æ¡£**ï¼šæˆä¸ºé¡¹ç›®çŸ¥è¯†åº“
- **ä»»åŠ¡æ¨¡æ¿**ï¼šç›¸ä¼¼ä»»åŠ¡å¯å¤ç”¨
- **æœ€ä½³å®è·µ**ï¼šæˆåŠŸç»éªŒæ–‡æ¡£åŒ–

### âœ… 4. è´¨é‡å¯æ§
- **ä¸“ä¸šåˆ†å·¥**ï¼šæ¯ä¸ª Subagent ä¸“æ³¨å…¶æ“…é•¿é¢†åŸŸ
- **èŒè´£å•ä¸€**ï¼šé™ä½é”™è¯¯ç‡
- **å¯è¿½æº¯**ï¼šå®Œæ•´çš„ä»»åŠ¡ â†’ è¾“å‡ºé“¾

### âœ… 5. æ˜“äºåä½œ
- **æ–‡æ¡£åŒ–**ï¼šå›¢é˜Ÿæˆå‘˜å¯æŸ¥é˜…æ‰€æœ‰ä»»åŠ¡å’Œè¾“å‡º
- **æ ‡å‡†åŒ–**ï¼šç»Ÿä¸€çš„æ–‡æ¡£æ ¼å¼
- **é€æ˜åº¦**ï¼šè¿›åº¦å’Œå†³ç­–å¯è§

### âœ… 6. å®¹é”™æ€§å¼º
- **éš”ç¦»å¤±è´¥**ï¼šå•ä¸ªä»»åŠ¡å¤±è´¥ä¸å½±å“å…¶ä»–
- **æ˜“äºé‡è¯•**ï¼šä»»åŠ¡æ–‡æ¡£å¯é‡æ–°æ‰§è¡Œ
- **æ¸è¿›å¼**ï¼šåˆ†é˜¶æ®µéªŒè¯

### âœ… 7. å¯æ‰©å±•æ€§
- **æ¨¡å—åŒ–**ï¼šæ–°ä»»åŠ¡éµå¾ªç›¸åŒæ¨¡å¼
- **è§’è‰²æ‰©å±•**ï¼šå¯æ·»åŠ æ–°çš„ Subagent è§’è‰²
- **é¡¹ç›®è¿ç§»**ï¼šæ–¹æ³•è®ºå¯åº”ç”¨äºå…¶ä»–é¡¹ç›®

### âœ… 8. æˆæœ¬ä¼˜åŒ–
- **ç¼“å­˜åˆ©ç”¨**ï¼šè¾“å‡ºæ–‡æ¡£å¯è¢«å¤šæ¬¡è¯»å–ï¼ˆç¼“å­˜ token ä»·æ ¼ä½ 10 å€ï¼‰
- **å‡å°‘é‡å¤**ï¼šé¿å…é‡æ–°ç”Ÿæˆå·²æœ‰å†…å®¹
- **ç²¾å‡†èŒƒå›´**ï¼šåªå¤„ç†å¿…è¦çš„ä»£ç 

---

## æœ€ä½³å®è·µ

### 1. ä»»åŠ¡è®¾è®¡åŸåˆ™

#### âœ… DOï¼ˆæ¨èåšæ³•ï¼‰
- **å•ä¸€èŒè´£**ï¼šä¸€ä¸ªä»»åŠ¡åªåšä¸€ä»¶äº‹
- **æ˜ç¡®è¾¹ç•Œ**ï¼šæ¸…æ™°çš„è¾“å…¥å’Œè¾“å‡º
- **å¯æµ‹è¯•**ï¼šä»»åŠ¡å®Œæˆåå¯éªŒè¯
- **æ–‡æ¡£å…ˆè¡Œ**ï¼šå…ˆå†™ä»»åŠ¡æ–‡æ¡£ï¼Œå†å¯åŠ¨ Subagent

#### âŒ DON'Tï¼ˆé¿å…åšæ³•ï¼‰
- **ä»»åŠ¡è¿‡å¤§**ï¼šä¸€ä¸ªä»»åŠ¡ä¿®æ”¹ >3 ä¸ªæ–‡ä»¶
- **èŒè´£æ··æ‚**ï¼šä¸€ä¸ªä»»åŠ¡æ¶‰åŠå¤šä¸ªé¢†åŸŸ
- **æ¨¡ç³Šç›®æ ‡**ï¼šæ²¡æœ‰æ˜ç¡®çš„æˆåŠŸæ ‡å‡†
- **è·³è¿‡æ–‡æ¡£**ï¼šç›´æ¥åœ¨ prompt ä¸­å†™å¤§é‡ä»£ç 

### 2. æ–‡æ¡£ç¼–å†™åŸåˆ™

#### ä»»åŠ¡æ–‡æ¡£
```markdown
âœ… å¥½çš„ä»»åŠ¡æ–‡æ¡£ï¼š
- ç›®æ ‡æ¸…æ™°ï¼ˆ1-2 å¥è¯ï¼‰
- è¾“å…¥æ˜ç¡®ï¼ˆå…·ä½“æ–‡ä»¶å’Œè¡Œå·ï¼‰
- è¦æ±‚å…·ä½“ï¼ˆå¯é‡åŒ–çš„æ ‡å‡†ï¼‰
- çº¦æŸæ˜ç¡®ï¼ˆå…¼å®¹æ€§ã€æ€§èƒ½ç­‰ï¼‰

âŒ å·®çš„ä»»åŠ¡æ–‡æ¡£ï¼š
- ç›®æ ‡æ¨¡ç³Šï¼ˆ"ä¼˜åŒ–ç³»ç»Ÿ"ï¼‰
- è¾“å…¥ä¸æ˜ï¼ˆ"ç›¸å…³ä»£ç "ï¼‰
- è¦æ±‚ç¬¼ç»Ÿï¼ˆ"å°½å¯èƒ½å¥½"ï¼‰
- æ— çº¦æŸï¼ˆå¯¼è‡´ä¸å…¼å®¹æ”¹åŠ¨ï¼‰
```

#### è¾“å‡ºæ–‡æ¡£
```markdown
âœ… å¥½çš„è¾“å‡ºæ–‡æ¡£ï¼š
- åŒ…å«å®Œæ•´ä»£ç æˆ–å…³é”®æ”¹åŠ¨
- æµ‹è¯•ç»“æœæ¸…æ™°
- ä½¿ç”¨ç¤ºä¾‹å®Œæ•´
- åç»­å»ºè®®å…·ä½“

âŒ å·®çš„è¾“å‡ºæ–‡æ¡£ï¼š
- åªæœ‰ä»£ç ï¼Œæ— è¯´æ˜
- æ— æµ‹è¯•ç»“æœ
- æ— ä½¿ç”¨ç¤ºä¾‹
- æ— åç»­å»ºè®®
```

### 3. Subagent è§’è‰²è®¾è®¡

#### ä¸“ä¸šåŒ–åŸåˆ™
æ¯ä¸ª Subagent åº”è¯¥ï¼š
- æœ‰æ˜ç¡®çš„ä¸“é•¿é¢†åŸŸ
- å·¥ä½œèŒƒå›´æ¸…æ™°ï¼ˆç‰¹å®šç›®å½•/æ¨¡å—ï¼‰
- ä¸é‡å èŒè´£

#### ç¤ºä¾‹
```
âœ… å¥½çš„è§’è‰²åˆ†å·¥ï¼š
- Data Integration Expert: ä¸“æ³¨ DEX æ•°æ®è·å–
- Risk Management Expert: ä¸“æ³¨é£é™©æ§åˆ¶é€»è¾‘
- Transaction Expert: ä¸“æ³¨äº¤æ˜“æ‰§è¡Œ

âŒ å·®çš„è§’è‰²åˆ†å·¥ï¼š
- General Developer: ä»€ä¹ˆéƒ½åš
- Backend Expert: èŒƒå›´è¿‡å¤§
- Helper: èŒè´£ä¸æ˜
```

### 4. Controller å†³ç­–åŸåˆ™

#### ä½¿ç”¨ Sequential Thinking
```
æ€è€ƒ 1ï¼šåˆ†æå½“å‰çŠ¶æ€
æ€è€ƒ 2ï¼šè¯†åˆ«å¯å¹¶å‘ä»»åŠ¡
æ€è€ƒ 3ï¼šæ£€æŸ¥ä¾èµ–å…³ç³»
æ€è€ƒ 4ï¼šè¯„ä¼°é£é™©
æ€è€ƒ 5ï¼šå†³å®šæ‰§è¡Œé¡ºåº
```

#### è´¨é‡æ£€æŸ¥
- æ¯ä¸ª Phase ç»“æŸåï¼Œå®¡æŸ¥æ‰€æœ‰è¾“å‡º
- è¿è¡Œé›†æˆæµ‹è¯•
- æ›´æ–°çŸ¥è¯†åº“

### 5. Token é¢„ç®—ç›‘æ§

#### é¢„é˜²æ€§æªæ–½
```
1. åˆ›å»ºä»»åŠ¡æ—¶ä¼°ç®— token
2. é™åˆ¶æ–‡ä»¶æ•°é‡ï¼ˆ1-2 ä¸ªï¼‰
3. é™åˆ¶æ–‡ä»¶å¤§å°ï¼ˆ200-300 è¡Œï¼‰
4. ä½¿ç”¨æ–‡æ¡£å¼•ç”¨è€Œéå¤åˆ¶ä»£ç 
```

#### åº”å¯¹è¶…é¢„ç®—
```
å¦‚æœä»»åŠ¡é¢„è®¡ >40k tokensï¼š
  â†’ æ‹†åˆ†ä¸º 2-3 ä¸ªå°ä»»åŠ¡
  â†’ ä½¿ç”¨æ›´ç²¾ç»†çš„æ–‡ä»¶èŒƒå›´
  â†’ å‡å°‘èƒŒæ™¯ä¿¡æ¯
```

---

## å®é™…åº”ç”¨ç¤ºä¾‹

### æ¡ˆä¾‹ï¼šRaydium çœŸå®æ•°æ®é›†æˆ

#### Step 1: åˆ›å»ºä»»åŠ¡æ–‡æ¡£
```markdown
# Task 1a: Raydium Mainnet ä»·æ ¼è·å–

## Role
Mainnet Data Integration Expert

## Objective
å°† market-data-rag.ts ä¸­çš„ fetchRaydiumPrice() ä»æ¨¡æ‹Ÿå®ç°æ”¹ä¸ºçœŸå® mainnet æ•°æ®è·å–

## Context
- å½“å‰å®ç°è¿”å›éšæœºä»·æ ¼ï¼ˆline 163-178ï¼‰
- éœ€è¦ä½¿ç”¨ @raydium-io/raydium-sdk
- RPC endpoint åœ¨ .env ä¸­é…ç½®

## Input Files
- src/context-engineering/rag/market-data-rag.ts (line 163-178)
- .env (SOLANA_RPC_URL)
- package.json (æ£€æŸ¥ä¾èµ–)

## Requirements
1. ä½¿ç”¨ Raydium SDK è·å–çœŸå®ä»·æ ¼
2. æ”¯æŒå¸¸è§ä»£å¸å¯¹ï¼ˆSOL/USDC, SOL/USDT ç­‰ï¼‰
3. æ·»åŠ é”™è¯¯å¤„ç†ï¼ˆç½‘ç»œå¤±è´¥ã€æ— æ•ˆä»£å¸å¯¹ï¼‰
4. æ·»åŠ é‡è¯•æœºåˆ¶ï¼ˆæœ€å¤š 3 æ¬¡ï¼‰
5. ä¿æŒæ¥å£å…¼å®¹ï¼ˆä¸æ”¹å˜å‡½æ•°ç­¾åï¼‰

## Constraints
- ä¸ä¿®æ”¹å…¶ä»–å‡½æ•°
- ä¿æŒ async/await æ¨¡å¼
- å»¶è¿Ÿåº” <500ms

## Output Location
docs/outputs/phase1/output-1a-raydium-implementation.md

## Token Budget
é¢„è®¡ï¼š25k tokens

## Success Criteria
- [ ] èƒ½æˆåŠŸè·å– SOL/USDC ä»·æ ¼
- [ ] é”™è¯¯å¤„ç†è¦†ç›–æ‰€æœ‰å¼‚å¸¸
- [ ] å•å…ƒæµ‹è¯•é€šè¿‡
```

#### Step 2: å¯åŠ¨ Subagent
Controller ä½¿ç”¨ Task toolï¼š
```
è¯·æ‰§è¡Œä»¥ä¸‹ä»»åŠ¡ï¼š

ä½ æ˜¯ Mainnet Data Integration Expertï¼Œä¸“ç²¾ Solana DEX é›†æˆã€‚

1. è¯»å–ä»»åŠ¡æ–‡æ¡£ï¼šdocs/tasks/phase1/task-1a-raydium-price-fetch.md
2. æŒ‰ç…§è¦æ±‚å®ç°åŠŸèƒ½
3. ç¼–å†™æµ‹è¯•ç”¨ä¾‹
4. å°†ç»“æœå†™å…¥ï¼šdocs/outputs/phase1/output-1a-raydium-implementation.md

ç¡®ä¿ä»£ç ç®€æ´ã€å¯ç»´æŠ¤ï¼Œå¹¶åŒ…å«å¿…è¦çš„æ³¨é‡Šã€‚
```

#### Step 3: Subagent è¾“å‡º
```markdown
# Output 1a: Raydium Mainnet ä»·æ ¼è·å– - å®ç°æŠ¥å‘Š

## Status
âœ… å·²å®Œæˆ

## Modified Files
- src/context-engineering/rag/market-data-rag.ts

## Implementation

### æ ¸å¿ƒæ”¹åŠ¨
```typescript
import { Connection, PublicKey } from '@solana/web3.js';
import { Liquidity } from '@raydium-io/raydium-sdk';

private async fetchRaydiumPrice(tokenPair: string): Promise<PriceData | null> {
  const maxRetries = 3;
  let attempt = 0;

  while (attempt < maxRetries) {
    try {
      const connection = new Connection(process.env.SOLANA_RPC_URL!);
      const [tokenA, tokenB] = tokenPair.split('/');

      // æŸ¥è¯¢ Raydium pool
      const poolInfo = await this.getRaydiumPool(tokenA, tokenB);
      if (!poolInfo) {
        throw new Error(`Pool not found for ${tokenPair}`);
      }

      // è®¡ç®—ä»·æ ¼
      const price = poolInfo.baseReserve.toNumber() / poolInfo.quoteReserve.toNumber();

      return {
        tokenA,
        tokenB,
        price,
        volume24h: poolInfo.volume24h,
        liquidity: poolInfo.liquidity,
        timestamp: Date.now(),
        source: 'raydium'
      };

    } catch (error) {
      attempt++;
      if (attempt >= maxRetries) {
        console.error(`Failed to fetch Raydium price after ${maxRetries} attempts:`, error);
        return null;
      }
      // æŒ‡æ•°é€€é¿
      await this.sleep(Math.pow(2, attempt) * 1000);
    }
  }

  return null;
}

private async getRaydiumPool(tokenA: string, tokenB: string) {
  // å®ç°æ± å­æŸ¥è¯¢é€»è¾‘
  // ...
}
```

### è®¾è®¡å†³ç­–
- **é‡è¯•æœºåˆ¶**ï¼šä½¿ç”¨æŒ‡æ•°é€€é¿ï¼ˆ1s, 2s, 4sï¼‰é¿å…é¢‘ç¹è¯·æ±‚
- **é”™è¯¯å¤„ç†**ï¼šè¿”å› null è€ŒéæŠ›å‡ºå¼‚å¸¸ï¼Œä¿æŒä¸åŸæ¥å£å…¼å®¹
- **ç¼“å­˜å‹å¥½**ï¼šä¸åœ¨å‡½æ•°å†…éƒ¨ç¼“å­˜ï¼Œç”±ä¸Šå±‚ retrievePriceData å¤„ç†

## Testing

### å•å…ƒæµ‹è¯•
```typescript
describe('fetchRaydiumPrice', () => {
  it('should fetch SOL/USDC price', async () => {
    const price = await rag.fetchRaydiumPrice('SOL/USDC');
    expect(price).toBeDefined();
    expect(price.source).toBe('raydium');
    expect(price.price).toBeGreaterThan(0);
  });

  it('should handle invalid token pair', async () => {
    const price = await rag.fetchRaydiumPrice('INVALID/PAIR');
    expect(price).toBeNull();
  });

  it('should retry on network error', async () => {
    // Mock network failure then success
    // ...
  });
});
```

### æµ‹è¯•ç»“æœ
- âœ… SOL/USDC ä»·æ ¼è·å–æˆåŠŸï¼š$142.35
- âœ… SOL/USDT ä»·æ ¼è·å–æˆåŠŸï¼š$142.28
- âœ… æ— æ•ˆä»£å¸å¯¹æ­£ç¡®è¿”å› null
- âœ… é‡è¯•æœºåˆ¶éªŒè¯é€šè¿‡
- â±ï¸ å¹³å‡å»¶è¿Ÿï¼š187msï¼ˆç¬¦åˆ <500ms è¦æ±‚ï¼‰

## Usage

### åŸºæœ¬ç”¨æ³•
```typescript
const rag = new MarketDataRAG(process.env.SOLANA_RPC_URL!);
const price = await rag.fetchRaydiumPrice('SOL/USDC');
console.log(price?.price); // 142.35
```

## Dependencies
- å·²æœ‰ï¼š@raydium-io/raydium-sdk@1.3.1-beta.58 âœ…
- å·²æœ‰ï¼š@solana/web3.js@1.98.4 âœ…

## Next Steps
- å»ºè®®ï¼šæ·»åŠ å¯¹æ›´å¤šä»£å¸å¯¹çš„æ”¯æŒï¼ˆå½“å‰åªæ”¯æŒä¸»æµä»£å¸ï¼‰
- å»ºè®®ï¼šè€ƒè™‘ä½¿ç”¨ WebSocket è®¢é˜…å®æ—¶ä»·æ ¼æ›´æ–°
- å»ºè®®ï¼šæ·»åŠ ä»·æ ¼åˆç†æ€§æ£€æŸ¥ï¼ˆé˜²æ­¢å¼‚å¸¸æ•°æ®ï¼‰

## Issues & Limitations
- å½“å‰ä¾èµ– Raydium SDK çš„ APIï¼Œå¦‚æœ SDK æ›´æ–°å¯èƒ½éœ€è¦è°ƒæ•´
- æŸäº›å°ä¼—ä»£å¸å¯¹å¯èƒ½æ²¡æœ‰å¯¹åº”çš„ pool

## Token Usage
å®é™…ä½¿ç”¨ï¼š23k tokens (é¢„ç®—ï¼š25k tokens) âœ…
```

#### Step 4: Controller æ•´åˆ
Controller è¯»å–è¾“å‡ºæ–‡æ¡£ï¼Œä½¿ç”¨ Sequential Thinking åˆ†æï¼š
```
æ€è€ƒ 1ï¼šä»»åŠ¡å®Œæˆè´¨é‡å¦‚ä½•ï¼Ÿ
  â†’ ä»£ç å®ç°å®Œæ•´ï¼Œæµ‹è¯•å……åˆ†ï¼Œå»¶è¿Ÿç¬¦åˆè¦æ±‚

æ€è€ƒ 2ï¼šæ˜¯å¦æœ‰éœ€è¦æ”¹è¿›çš„åœ°æ–¹ï¼Ÿ
  â†’ å»ºè®®ä¸­æåˆ°çš„ WebSocket è®¢é˜…å¯ä»¥ä½œä¸ºåç»­ä¼˜åŒ–ä»»åŠ¡

æ€è€ƒ 3ï¼šæ˜¯å¦å¯ä»¥å¯åŠ¨ä¸‹ä¸€ä¸ªä»»åŠ¡ï¼Ÿ
  â†’ å¯ä»¥ï¼ŒTask 1b (Orca) ä¸ Task 1a ç‹¬ç«‹ï¼Œå¯å¹¶å‘æ‰§è¡Œ

æ€è€ƒ 4ï¼šæ˜¯å¦éœ€è¦åˆ›å»ºæ–°ä»»åŠ¡ï¼Ÿ
  â†’ å¯ä»¥å°†"WebSocket å®æ—¶è®¢é˜…"ä½œä¸º Phase 2 çš„ä¼˜åŒ–ä»»åŠ¡

å†³ç­–ï¼š
  âœ… Task 1a æˆåŠŸå®Œæˆ
  âœ… å¯ä»¥å¹¶å‘å¯åŠ¨ Task 1b, 1c, 1d
  ğŸ“ è®°å½•å»ºè®®åˆ°çŸ¥è¯†åº“
```

---

## æ€»ç»“

### æ ¸å¿ƒä»·å€¼

è¿™å¥—æ–¹æ³•è®ºçš„æ ¸å¿ƒä»·å€¼åœ¨äºï¼š

1. **å·¥ç¨‹åŒ– AI åä½œ**ï¼šå°† AI è¾…åŠ©å¼€å‘ä»"å¯¹è¯å¼ç¼–ç¨‹"æå‡åˆ°"å·¥ç¨‹åŒ–æµç¨‹"
2. **çŸ¥è¯†èµ„äº§åŒ–**ï¼šæ¯ä¸ªä»»åŠ¡çš„è¾“å‡ºæˆä¸ºå¯å¤ç”¨çš„çŸ¥è¯†èµ„äº§
3. **è§„æ¨¡åŒ–èƒ½åŠ›**ï¼šæ”¯æŒå¤§å‹å¤æ‚é¡¹ç›®çš„ç³»ç»ŸåŒ–å¼€å‘
4. **è´¨é‡å¯æ§**ï¼šé€šè¿‡ä¸“ä¸šåˆ†å·¥å’Œæ–‡æ¡£åŒ–ä¿è¯è´¨é‡

### é€‚ç”¨åœºæ™¯

- âœ… å¤§å‹é¡¹ç›®ï¼ˆ>10 ä¸ªæ¨¡å—ï¼‰
- âœ… å¤æ‚æ¶æ„ï¼ˆå¾®æœåŠ¡ã€å¤šå±‚æ¬¡ï¼‰
- âœ… é•¿æœŸç»´æŠ¤ï¼ˆéœ€è¦çŸ¥è¯†ç§¯ç´¯ï¼‰
- âœ… å›¢é˜Ÿåä½œï¼ˆéœ€è¦æ–‡æ¡£åŒ–ï¼‰

### æœªæ¥å±•æœ›

éšç€ AI èƒ½åŠ›çš„æå‡ï¼Œè¿™å¥—æ–¹æ³•è®ºå¯ä»¥è¿›ä¸€æ­¥æ¼”åŒ–ï¼š

1. **è‡ªåŠ¨åŒ–å·¥ä½œæµ**ï¼šè‡ªåŠ¨ç”Ÿæˆä»»åŠ¡æ–‡æ¡£å’Œè¿›åº¦è·Ÿè¸ª
2. **æ™ºèƒ½ä»»åŠ¡åˆ†è§£**ï¼šAI è‡ªåŠ¨è¯†åˆ«ä¾èµ–å…³ç³»å’Œå¹¶å‘æœºä¼š
3. **è´¨é‡è‡ªåŠ¨æ£€æŸ¥**ï¼šAI è‡ªåŠ¨å®¡æŸ¥ä»£ç è´¨é‡å’Œä¸€è‡´æ€§
4. **çŸ¥è¯†å›¾è°±æ„å»º**ï¼šè‡ªåŠ¨å»ºç«‹ä»»åŠ¡ã€ä»£ç ã€çŸ¥è¯†ä¹‹é—´çš„å…³è”

---

## å‚è€ƒèµ„æ–™

### ç†è®ºåŸºç¡€
- [Anthropic: Effective Context Engineering for AI Agents](https://www.anthropic.com/engineering/effective-context-engineering-for-ai-agents)
- [Anthropic: Claude Code Best Practices](https://www.anthropic.com/engineering/claude-code-best-practices)
- [Agenta.ai: Top Techniques to Manage Context Lengths in LLMs](https://agenta.ai/blog/top-6-techniques-to-manage-context-length-in-llms)

### æŠ€æœ¯å®ç°
- [Task Decomposition in Agent Systems - Matoffo](https://matoffo.com/task-decomposition-in-agent-systems/)
- [LLM Context Management: How to Improve Performance and Lower Costs](https://eval.16x.engineer/blog/llm-context-management-guide)

### æœ€ä½³å®è·µ
- Andrej Karpathy: "The delicate art and science of filling the context window"
- Sequential Thinking MCP: Dynamic and reflective problem-solving

---

**ç‰ˆæœ¬å†å²**:
- v0.0.8 (2025-10-01): åˆå§‹ç‰ˆæœ¬ï¼ŒåŸºäº DEX Bot é¡¹ç›®å®è·µæ€»ç»“

**ç»´æŠ¤è€…**: Claude AI + äººç±»åä½œ

**License**: MIT
